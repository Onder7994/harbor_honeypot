"use strict";(self.webpackChunkharbor_portal=self.webpackChunkharbor_portal||[]).push([[3015],{3015:(fe,N,c)=>{c.r(N),c.d(N,{ClearingJobModule:()=>me});var S=c(858),E=c(1296),m=c(8746),g=c(6742),x=c(4128),y=c(5963),p=c(3526),a=c(2614),D=c(8726),e=c(4650),U=c(2678),A=c(2443),L=c(5681),o=c(9375),f=c(6895),T=c(2466),Z=c(3046);function J(i,l){if(1&i&&(e.TgZ(0,"clr-dg-row",14)(1,"clr-dg-cell"),e._uU(2),e.qZA(),e.TgZ(3,"clr-dg-cell"),e._uU(4),e.ALo(5,"translate"),e.qZA(),e.TgZ(6,"clr-dg-cell"),e._uU(7),e.ALo(8,"translate"),e.qZA(),e.TgZ(9,"clr-dg-cell"),e._uU(10),e.ALo(11,"translate"),e.qZA(),e.TgZ(12,"clr-dg-cell"),e._uU(13),e.ALo(14,"harborDatetime"),e.qZA(),e.TgZ(15,"clr-dg-cell"),e._uU(16),e.ALo(17,"harborDatetime"),e.qZA(),e.TgZ(18,"clr-dg-cell")(19,"a",15),e._UZ(20,"clr-icon",16),e.qZA()()()),2&i){const t=l.$implicit,n=e.oxw();e.Q6J("clrDgItem",t),e.xp6(2),e.Oqu(t.id),e.xp6(2),e.Oqu(e.lcZ(5,8,null!=t.schedule&&t.schedule.type?"SCHEDULE."+(null==t.schedule?null:t.schedule.type.toUpperCase()):"")),e.xp6(3),e.Oqu(e.lcZ(8,10,n.isDryRun(null==t?null:t.job_parameters))),e.xp6(3),e.Oqu(e.lcZ(11,12,t.job_status.toUpperCase())),e.xp6(3),e.Oqu(e.xi3(14,14,t.creation_time,"medium")),e.xp6(3),e.Oqu(e.xi3(17,17,t.update_time,"medium")),e.xp6(3),e.Q6J("href",n.getLogLink(t.id),e.LSH)}}function P(i,l){if(1&i&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i){e.oxw();const t=e.MAs(38);e.xp6(1),e.lnq("",t.firstItem+1," - ",t.lastItem+1," ",e.lcZ(2,3,"DESTINATION.OF"),"")}}const M=function(){return[5,25,50]};let R=(()=>{class i{constructor(t,n,r){this.gcService=t,this.errorHandler=n,this.confirmationDialogService=r,this.jobs=[],this.loading=!0,this.pageSize=(0,p.tb)(p.V2.GC_HISTORY_COMPONENT,5),this.page=1,this.total=0,this.selectedRow=[],this.isStopOnGoing=!1}ngOnInit(){this.subscription||(this.subscription=this.confirmationDialogService.confirmationConfirm$.subscribe(t=>{t&&1===t.state&&29===t.source&&this.stopGc(t.data)}))}ngOnDestroy(){this.timerDelay&&(this.timerDelay.unsubscribe(),this.timerDelay=null),this.subscription&&(this.subscription.unsubscribe(),this.subscription=null)}stopGc(t){this.isStopOnGoing=!0,(0,x.D)(t.map(n=>this.gcService.stopGC({gcId:n.id}))).pipe((0,m.x)(()=>this.isStopOnGoing=!1)).subscribe({next:n=>{this.errorHandler.info("CLEARANCES.STOP_GC_SUCCESS")},error:n=>{this.errorHandler.error(n)}})}refresh(){this.page=1,this.total=0,this.getJobs(!0)}getJobs(t,n){let r,s;n&&(this.state=n),n&&n.page&&(this.pageSize=n.page.size,(0,p.Pe)(p.V2.GC_HISTORY_COMPONENT,this.pageSize)),n&&n.filters&&n.filters.length&&(r=encodeURIComponent(`${n.filters[0].property}=~${n.filters[0].value}`)),n&&n.sort&&n.sort.by&&(s=(0,p.td)(n)),t&&(this.loading=!0),this.gcService.getGCHistoryResponse({page:this.page,pageSize:this.pageSize,q:r,sort:s}).pipe((0,m.x)(()=>this.loading=!1)).subscribe(u=>{if(u.headers){const _=u.headers.get("X-Total-Count");_&&(this.total=parseInt(_,0)),t?(this.selectedRow=[],this.jobs=u.body):u?.body?.length&&u.body.forEach(h=>{this.jobs.forEach(C=>{C.id===h.id&&(C.job_status=h.job_status,C.update_time=h.update_time)})})}this.timerDelay||(this.timerDelay=(0,y.H)(a.wz,a.wz).subscribe(()=>{let _=0;this.jobs.forEach(h=>{(h.job_status===a.jf.PENDING||h.job_status===a.jf.RUNNING)&&_++}),_>0?this.getJobs(!1,this.state):(this.timerDelay.unsubscribe(),this.timerDelay=null)}))},u=>{this.errorHandler.error(u),this.loading=!1})}isDryRun(t){if(t){const n=JSON.parse(t);if(n&&n.dry_run)return a.gT}return a.NO}getLogLink(t){return`${p.S$}/system/gc/${t}/log`}canStop(){return!this.isStopOnGoing&&!!this.selectedRow?.length&&this.selectedRow.filter(t=>t.job_status===a.jf.PENDING||t.job_status===a.jf.RUNNING)?.length>0}openStopExecutionsDialog(){const t=this.selectedRow.map(r=>r.id).join(",");let n=new D.c("REPLICATION.STOP_TITLE","REPLICATION.STOP_SUMMARY",t,this.selectedRow,29,0);this.confirmationDialogService.openComfirmDialog(n)}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(U.b),e.Y36(A.q),e.Y36(L.O))},i.\u0275cmp=e.Xpm({type:i,selectors:[["gc-history"]],decls:45,vars:49,consts:[["id","history-header",1,"history-header","mt-3","font-style"],[3,"clrDgSelected","clrDgLoading","clrDgSelectedChange","clrDgRefresh"],[1,"action-bar"],[1,"btn-group"],["id","stop-gc","type","button",1,"btn","btn-secondary",3,"disabled","click"],[1,"refresh-btn",3,"click"],["shape","refresh"],[3,"clrDgField"],[3,"clrDgSortBy"],[3,"clrDgItem",4,"ngFor","ngForOf"],[3,"clrDgPageSize","clrDgPage","clrDgTotalItems","clrDgPageChange"],["pagination",""],[3,"clrPageSizeOptions"],[4,"ngIf"],[3,"clrDgItem"],["rel","noopener noreferrer","target","_blank",3,"href"],["shape","list"]],template:function(t,n){1&t&&(e.TgZ(0,"h5",0),e._uU(1),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"clr-datagrid",1),e.NdJ("clrDgSelectedChange",function(s){return n.selectedRow=s})("clrDgRefresh",function(s){return n.getJobs(!0,s)}),e.TgZ(4,"clr-dg-action-bar",2)(5,"div",3)(6,"button",4),e.NdJ("click",function(){return n.openStopExecutionsDialog()}),e._uU(7),e.ALo(8,"translate"),e.qZA()(),e.TgZ(9,"span",5),e.NdJ("click",function(){return n.refresh()}),e._UZ(10,"clr-icon",6),e.qZA()(),e.TgZ(11,"clr-dg-column",7),e._uU(12),e.ALo(13,"translate"),e.qZA(),e.TgZ(14,"clr-dg-column"),e._uU(15),e.ALo(16,"translate"),e.qZA(),e.TgZ(17,"clr-dg-column"),e._uU(18),e.ALo(19,"translate"),e.qZA(),e.TgZ(20,"clr-dg-column"),e._uU(21),e.ALo(22,"translate"),e.qZA(),e.TgZ(23,"clr-dg-column"),e._uU(24),e.ALo(25,"translate"),e.qZA(),e.TgZ(26,"clr-dg-column",8),e._uU(27),e.ALo(28,"translate"),e.qZA(),e.TgZ(29,"clr-dg-column"),e._uU(30),e.ALo(31,"translate"),e.qZA(),e.TgZ(32,"clr-dg-placeholder"),e._uU(33),e.ALo(34,"translate"),e.qZA(),e.YNc(35,J,21,20,"clr-dg-row",9),e.TgZ(36,"clr-dg-footer")(37,"clr-dg-pagination",10,11),e.NdJ("clrDgPageChange",function(s){return n.page=s}),e.TgZ(39,"clr-dg-page-size",12),e._uU(40),e.ALo(41,"translate"),e.qZA(),e.YNc(42,P,3,5,"span",13),e._uU(43),e.ALo(44,"translate"),e.qZA()()()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,24,"GC.JOB_HISTORY"),"\n"),e.xp6(2),e.Q6J("clrDgSelected",n.selectedRow)("clrDgLoading",n.loading),e.xp6(3),e.Q6J("disabled",!n.canStop()),e.xp6(1),e.hij(" ",e.lcZ(8,26,"REPLICATION.STOPJOB")," "),e.xp6(4),e.Q6J("clrDgField","id"),e.xp6(1),e.Oqu(e.lcZ(13,28,"GC.JOB_ID")),e.xp6(3),e.Oqu(e.lcZ(16,30,"GC.TRIGGER_TYPE")),e.xp6(3),e.Oqu(e.lcZ(19,32,"TAG_RETENTION.DRY_RUN")),e.xp6(3),e.Oqu(e.lcZ(22,34,"STATUS")),e.xp6(3),e.Oqu(e.lcZ(25,36,"CREATION_TIME")),e.xp6(2),e.Q6J("clrDgSortBy","update_time"),e.xp6(1),e.Oqu(e.lcZ(28,38,"UPDATE_TIME")),e.xp6(3),e.Oqu(e.lcZ(31,40,"LOGS")),e.xp6(3),e.Oqu(e.lcZ(34,42,"CLEARANCES.NO_GC_RECORDS")),e.xp6(2),e.Q6J("ngForOf",n.jobs),e.xp6(2),e.Q6J("clrDgPageSize",n.pageSize)("clrDgPage",n.page)("clrDgTotalItems",n.total),e.xp6(2),e.Q6J("clrPageSizeOptions",e.DdM(48,M)),e.xp6(1),e.Oqu(e.lcZ(41,44,"PAGINATION.PAGE_SIZE")),e.xp6(2),e.Q6J("ngIf",n.total),e.xp6(1),e.AsE(" ",n.total," ",e.lcZ(44,46,"DESTINATION.ITEMS")," "))},dependencies:[o.C9t,o.Gwl,o.m4W,o.Z4N,o.fv_,o.dRQ,o.Ltv,o.YYR,o.F7K,o.PDs,o.KHL,o.Gcc,o.jND,o.Nh1,o.dml,o.K8c,o.qvL,f.sg,f.O5,T.X$,Z.Z],styles:[".history-header[_ngcontent-%COMP%]{margin:20px 0 6px;display:inline-block;width:97%}.action-bar[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.refresh-btn[_ngcontent-%COMP%]{margin-right:2rem;cursor:pointer}.refresh-btn[_ngcontent-%COMP%]:hover{color:#007cbb}"]}),i})();var d=c(4006),G=c(668);function j(i,l){1&i&&e._UZ(0,"span",23)}function H(i,l){1&i&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"SCHEDULE.NONE")))}function w(i,l){1&i&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij("(",e.lcZ(2,1,"TAG_RETENTION.DRY_RUN"),")"))}function Y(i,l){if(1&i&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"harborDatetime"),e.YNc(3,w,3,3,"span",11),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Oqu(e.lcZ(2,2,t.lastCompletedTime)),e.xp6(2),e.Q6J("ngIf",t.isDryRun)}}function Q(i,l){if(1&i&&(e.ynx(0),e.YNc(1,H,3,3,"span",11),e.YNc(2,Y,4,4,"span",11),e.BQk()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",!t.lastCompletedTime),e.xp6(1),e.Q6J("ngIf",t.lastCompletedTime)}}function z(i,l){1&i&&(e.TgZ(0,"span",8),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"CLEARANCES.NEXT_SCHEDULED_TIME")))}function F(i,l){if(1&i&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"harborDatetime"),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Oqu(e.lcZ(2,1,t.nextScheduledTime))}}let O=(()=>{class i{constructor(t,n){this.gcService=t,this.errorHandler=n,this.disableGC=!1,this.getLabelCurrent="GC.CURRENT_SCHEDULE",this.loadingGcStatus=!1,this.dryRunOnGoing=!1,this.loadingLastCompletedTime=!1,this.isDryRun=!1}ngOnInit(){this.getCurrentSchedule(!0),this.getStatus()}ngOnDestroy(){this.statusTimeout&&(clearTimeout(this.statusTimeout),this.statusTimeout=null)}getStatus(){this.loadingLastCompletedTime=!0,this.gcService.getGCHistory({page:1,pageSize:1,sort:"-update_time"}).subscribe(t=>{t?.length&&(this.isDryRun=JSON.parse(t[0]?.job_parameters).dry_run,this.lastCompletedTime=t[0]?.update_time,t[0]?.job_status===a.jf.RUNNING||t[0]?.job_status===a.jf.PENDING)?this.statusTimeout=setTimeout(()=>{this.getStatus()},a.wz):this.loadingLastCompletedTime=!1})}getCurrentSchedule(t){t&&(this.loadingGcStatus=!0),this.gcService.getGCSchedule().pipe((0,m.x)(()=>{this.loadingGcStatus=!1})).subscribe(n=>{this.initSchedule(n)},n=>{this.errorHandler.error(n)})}initSchedule(t){this.nextScheduledTime=t?.schedule?.next_scheduled_time?t?.schedule?.next_scheduled_time:null,this.originCron=t&&t.schedule?{type:t.schedule.type,cron:t.schedule.cron}:{type:g.Ix.NONE,cron:""},this.shouldDeleteUntagged=!(!t||!t.job_parameters)&&JSON.parse(t.job_parameters).delete_untagged}gcNow(){this.disableGC=!0,setTimeout(()=>{this.enableGc()},6e4),this.gcService.createGCSchedule({schedule:{parameters:{delete_untagged:this.shouldDeleteUntagged,dry_run:!1},schedule:{type:g.Ix.MANUAL}}}).subscribe({next:t=>{this.errorHandler.info("GC.MSG_SUCCESS"),this.refresh()},error:t=>{this.errorHandler.error(t)}})}dryRun(){this.dryRunOnGoing=!0,this.gcService.createGCSchedule({schedule:{parameters:{delete_untagged:this.shouldDeleteUntagged,dry_run:!0},schedule:{type:g.Ix.MANUAL}}}).pipe((0,m.x)(()=>this.dryRunOnGoing=!1)).subscribe({next:t=>{this.errorHandler.info("GC.DRY_RUN_SUCCESS"),this.refresh()},error:t=>{this.errorHandler.error(t)}})}enableGc(){this.disableGC=!1}saveGcSchedule(t){this.originCron&&this.originCron.type===g.Ix.NONE?this.gcService.createGCSchedule({schedule:{parameters:{delete_untagged:this.shouldDeleteUntagged,dry_run:!1},schedule:{type:i.getScheduleType(t),cron:t}}}).subscribe(n=>{this.errorHandler.info("GC.MSG_SCHEDULE_RESET"),this.cronScheduleComponent.resetSchedule(),this.getCurrentSchedule(!1)},n=>{this.errorHandler.error(n)}):this.gcService.updateGCSchedule({schedule:{parameters:{delete_untagged:this.shouldDeleteUntagged,dry_run:!1},schedule:{type:i.getScheduleType(t),cron:t}}}).subscribe(n=>{this.errorHandler.info("GC.MSG_SCHEDULE_RESET"),this.cronScheduleComponent.resetSchedule(),this.getCurrentSchedule(!1)},n=>{this.errorHandler.error(n)})}static getScheduleType(t){return t?"0 0 * * * *"===t?g.Ix.HOURLY:"0 0 0 * * *"===t?g.Ix.DAILY:"0 0 0 * * 0"===t?g.Ix.WEEKLY:g.Ix.CUSTOM:g.Ix.NONE}refresh(){this.getStatus(),this.gcHistoryComponent?.refresh()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(U.b),e.Y36(A.q))},i.\u0275cmp=e.Xpm({type:i,selectors:[["gc-config"]],viewQuery:function(t,n){if(1&t&&(e.Gf(E.xp,5),e.Gf(R,5)),2&t){let r;e.iGM(r=e.CRH())&&(n.cronScheduleComponent=r.first),e.iGM(r=e.CRH())&&(n.gcHistoryComponent=r.first)}},decls:46,vars:30,consts:[[1,"clr-row","mt-2","center",3,"hidden"],[1,"spinner","spinner-md"],[3,"hidden"],[1,"clr-row","mt-1"],[1,"clr-col-2","flex-200","font-style"],[1,"clr-col"],[1,"clr-row"],[1,"p-06","mr-2"],[1,"mr-1","font-style"],[1,"mr-3"],["class","spinner spinner-inline",4,"ngIf"],[4,"ngIf"],[1,"p-06"],["class","mr-1 font-style",4,"ngIf"],[1,"cron-selection"],[1,"w-100",3,"labelCurrent","labelEdit","originCron","inputvalue"],[1,"clr-col-2","flex-200"],[1,"explain"],[1,"mt-05"],["type","checkbox","clrToggle","","name","delete_untagged","id","delete_untagged",3,"ngModel","ngModelChange"],["for","delete_untagged",1,"font-weight-400"],["id","gc-now",1,"btn","btn-primary","gc-start-btn",3,"disabled","click"],["id","gc-dry-run",1,"btn","btn-outline","gc-start-btn",3,"disabled","click"],[1,"spinner","spinner-inline"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e._UZ(1,"span",1),e.qZA(),e.TgZ(2,"div",2)(3,"div",3)(4,"div",4),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"div",5)(8,"div",6)(9,"div",7)(10,"span",8),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.TgZ(13,"span",9),e.YNc(14,j,1,0,"span",10),e.YNc(15,Q,3,2,"ng-container",11),e.qZA()(),e.TgZ(16,"div",12),e.YNc(17,z,3,3,"span",13),e.YNc(18,F,3,3,"span",11),e.qZA()()()(),e.TgZ(19,"div",14)(20,"cron-selection",15),e.NdJ("inputvalue",function(s){return n.saveGcSchedule(s)}),e.qZA()(),e.TgZ(21,"div",6),e._UZ(22,"div",16),e.TgZ(23,"div",5)(24,"span",17),e._uU(25),e.ALo(26,"translate"),e.qZA()()(),e.TgZ(27,"div",6),e._UZ(28,"div",16),e.TgZ(29,"div",5)(30,"clr-toggle-container",18)(31,"clr-toggle-wrapper")(32,"input",19),e.NdJ("ngModelChange",function(s){return n.shouldDeleteUntagged=s}),e.qZA(),e.TgZ(33,"label",20),e._uU(34),e.ALo(35,"translate"),e.qZA()()()()(),e.TgZ(36,"div",6)(37,"div",16)(38,"button",21),e.NdJ("click",function(){return n.gcNow()}),e._uU(39),e.ALo(40,"translate"),e.qZA()(),e.TgZ(41,"div",5)(42,"button",22),e.NdJ("click",function(){return n.dryRun()}),e._uU(43),e.ALo(44,"translate"),e.qZA()()(),e._UZ(45,"gc-history"),e.qZA()),2&t&&(e.Q6J("hidden",!n.loadingGcStatus),e.xp6(2),e.Q6J("hidden",n.loadingGcStatus),e.xp6(3),e.hij(" ",e.lcZ(6,18,"WEBHOOK.STATUS")," "),e.xp6(6),e.Oqu(e.lcZ(12,20,"CLEARANCES.LAST_COMPLETED")),e.xp6(3),e.Q6J("ngIf",n.loadingLastCompletedTime),e.xp6(1),e.Q6J("ngIf",!n.loadingLastCompletedTime),e.xp6(2),e.Q6J("ngIf",n.nextScheduledTime),e.xp6(1),e.Q6J("ngIf",n.nextScheduledTime),e.xp6(2),e.Q6J("labelCurrent",n.getLabelCurrent)("labelEdit",n.getLabelCurrent)("originCron",n.originCron),e.xp6(5),e.Oqu(e.lcZ(26,22,"GC.EXPLAIN")),e.xp6(7),e.Q6J("ngModel",n.shouldDeleteUntagged),e.xp6(2),e.Oqu(e.lcZ(35,24,"GC.DELETE_UNTAGGED")),e.xp6(4),e.Q6J("disabled",n.disableGC),e.xp6(1),e.hij(" ",e.lcZ(40,26,"GC.GC_NOW")," "),e.xp6(3),e.Q6J("disabled",n.dryRunOnGoing),e.xp6(1),e.hij(" ",e.lcZ(44,28,"TAG_RETENTION.WHAT_IF_RUN")," "))},dependencies:[d.Wl,d.JJ,d.On,o.MgK,o.KKC,o.Y_4,o.PEh,f.O5,G.x,R,T.X$,Z.Z],styles:[".cron-selection[_ngcontent-%COMP%]{display:flex;align-items:center}.gc-start-btn[_ngcontent-%COMP%]{width:150px;margin-top:35px}.flex-200[_ngcontent-%COMP%]{flex:0 0 200px;max-width:200px}.mt-05[_ngcontent-%COMP%]{margin-top:.5rem}.font-weight-400[_ngcontent-%COMP%]{font-weight:400}.explain[_ngcontent-%COMP%]{font-weight:100;font-size:10px}.center[_ngcontent-%COMP%]{justify-content:center;align-items:center}.p-06[_ngcontent-%COMP%]{padding-left:.6rem;padding-right:.6rem}"]}),i})();var $=c(6296),I=c(8964);function K(i,l){if(1&i&&(e.TgZ(0,"clr-dg-row",14)(1,"clr-dg-cell"),e._uU(2),e.qZA(),e.TgZ(3,"clr-dg-cell"),e._uU(4),e.ALo(5,"translate"),e.qZA(),e.TgZ(6,"clr-dg-cell"),e._uU(7),e.ALo(8,"translate"),e.qZA(),e.TgZ(9,"clr-dg-cell"),e._uU(10),e.ALo(11,"translate"),e.qZA(),e.TgZ(12,"clr-dg-cell"),e._uU(13),e.ALo(14,"harborDatetime"),e.qZA(),e.TgZ(15,"clr-dg-cell"),e._uU(16),e.ALo(17,"harborDatetime"),e.qZA(),e.TgZ(18,"clr-dg-cell")(19,"a",15),e._UZ(20,"clr-icon",16),e.qZA()()()),2&i){const t=l.$implicit,n=e.oxw();e.Q6J("clrDgItem",t),e.xp6(2),e.Oqu(t.id),e.xp6(2),e.Oqu(e.lcZ(5,8,null!=t.schedule&&t.schedule.type?"SCHEDULE."+(null==t.schedule?null:t.schedule.type.toUpperCase()):"")),e.xp6(3),e.Oqu(e.lcZ(8,10,n.isDryRun(null==t?null:t.job_parameters))),e.xp6(3),e.Oqu(e.lcZ(11,12,t.job_status.toUpperCase())),e.xp6(3),e.Oqu(e.xi3(14,14,t.creation_time,"medium")),e.xp6(3),e.Oqu(e.xi3(17,17,t.update_time,"medium")),e.xp6(3),e.Q6J("href",n.getLogLink(t.id),e.LSH)}}function X(i,l){if(1&i&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i){e.oxw();const t=e.MAs(38);e.xp6(1),e.lnq("",t.firstItem+1," - ",t.lastItem+1," ",e.lcZ(2,3,"DESTINATION.OF"),"")}}const V=function(){return[5,25,50]};let v=(()=>{class i{constructor(t,n,r){this.purgeService=t,this.errorHandler=n,this.confirmationDialogService=r,this.jobs=[],this.loading=!0,this.pageSize=(0,p.tb)(p.V2.GC_HISTORY_COMPONENT,5),this.page=1,this.total=0,this.selectedRow=[],this.isStopOnGoing=!1}ngOnInit(){this.subscription||(this.subscription=this.confirmationDialogService.confirmationConfirm$.subscribe(t=>{t&&1===t.state&&30===t.source&&this.stopRotation(t.data)}))}ngOnDestroy(){this.timerDelay&&(this.timerDelay.unsubscribe(),this.timerDelay=null),this.subscription&&(this.subscription.unsubscribe(),this.subscription=null)}stopRotation(t){this.isStopOnGoing=!0,(0,x.D)(t.map(n=>this.purgeService.stopPurge({purgeId:n.id}))).pipe((0,m.x)(()=>this.isStopOnGoing=!1)).subscribe({next:n=>{this.errorHandler.info("CLEARANCES.STOP_PURGE_SUCCESS")},error:n=>{this.errorHandler.error(n)}})}refresh(){this.page=1,this.total=0,this.getJobs(!0)}getJobs(t,n){let r,s;n&&(this.state=n),n&&n.page&&(this.pageSize=n.page.size,(0,p.Pe)(p.V2.GC_HISTORY_COMPONENT,this.pageSize)),n&&n.filters&&n.filters.length&&(r=encodeURIComponent(`${n.filters[0].property}=~${n.filters[0].value}`)),n&&n.sort&&n.sort.by&&(s=(0,p.td)(n)),t&&(this.loading=!0),this.purgeService.getPurgeHistoryResponse({page:this.page,pageSize:this.pageSize,q:r,sort:s}).pipe((0,m.x)(()=>this.loading=!1)).subscribe(u=>{if(u.headers){const _=u.headers.get("X-Total-Count");_&&(this.total=parseInt(_,0)),t?(this.selectedRow=[],this.jobs=u.body):u?.body?.length&&u.body.forEach(h=>{this.jobs.forEach(C=>{C.id===h.id&&(C.job_status=h.job_status,C.update_time=h.update_time)})})}this.timerDelay||(this.timerDelay=(0,y.H)(a.wz,a.wz).subscribe(()=>{let _=0;this.jobs.forEach(h=>{(h.job_status===a.jf.PENDING||h.job_status===a.jf.RUNNING)&&_++}),_>0?this.getJobs(!1,this.state):(this.timerDelay.unsubscribe(),this.timerDelay=null)}))},u=>{this.errorHandler.error(u),this.loading=!1})}isDryRun(t){if(t){const n=JSON.parse(t);if(n&&n.dry_run)return a.gT}return a.NO}getLogLink(t){return`${p.S$}/system/purgeaudit/${t}/log`}canStop(){return!this.isStopOnGoing&&!!this.selectedRow?.length&&this.selectedRow.filter(t=>t.job_status===a.jf.PENDING||t.job_status===a.jf.RUNNING)?.length>0}openStopExecutionsDialog(){const t=this.selectedRow.map(r=>r.id).join(",");let n=new D.c("REPLICATION.STOP_TITLE","REPLICATION.STOP_SUMMARY",t,this.selectedRow,30,0);this.confirmationDialogService.openComfirmDialog(n)}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(I.X),e.Y36(A.q),e.Y36(L.O))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-purge-history"]],decls:45,vars:49,consts:[["id","history-header",1,"history-header","font-style","mt-3"],[3,"clrDgSelected","clrDgLoading","clrDgSelectedChange","clrDgRefresh"],[1,"action-bar"],[1,"btn-group"],["id","stop-purge","type","button",1,"btn","btn-secondary",3,"disabled","click"],[1,"refresh-btn",3,"click"],["shape","refresh"],[3,"clrDgField"],[3,"clrDgSortBy"],[3,"clrDgItem",4,"ngFor","ngForOf"],[3,"clrDgPageSize","clrDgPage","clrDgTotalItems","clrDgPageChange"],["pagination",""],[3,"clrPageSizeOptions"],[4,"ngIf"],[3,"clrDgItem"],["rel","noopener noreferrer","target","_blank",3,"href"],["shape","list"]],template:function(t,n){1&t&&(e.TgZ(0,"h5",0),e._uU(1),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"clr-datagrid",1),e.NdJ("clrDgSelectedChange",function(s){return n.selectedRow=s})("clrDgRefresh",function(s){return n.getJobs(!0,s)}),e.TgZ(4,"clr-dg-action-bar",2)(5,"div",3)(6,"button",4),e.NdJ("click",function(){return n.openStopExecutionsDialog()}),e._uU(7),e.ALo(8,"translate"),e.qZA()(),e.TgZ(9,"span",5),e.NdJ("click",function(){return n.refresh()}),e._UZ(10,"clr-icon",6),e.qZA()(),e.TgZ(11,"clr-dg-column",7),e._uU(12),e.ALo(13,"translate"),e.qZA(),e.TgZ(14,"clr-dg-column"),e._uU(15),e.ALo(16,"translate"),e.qZA(),e.TgZ(17,"clr-dg-column"),e._uU(18),e.ALo(19,"translate"),e.qZA(),e.TgZ(20,"clr-dg-column"),e._uU(21),e.ALo(22,"translate"),e.qZA(),e.TgZ(23,"clr-dg-column"),e._uU(24),e.ALo(25,"translate"),e.qZA(),e.TgZ(26,"clr-dg-column",8),e._uU(27),e.ALo(28,"translate"),e.qZA(),e.TgZ(29,"clr-dg-column"),e._uU(30),e.ALo(31,"translate"),e.qZA(),e.TgZ(32,"clr-dg-placeholder"),e._uU(33),e.ALo(34,"translate"),e.qZA(),e.YNc(35,K,21,20,"clr-dg-row",9),e.TgZ(36,"clr-dg-footer")(37,"clr-dg-pagination",10,11),e.NdJ("clrDgPageChange",function(s){return n.page=s}),e.TgZ(39,"clr-dg-page-size",12),e._uU(40),e.ALo(41,"translate"),e.qZA(),e.YNc(42,X,3,5,"span",13),e._uU(43),e.ALo(44,"translate"),e.qZA()()()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,24,"CLEARANCES.PURGE_HISTORY"),"\n"),e.xp6(2),e.Q6J("clrDgSelected",n.selectedRow)("clrDgLoading",n.loading),e.xp6(3),e.Q6J("disabled",!n.canStop()),e.xp6(1),e.hij(" ",e.lcZ(8,26,"REPLICATION.STOPJOB")," "),e.xp6(4),e.Q6J("clrDgField","id"),e.xp6(1),e.Oqu(e.lcZ(13,28,"GC.JOB_ID")),e.xp6(3),e.Oqu(e.lcZ(16,30,"GC.TRIGGER_TYPE")),e.xp6(3),e.Oqu(e.lcZ(19,32,"TAG_RETENTION.DRY_RUN")),e.xp6(3),e.Oqu(e.lcZ(22,34,"STATUS")),e.xp6(3),e.Oqu(e.lcZ(25,36,"CREATION_TIME")),e.xp6(2),e.Q6J("clrDgSortBy","update_time"),e.xp6(1),e.Oqu(e.lcZ(28,38,"UPDATE_TIME")),e.xp6(3),e.Oqu(e.lcZ(31,40,"LOGS")),e.xp6(3),e.Oqu(e.lcZ(34,42,"CLEARANCES.NO_PURGE_RECORDS")),e.xp6(2),e.Q6J("ngForOf",n.jobs),e.xp6(2),e.Q6J("clrDgPageSize",n.pageSize)("clrDgPage",n.page)("clrDgTotalItems",n.total),e.xp6(2),e.Q6J("clrPageSizeOptions",e.DdM(48,V)),e.xp6(1),e.Oqu(e.lcZ(41,44,"PAGINATION.PAGE_SIZE")),e.xp6(2),e.Q6J("ngIf",n.total),e.xp6(1),e.AsE(" ",n.total," ",e.lcZ(44,46,"DESTINATION.ITEMS")," "))},dependencies:[o.C9t,o.Gwl,o.m4W,o.Z4N,o.fv_,o.dRQ,o.Ltv,o.YYR,o.F7K,o.PDs,o.KHL,o.Gcc,o.jND,o.Nh1,o.dml,o.K8c,o.qvL,f.sg,f.O5,T.X$,Z.Z],styles:[".history-header[_ngcontent-%COMP%]{margin:20px 0 6px;display:inline-block;width:97%}.action-bar[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.refresh-btn[_ngcontent-%COMP%]{margin-right:2rem;cursor:pointer}.refresh-btn[_ngcontent-%COMP%]:hover{color:#007cbb}"]}),i})();const B=["purgeForm"];function W(i,l){1&i&&e._UZ(0,"span",41)}function ee(i,l){1&i&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"SCHEDULE.NONE")))}function te(i,l){1&i&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij("(",e.lcZ(2,1,"TAG_RETENTION.DRY_RUN"),")"))}function ne(i,l){if(1&i&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"harborDatetime"),e.YNc(3,te,3,3,"span",11),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Oqu(e.lcZ(2,2,t.lastCompletedTime)),e.xp6(2),e.Q6J("ngIf",t.isDryRun)}}function ie(i,l){if(1&i&&(e.ynx(0),e.YNc(1,ee,3,3,"span",11),e.YNc(2,ne,4,4,"span",11),e.BQk()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",!t.lastCompletedTime),e.xp6(1),e.Q6J("ngIf",t.lastCompletedTime)}}function re(i,l){1&i&&(e.TgZ(0,"span",8),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"CLEARANCES.NEXT_SCHEDULED_TIME")))}function oe(i,l){if(1&i&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"harborDatetime"),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Oqu(e.lcZ(2,1,t.nextScheduledTime))}}function le(i,l){1&i&&(e.TgZ(0,"clr-tooltip-content",42)(1,"span"),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&i&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"CLEARANCES.KEEP_IN_TOOLTIP")))}function se(i,l){1&i&&(e.TgZ(0,"clr-control-error",43),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"CLEARANCES.KEEP_IN_ERROR")," "))}function ae(i,l){1&i&&(e.TgZ(0,"clr-tooltip-content",42)(1,"span"),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&i&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"CLEARANCES.INCLUDED_OPERATION_TOOLTIP")))}function ce(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"div",44)(1,"input",45),e.NdJ("change",function(){const s=e.CHM(t).$implicit,u=e.oxw();return e.KtG(u.setOperation(s))}),e.qZA(),e.TgZ(2,"label",46),e._uU(3),e.ALo(4,"translate"),e.qZA()()}if(2&i){const t=l.$implicit,n=e.oxw();e.xp6(1),e.s9C("id",t),e.s9C("value",t),e.Q6J("checked",n.hasOperation(t)),e.xp6(1),e.s9C("for",t),e.xp6(1),e.Oqu(e.lcZ(4,5,n.operationsToText(t)))}}function ue(i,l){1&i&&(e.TgZ(0,"div",47),e._UZ(1,"clr-icon",27),e.TgZ(2,"span",48),e._uU(3),e.ALo(4,"translate"),e.qZA()()),2&i&&(e.xp6(3),e.Oqu(e.lcZ(4,1,"CLEARANCES.INCLUDED_OPERATION_ERROR")))}const pe=function(i){return{pt:i}},ge=function(){return{standalone:!0}},de=function(i){return{"mt-08":i}},_e=[{path:"",component:(()=>{class i{constructor(){this.inProgress=!0}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-clearing-job"]],decls:14,vars:9,consts:[["sub-header-title","",1,"custom-h2"],[1,"mt-1"],[1,"nav"],[1,"nav-item"],["routerLink","gc","routerLinkActive","active",1,"nav-link"],["routerLink","audit-log-purge","routerLinkActive","active",1,"nav-link"]],template:function(t,n){1&t&&(e.TgZ(0,"h2",0),e._uU(1),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"nav",1)(4,"ul",2)(5,"li",3)(6,"a",4),e._uU(7),e.ALo(8,"translate"),e.qZA()(),e.TgZ(9,"li",3)(10,"a",5),e._uU(11),e.ALo(12,"translate"),e.qZA()()()(),e._UZ(13,"router-outlet")),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,3,"CLEARANCES.CLEARANCES"),"\n"),e.xp6(6),e.Oqu(e.lcZ(8,5,"CONFIG.GC")),e.xp6(4),e.Oqu(e.lcZ(12,7,"CLEARANCES.AUDIT_LOG")))},dependencies:[S.lC,S.yS,S.Od,T.X$]}),i})(),children:[{path:"gc",component:O},{path:"audit-log-purge",component:(()=>{class i{constructor(t,n){this.purgeService=t,this.errorHandler=n,this.disableGC=!1,this.getLabelCurrent="CLEARANCES.SCHEDULE_TO_PURGE",this.loadingGcStatus=!1,this.dryRunOnGoing=!1,this.loadingLastCompletedTime=!1,this.isDryRun=!1,this.retentionUnit=a.zN.DAYS,this.operations=(0,p.d9)(a.CZ),this.selectedOperations=(0,p.d9)(a.CZ)}ngOnInit(){this.getCurrentSchedule(!0),this.getStatus()}ngOnDestroy(){this.statusTimeout&&(clearTimeout(this.statusTimeout),this.statusTimeout=null)}getStatus(){this.loadingLastCompletedTime=!0,this.purgeService.getPurgeHistory({page:1,pageSize:1,sort:"-update_time"}).subscribe(t=>{t?.length&&(this.isDryRun=JSON.parse(t[0]?.job_parameters).dry_run,this.lastCompletedTime=t[0]?.update_time,t[0]?.job_status===a.jf.RUNNING||t[0]?.job_status===a.jf.PENDING)?this.statusTimeout=setTimeout(()=>{this.getStatus()},a.wz):this.loadingLastCompletedTime=!1})}getCurrentSchedule(t){t&&(this.loadingGcStatus=!0),this.purgeService.getPurgeSchedule().pipe((0,m.x)(()=>{this.loadingGcStatus=!1})).subscribe({next:n=>{this.initSchedule(n)},error:n=>{this.errorHandler.error(n)}})}initSchedule(t){if(this.nextScheduledTime=t?.schedule?.next_scheduled_time?t?.schedule?.next_scheduled_time:null,t&&t.schedule)if(this.originCron={type:t.schedule.type,cron:t.schedule.cron},t&&t.job_parameters){const n=JSON.parse(t.job_parameters);this.selectedOperations=n?.include_operations?n?.include_operations?.split(","):[],n?.audit_retention_hour>24&&n?.audit_retention_hour%24==0?(this.retentionTime=n?.audit_retention_hour/24,this.retentionUnit=a.zN.DAYS):(this.retentionTime=n?.audit_retention_hour,this.retentionUnit=a.zN.HOURS)}else this.retentionTime=null,this.selectedOperations=(0,p.d9)(a.CZ),this.retentionUnit=a.zN.DAYS;else this.originCron={type:g.Ix.NONE,cron:""}}gcNow(){this.disableGC=!0,setTimeout(()=>{this.enableGc()},6e4),this.purgeService.createPurgeSchedule({schedule:{parameters:{audit_retention_hour:+(this.retentionUnit===a.zN.DAYS?24*this.retentionTime:this.retentionTime),include_operations:this.selectedOperations.join(","),dry_run:!1},schedule:{type:g.Ix.MANUAL}}}).subscribe({next:n=>{this.errorHandler.info("CLEARANCES.PURGE_NOW_SUCCESS"),this.refresh()},error:n=>{this.errorHandler.error(n)}})}dryRun(){this.dryRunOnGoing=!0,this.purgeService.createPurgeSchedule({schedule:{parameters:{audit_retention_hour:+(this.retentionUnit===a.zN.DAYS?24*this.retentionTime:this.retentionTime),include_operations:this.selectedOperations.join(","),dry_run:!0},schedule:{type:g.Ix.MANUAL}}}).pipe((0,m.x)(()=>this.dryRunOnGoing=!1)).subscribe({next:n=>{this.errorHandler.info("GC.DRY_RUN_SUCCESS"),this.refresh()},error:n=>{this.errorHandler.error(n)}})}enableGc(){this.disableGC=!1}saveGcSchedule(t){const n=this.retentionUnit===a.zN.DAYS?24*this.retentionTime:this.retentionTime;this.originCron&&this.originCron.type===g.Ix.NONE?this.purgeService.createPurgeSchedule({schedule:{parameters:{audit_retention_hour:+n,include_operations:this.selectedOperations.join(","),dry_run:!1},schedule:{type:O.getScheduleType(t),cron:t}}}).subscribe({next:r=>{this.errorHandler.info("CLEARANCES.PURGE_SCHEDULE_RESET"),this.cronScheduleComponent.resetSchedule(),this.getCurrentSchedule(!1)},error:r=>{this.errorHandler.error(r)}}):this.purgeService.updatePurgeSchedule({schedule:{parameters:{audit_retention_hour:+n,include_operations:this.selectedOperations.join(","),dry_run:!1},schedule:{type:O.getScheduleType(t),cron:t}}}).subscribe({next:r=>{this.errorHandler.info("CLEARANCES.PURGE_SCHEDULE_RESET"),this.cronScheduleComponent.resetSchedule(),this.getCurrentSchedule(!1)},error:r=>{this.errorHandler.error(r)}})}hasOperation(t){return-1!==this.selectedOperations?.indexOf(t)}operationsToText(t){return a.CV[t]?a.CV[t]:t}setOperation(t){-1===this.selectedOperations.indexOf(t)?this.selectedOperations.push(t):this.selectedOperations.splice(this.selectedOperations.findIndex(n=>n===t),1)}refresh(){this.getStatus(),this.purgeHistoryComponent?.refresh()}isValid(){return this.cronScheduleComponent?.scheduleType===g.Ix.NONE||!(this.purgeForm?.invalid||!(this.selectedOperations?.length>0))}isRetentionTimeValid(){return this.retentionUnit===a.zN.DAYS?this.retentionTime>0&&this.retentionTime<=1e4:this.retentionTime>0&&this.retentionTime<=24e4}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(I.X),e.Y36(A.q))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-set-job"]],viewQuery:function(t,n){if(1&t&&(e.Gf(E.xp,5),e.Gf(v,5),e.Gf(B,5)),2&t){let r;e.iGM(r=e.CRH())&&(n.cronScheduleComponent=r.first),e.iGM(r=e.CRH())&&(n.purgeHistoryComponent=r.first),e.iGM(r=e.CRH())&&(n.purgeForm=r.first)}},decls:65,vars:54,consts:[[1,"clr-row","mt-2","center",3,"hidden"],[1,"spinner","spinner-md"],[3,"hidden"],[1,"clr-row","mt-1"],[1,"clr-col-2","flex-200","font-style"],[1,"clr-col"],[1,"clr-row"],[1,"p-06","mr-2"],[1,"mr-1","font-style"],[1,"mr-3"],["class","spinner spinner-inline",4,"ngIf"],[4,"ngIf"],[1,"p-06"],["class","mr-1 font-style",4,"ngIf"],[1,"cron-selection"],[1,"w-100",3,"externalValidation","labelCurrent","labelEdit","originCron","inputvalue"],[1,"clr-form","clr-form-horizontal","p-0"],["purgeForm","ngForm"],[1,"clr-form-control","mt-0"],[1,"required","font-style","flex-200"],["clrTooltipTrigger","","shape","info-circle","size","24"],["clrPosition","top-right","clrSize","lg",4,"clrIfOpen"],[1,"clr-control-container","input-width"],[1,"flex"],[1,"clr-input-wrapper"],["name","retentionTime","type","text","autocomplete","off","required","","pattern","^[\\-1-9]{1}[0-9]*$","id","retentionTime","size","20",1,"clr-input",3,"disabled","ngModel","ngModelChange"],["retentionTimeNgModel","ngModel"],["shape","exclamation-circle",1,"clr-validate-icon"],["class","max-width-2rem",4,"ngIf"],[1,"clr-select-wrapper","unit-select",3,"ngClass"],["id","expiration-type",1,"clr-select",3,"ngModel","ngModelOptions","ngModelChange"],["value","days"],["value","hours"],[1,"clr-form-control",3,"ngClass"],[1,"font-style","required","flex-200"],[1,"clr-control-container","clr-control-inline"],["class","clr-checkbox-wrapper",4,"ngFor","ngForOf"],["class","clr-subtext-wrapper",4,"ngIf"],[1,"clr-col-2","flex-200"],["id","gc-now",1,"btn","btn-primary","gc-start-btn",3,"disabled","click"],["id","gc-dry-run",1,"btn","btn-outline","gc-start-btn",3,"disabled","click"],[1,"spinner","spinner-inline"],["clrPosition","top-right","clrSize","lg"],[1,"max-width-2rem"],[1,"clr-checkbox-wrapper"],["type","checkbox","name","operations",1,"clr-checkbox",3,"id","value","checked","change"],[1,"clr-control-label",3,"for"],[1,"clr-subtext-wrapper"],[1,"clr-subtext"]],template:function(t,n){if(1&t&&(e.TgZ(0,"div",0),e._UZ(1,"span",1),e.qZA(),e.TgZ(2,"div",2)(3,"div",3)(4,"div",4),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"div",5)(8,"div",6)(9,"div",7)(10,"span",8),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.TgZ(13,"span",9),e.YNc(14,W,1,0,"span",10),e.YNc(15,ie,3,2,"ng-container",11),e.qZA()(),e.TgZ(16,"div",12),e.YNc(17,re,3,3,"span",13),e.YNc(18,oe,3,3,"span",11),e.qZA()()()(),e.TgZ(19,"div",14)(20,"cron-selection",15),e.NdJ("inputvalue",function(s){return n.saveGcSchedule(s)}),e.qZA()(),e.TgZ(21,"form",16,17)(23,"div",18)(24,"span",19),e._uU(25),e.ALo(26,"translate"),e.TgZ(27,"clr-tooltip"),e._UZ(28,"clr-icon",20),e.YNc(29,le,4,3,"clr-tooltip-content",21),e.qZA()(),e.TgZ(30,"div",22)(31,"div",23)(32,"div",24)(33,"input",25,26),e.NdJ("ngModelChange",function(s){return n.retentionTime=s}),e.qZA(),e._UZ(35,"clr-icon",27),e.YNc(36,se,3,3,"clr-control-error",28),e.qZA(),e.TgZ(37,"div",29)(38,"select",30),e.NdJ("ngModelChange",function(s){return n.retentionUnit=s}),e.TgZ(39,"option",31),e._uU(40),e.ALo(41,"translate"),e.qZA(),e.TgZ(42,"option",32),e._uU(43),e.ALo(44,"translate"),e.qZA()()()()()(),e.TgZ(45,"div",33)(46,"span",34),e._uU(47),e.ALo(48,"translate"),e.TgZ(49,"clr-tooltip"),e._UZ(50,"clr-icon",20),e.YNc(51,ae,4,3,"clr-tooltip-content",21),e.qZA()(),e.TgZ(52,"div",35),e.YNc(53,ce,5,7,"div",36),e.YNc(54,ue,5,3,"div",37),e.qZA()()(),e.TgZ(55,"div",6)(56,"div",38)(57,"button",39),e.NdJ("click",function(){return n.gcNow()}),e._uU(58),e.ALo(59,"translate"),e.qZA()(),e.TgZ(60,"div",5)(61,"button",40),e.NdJ("click",function(){return n.dryRun()}),e._uU(62),e.ALo(63,"translate"),e.qZA()()(),e._UZ(64,"app-purge-history"),e.qZA()),2&t){const r=e.MAs(22),s=e.MAs(34);e.Q6J("hidden",!n.loadingGcStatus),e.xp6(2),e.Q6J("hidden",n.loadingGcStatus),e.xp6(3),e.hij(" ",e.lcZ(6,33,"WEBHOOK.STATUS")," "),e.xp6(6),e.Oqu(e.lcZ(12,35,"CLEARANCES.LAST_COMPLETED")),e.xp6(3),e.Q6J("ngIf",n.loadingLastCompletedTime),e.xp6(1),e.Q6J("ngIf",!n.loadingLastCompletedTime),e.xp6(2),e.Q6J("ngIf",n.nextScheduledTime),e.xp6(1),e.Q6J("ngIf",n.nextScheduledTime),e.xp6(2),e.Q6J("externalValidation",n.isValid())("labelCurrent",n.getLabelCurrent)("labelEdit",n.getLabelCurrent)("originCron",n.originCron),e.xp6(5),e.Oqu(e.lcZ(26,37,"CLEARANCES.KEEP_IN")),e.xp6(5),e.ekj("clr-error",(s.dirty||s.touched)&&(s.invalid||!n.isRetentionTimeValid())),e.xp6(3),e.Q6J("disabled",n.dryRunOnGoing)("ngModel",n.retentionTime),e.xp6(3),e.Q6J("ngIf",(s.dirty||s.touched)&&(s.invalid||!n.isRetentionTimeValid())),e.xp6(1),e.Q6J("ngClass",e.VKq(49,pe,(s.dirty||s.touched)&&(s.invalid||!n.isRetentionTimeValid()))),e.xp6(1),e.Q6J("ngModel",n.retentionUnit)("ngModelOptions",e.DdM(51,ge)),e.xp6(2),e.hij(" ",e.lcZ(41,39,"CLEARANCES.DAYS")," "),e.xp6(3),e.hij(" ",e.lcZ(44,41,"CLEARANCES.HOURS")," "),e.xp6(2),e.Q6J("ngClass",e.VKq(52,de,!((s.dirty||s.touched)&&s.invalid))),e.xp6(2),e.Oqu(e.lcZ(48,43,"CLEARANCES.INCLUDED_OPERATIONS")),e.xp6(5),e.ekj("clr-error",!((null==n.selectedOperations?null:n.selectedOperations.length)>0)),e.xp6(1),e.Q6J("ngForOf",n.operations),e.xp6(1),e.Q6J("ngIf",!((null==n.selectedOperations?null:n.selectedOperations.length)>0)),e.xp6(3),e.Q6J("disabled",n.disableGC||r.invalid||!((null==n.selectedOperations?null:n.selectedOperations.length)>0)),e.xp6(1),e.hij(" ",e.lcZ(59,45,"CLEARANCES.PURGE_NOW")," "),e.xp6(3),e.Q6J("disabled",n.dryRunOnGoing||r.invalid||!((null==n.selectedOperations?null:n.selectedOperations.length)>0)),e.xp6(1),e.hij(" ",e.lcZ(63,47,"TAG_RETENTION.WHAT_IF_RUN")," ")}},dependencies:[d._Y,d.YN,d.Kr,d.Fj,d.EJ,d.JJ,d.JL,d.Q7,d.c5,d.On,d.F,o.qvL,o.nqY,o.MgK,o.VqA,o.Jmj,o.bMv,o.zDF,f.mk,f.sg,f.O5,G.x,v,T.X$,Z.Z],styles:[".cron-selection[_ngcontent-%COMP%]{display:flex;align-items:center}.gc-start-btn[_ngcontent-%COMP%]{width:150px;margin-top:35px}.flex-200[_ngcontent-%COMP%]{flex:0 0 200px;max-width:200px}.mt-05[_ngcontent-%COMP%]{margin-top:.5rem}.font-weight-400[_ngcontent-%COMP%]{font-weight:400}.center[_ngcontent-%COMP%]{justify-content:center;align-items:center}.flex[_ngcontent-%COMP%]{display:flex}.mt-08[_ngcontent-%COMP%]{margin-top:.8rem}.unit-select[_ngcontent-%COMP%]{padding-top:1px;margin-left:2rem}.max-width-2rem[_ngcontent-%COMP%]{max-width:2rem}.pt[_ngcontent-%COMP%]{padding-right:1rem}.p-06[_ngcontent-%COMP%]{padding-left:.6rem;padding-right:.6rem}"]}),i})()},{path:"",redirectTo:"gc",pathMatch:"full"}]}];let me=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[$.m,S.Bz.forChild(_e)]}),i})()}}]);