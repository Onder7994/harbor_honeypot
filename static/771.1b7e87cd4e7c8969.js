"use strict";(self.webpackChunkharbor_portal=self.webpackChunkharbor_portal||[]).push([[771],{771:(nt,R,r)=>{r.r(R),r.d(R,{SystemRobotAccountsModule:()=>ot});var e=r(4650),_=r(3526),p=r(1229),O=r(858),i=r(9375),g=r(6895),f=r(2466),b=r(3046);function q(s,c){1&s&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&s&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"SYSTEM_ROBOT.SELECT_ALL")))}function Y(s,c){1&s&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&s&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"SYSTEM_ROBOT.UNSELECT_ALL")))}function J(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"div",16),e.NdJ("click",function(){const l=e.CHM(t).$implicit,a=e.oxw(2);return e.KtG(a.chooseDefaultAccess(l))}),e._UZ(1,"clr-icon",17),e.TgZ(2,"span"),e._uU(3),e.ALo(4,"translate"),e.ALo(5,"translate"),e.qZA()()}if(2&s){const t=c.$implicit,o=e.oxw(2);e.xp6(1),e.Udp("visibility",t.checked?"visible":"hidden"),e.xp6(2),e.AsE("",e.lcZ(4,4,o.i18nMap[t.action])," ",e.lcZ(5,6,o.i18nMap[t.resource]),"")}}function k(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"clr-dropdown-menu",13)(1,"div")(2,"button",14),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return n.selectAllPermissionOrUnselectAll(n.defaultAccesses),e.KtG(n.resetAccess(n.defaultAccesses))}),e.YNc(3,q,3,3,"span",6),e.YNc(4,Y,3,3,"span",6),e.qZA()(),e.YNc(5,J,6,8,"div",15),e.qZA()}if(2&s){const t=e.oxw();e.Udp("height",230,"px"),e.xp6(3),e.Q6J("ngIf",t.isSelectAll(t.defaultAccesses)),e.xp6(1),e.Q6J("ngIf",!t.isSelectAll(t.defaultAccesses)),e.xp6(1),e.Q6J("ngForOf",t.defaultAccesses)}}function B(s,c){1&s&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&s&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"SYSTEM_ROBOT.SELECT_ALL")))}function Q(s,c){1&s&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&s&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"SYSTEM_ROBOT.UNSELECT_ALL")))}function F(s,c){1&s&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&s&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"SYSTEM_ROBOT.SELECT_ALL")))}function z(s,c){1&s&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&s&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"SYSTEM_ROBOT.UNSELECT_ALL")))}function G(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"div",16),e.NdJ("click",function(){const l=e.CHM(t).$implicit,a=e.oxw(3);return e.KtG(a.chooseAccess(l))}),e._UZ(1,"clr-icon",17),e.TgZ(2,"span"),e._uU(3),e.ALo(4,"translate"),e.ALo(5,"translate"),e.qZA()()}if(2&s){const t=c.$implicit,o=e.oxw(3);e.xp6(1),e.Udp("visibility",t.checked?"visible":"hidden"),e.xp6(2),e.AsE("",e.lcZ(4,4,o.i18nMap[t.action])," ",e.lcZ(5,6,o.i18nMap[t.resource]),"")}}function H(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"clr-dropdown-menu",13)(1,"div")(2,"button",14),e.NdJ("click",function(){e.CHM(t);const n=e.oxw().$implicit,l=e.oxw();return e.KtG(l.selectAllPermissionOrUnselectAll(n.permissions[0].access))}),e.YNc(3,F,3,3,"span",6),e.YNc(4,z,3,3,"span",6),e.qZA()(),e.YNc(5,G,6,8,"div",15),e.qZA()}if(2&s){const t=e.oxw().$implicit,o=e.oxw();e.Udp("height",140,"px"),e.xp6(3),e.Q6J("ngIf",o.isSelectAll(t.permissions[0].access)),e.xp6(1),e.Q6J("ngIf",!o.isSelectAll(t.permissions[0].access)),e.xp6(1),e.Q6J("ngForOf",t.permissions[0].access)}}function K(s,c){if(1&s&&(e.TgZ(0,"clr-dg-row",18)(1,"clr-dg-cell")(2,"a",19),e._uU(3),e.qZA()(),e.TgZ(4,"clr-dg-cell"),e._uU(5),e.ALo(6,"harborDatetime"),e.qZA(),e.TgZ(7,"clr-dg-cell")(8,"div",20)(9,"clr-dropdown",1)(10,"button",21),e._uU(11),e.ALo(12,"translate"),e._UZ(13,"clr-icon",3),e.qZA(),e.YNc(14,H,6,5,"clr-dropdown-menu",4),e.qZA()()()()),2&s){const t=c.$implicit,o=e.oxw();e.Q6J("clrDgItem",t),e.xp6(2),e.Q6J("routerLink",o.getLink(t.project_id)),e.xp6(1),e.Oqu(t.name),e.xp6(2),e.Oqu(e.xi3(6,8,t.creation_time,"short")),e.xp6(4),e.Q6J("clrCloseMenuOnItemClick",!1),e.xp6(1),e.Q6J("disabled",o.coverAll),e.xp6(1),e.AsE(" ",o.getPermissions(t.permissions[0].access)," ",e.lcZ(12,11,"SYSTEM_ROBOT.PERMISSIONS")," ")}}const $=function(){return[5,15,25]};let E=(()=>{class s{constructor(t){this.router=t,this.i18nMap=p.Y3,this.permissionsForAdd=[],this.selectedRow=[],this.timeComparator=new _.sH("creation_time","date"),this.projects=[],this.pageSize=5,this.currentPage=1,this.defaultAccesses=[],this.coverAll=!1,this.showSelectAll=!0}init(t){this.pageSize=5,this.currentPage=1,this.showSelectAll=!0,this.myNameFilterValue=null,t?(this.defaultAccesses=(0,_.d9)(p.B0),this.defaultAccesses.forEach(o=>o.checked=!1)):this.defaultAccesses=(0,_.d9)(p.B0),this.cachedAllProjects&&this.cachedAllProjects.length?(this.projects=(0,_.d9)(this.cachedAllProjects),this.resetAccess(this.defaultAccesses)):this.projects=[]}resetAccess(t){this.projects&&this.projects.length&&this.projects.forEach(o=>{o.permissions=[{kind:p.sC.PROJECT,namespace:o.name,access:(0,_.d9)(t)}]})}chooseAccess(t){t.checked=!t.checked}chooseDefaultAccess(t){t.checked=!t.checked,this.resetAccess(this.defaultAccesses)}getPermissions(t){let o=0;return t.forEach(n=>{n.checked&&o++}),o}getLink(t){return`/harbor/projects/${t}`}selectAllOrUnselectAll(){this.showSelectAll?this.myNameFilterValue?this.projects.forEach(t=>{let o=!1;-1!==t.name.indexOf(this.myNameFilterValue)&&(this.selectedRow.forEach(n=>{n.name===t.name&&(o=!0)}),o||this.selectedRow.push(t))}):this.selectedRow=this.projects:this.selectedRow=[],this.showSelectAll=!this.showSelectAll}isSelectAll(t){return!!t?.length&&t.filter(o=>o.checked).length<t.length/2}selectAllPermissionOrUnselectAll(t){t?.length&&(this.isSelectAll(t)?t.forEach(o=>{o.checked=!0}):t.forEach(o=>{o.checked=!1}))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(O.F0))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-list-all-projects"]],inputs:{coverAll:"coverAll"},decls:32,vars:39,consts:[[3,"clrDgPreserveSelection","clrDgSelected","clrDgSelectedChange"],[3,"clrCloseMenuOnItemClick"],["clrDropdownTrigger","",1,"btn","btn-secondary","btn-sm",3,"disabled"],["shape","caret down"],["clrPosition","bottom-left",3,"height",4,"clrIfOpen"],[1,"btn","btn-secondary","btn-sm","ml-1",3,"disabled","click"],[4,"ngIf"],[3,"clrDgField","clrFilterValue","clrFilterValueChange"],[3,"clrDgSortBy"],[3,"clrDgItem",4,"clrDgItems","clrDgItemsOf"],[3,"clrDgPage","clrDgPageSize","clrDgPageChange"],["pagination",""],[3,"clrPageSizeOptions"],["clrPosition","bottom-left"],[1,"btn","btn-link","btn-sm","select-all-for-dropdown","ml-20px",3,"click"],["clrDropdownItem","",3,"click",4,"ngFor","ngForOf"],["clrDropdownItem","",3,"click"],["shape","check",1,"check"],[3,"clrDgItem"],["href","javascript:void(0)",3,"routerLink"],[1,"permissions"],["clrDropdownTrigger","",1,"btn","btn-link",3,"disabled"]],template:function(t,o){if(1&t&&(e.TgZ(0,"clr-datagrid",0),e.NdJ("clrDgSelectedChange",function(l){return o.selectedRow=l}),e.TgZ(1,"clr-dg-action-bar")(2,"clr-dropdown",1)(3,"button",2),e._uU(4),e.ALo(5,"translate"),e._UZ(6,"clr-icon",3),e.qZA(),e.YNc(7,k,6,5,"clr-dropdown-menu",4),e.qZA(),e.TgZ(8,"button",5),e.NdJ("click",function(){return o.selectAllOrUnselectAll()}),e.YNc(9,B,3,3,"span",6),e.YNc(10,Q,3,3,"span",6),e.qZA()(),e.TgZ(11,"clr-dg-column",7),e.NdJ("clrFilterValueChange",function(l){return o.myNameFilterValue=l}),e._uU(12),e.ALo(13,"translate"),e.qZA(),e.TgZ(14,"clr-dg-column",8),e._uU(15),e.ALo(16,"translate"),e.qZA(),e.TgZ(17,"clr-dg-column"),e._uU(18),e.ALo(19,"translate"),e.qZA(),e.YNc(20,K,15,13,"clr-dg-row",9),e.TgZ(21,"clr-dg-footer")(22,"clr-dg-pagination",10,11),e.NdJ("clrDgPageChange",function(l){return o.currentPage=l}),e.TgZ(24,"clr-dg-page-size",12),e._uU(25),e.ALo(26,"translate"),e.qZA(),e.TgZ(27,"span"),e._uU(28),e.ALo(29,"translate"),e.qZA(),e._uU(30),e.ALo(31,"translate"),e.qZA()()()),2&t){const n=e.MAs(23);e.Q6J("clrDgPreserveSelection",!0)("clrDgSelected",o.selectedRow),e.xp6(2),e.Q6J("clrCloseMenuOnItemClick",!1),e.xp6(1),e.Q6J("disabled",o.coverAll),e.xp6(1),e.hij(" ",e.lcZ(5,24,"SYSTEM_ROBOT.RESET_PERMISSION")," "),e.xp6(4),e.Q6J("disabled",o.coverAll),e.xp6(1),e.Q6J("ngIf",o.showSelectAll),e.xp6(1),e.Q6J("ngIf",!o.showSelectAll),e.xp6(1),e.Q6J("clrDgField","name")("clrFilterValue",o.myNameFilterValue),e.xp6(1),e.Oqu(e.lcZ(13,26,"PROJECT.NAME")),e.xp6(2),e.Q6J("clrDgSortBy",o.timeComparator),e.xp6(1),e.Oqu(e.lcZ(16,28,"PROJECT.CREATION_TIME")),e.xp6(3),e.Oqu(e.lcZ(19,30,"SYSTEM_ROBOT.PERMISSION_COLUMN")),e.xp6(2),e.Q6J("clrDgItemsOf",o.projects),e.xp6(2),e.Q6J("clrDgPage",o.currentPage)("clrDgPageSize",o.pageSize),e.xp6(2),e.Q6J("clrPageSizeOptions",e.DdM(38,$)),e.xp6(1),e.Oqu(e.lcZ(26,32,"PAGINATION.PAGE_SIZE")),e.xp6(3),e.lnq("",n.firstItem+1," - ",n.lastItem+1," ",e.lcZ(29,34,"PROJECT.OF")," "),e.xp6(2),e.AsE(" ",null==o.projects?null:o.projects.length," ",e.lcZ(31,36,"PROJECT.ITEMS")," ")}},dependencies:[i.C9t,i.Gwl,i.m4W,i.f6,i.Z4N,i.fv_,i.dRQ,i.Ltv,i.YYR,i.PDs,i.KHL,i.Gcc,i.jND,i.Nh1,i.dml,i.K8c,i.qvL,i.nqY,i.f_W,i.zwp,i.ZUS,i.lU3,g.sg,g.O5,O.yS,f.X$,b.Z],styles:[".check[_ngcontent-%COMP%]{margin-right:5px;color:green}.permissions[_ngcontent-%COMP%]{height:16px;display:flex;align-items:center}.datagrid-host[_ngcontent-%COMP%]{position:inherit}.dropdown-menu[_ngcontent-%COMP%]{overflow-y:auto}.dropdown-item[_ngcontent-%COMP%]{min-height:20px;display:flex;align-items:center}.ml-20px[_ngcontent-%COMP%]{margin-left:20px}"]}),s})();var Z=r(8372),x=r(1884),V=r(9300),w=r(3900),A=r(8746),X=r(7579),d=r(3819),M=r(2421),T=r(5832),W=r(946),P=r(2752),N=r(9151),v=r(312),h=r(4006),ee=r(1201);const te=["robotForm"];function oe(s,c){1&s&&(e.TgZ(0,"h3",3),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&s&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"SYSTEM_ROBOT.CREATE_ROBOT")," "))}function ne(s,c){1&s&&(e.TgZ(0,"h3",3),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&s&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"SYSTEM_ROBOT.EDIT_ROBOT")," "))}function se(s,c){1&s&&(e.TgZ(0,"p",44),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&s&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"SYSTEM_ROBOT.CREATE_ROBOT_SUMMARY")," "))}function ie(s,c){1&s&&(e.TgZ(0,"p",44),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&s&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"SYSTEM_ROBOT.EDIT_ROBOT_SUMMARY")," "))}function le(s,c){1&s&&(e.TgZ(0,"clr-tooltip-content",45)(1,"span"),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&s&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"SYSTEM_ROBOT.FINAL_SYSTEM_NAME_TIP")))}function ce(s,c){1&s&&(e.TgZ(0,"clr-tooltip"),e._UZ(1,"clr-icon",18),e.YNc(2,le,4,3,"clr-tooltip-content",19),e.qZA())}function re(s,c){1&s&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&s&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"ROBOT_ACCOUNT.ACCOUNT_EXISTING")))}function ae(s,c){1&s&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&s&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"SYSTEM_ROBOT.NAME_TOOLTIP")))}function pe(s,c){if(1&s&&(e.TgZ(0,"clr-control-error"),e.YNc(1,re,3,3,"span",10),e.YNc(2,ae,3,3,"span",10),e.qZA()),2&s){const t=e.oxw(),o=e.MAs(18);e.xp6(1),e.Q6J("ngIf",!((o.dirty||o.touched)&&o.invalid)&&t.isNameExisting),e.xp6(1),e.Q6J("ngIf",(o.dirty||o.touched)&&o.invalid)}}function de(s,c){1&s&&(e.TgZ(0,"clr-tooltip-content",45)(1,"span"),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&s&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"SYSTEM_ROBOT.EXPIRATION_TIME_EXPLAIN")))}function _e(s,c){if(1&s&&(e.TgZ(0,"option",46),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&s){const t=e.oxw();e.xp6(1),e.AsE(" ",t.systemExpirationDays," ",e.lcZ(2,2,"SYSTEM_ROBOT.EXPIRATION_DEFAULT")," ")}}function ue(s,c){1&s&&(e.TgZ(0,"clr-control-error"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&s&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"SYSTEM_ROBOT.EXPIRATION_REQUIRED")," "))}function me(s,c){1&s&&e._UZ(0,"clr-icon",49)}const he=function(s){return{showWarning:s}};function ge(s,c){if(1&s&&(e.TgZ(0,"clr-control-helper")(1,"span",47),e.YNc(2,me,1,0,"clr-icon",48),e.TgZ(3,"span"),e._uU(4),e.ALo(5,"translate"),e.qZA(),e._uU(6,": "),e.TgZ(7,"span"),e._uU(8),e.ALo(9,"harborDatetime"),e.qZA()()()),2&s){const t=e.oxw();e.xp6(1),e.Q6J("ngClass",e.VKq(9,he,t.shouldShowWarning())),e.xp6(1),e.Q6J("ngIf",t.shouldShowWarning()),e.xp6(2),e.Oqu(e.lcZ(5,4,"SYSTEM_ROBOT.EXPIRES_AT")),e.xp6(4),e.Oqu(e.xi3(9,6,t.calculateExpiresAt(),"short"))}}function fe(s,c){1&s&&(e.TgZ(0,"clr-tooltip-content",45)(1,"span"),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&s&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"SYSTEM_ROBOT.COVER_ALL_EXPLAIN")))}function Ae(s,c){1&s&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&s&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"SYSTEM_ROBOT.SELECT_ALL")))}function Te(s,c){1&s&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&s&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"SYSTEM_ROBOT.UNSELECT_ALL")))}function Oe(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"div",53),e.NdJ("click",function(){const l=e.CHM(t).$implicit,a=e.oxw(2);return e.KtG(a.chooseAccess(l))}),e._UZ(1,"clr-icon",54),e.TgZ(2,"span"),e._uU(3),e.ALo(4,"translate"),e.ALo(5,"translate"),e.qZA()()}if(2&s){const t=c.$implicit,o=e.oxw(2);e.xp6(1),e.Udp("visibility",t.checked?"visible":"hidden"),e.xp6(2),e.AsE("",e.lcZ(4,4,o.i18nMap[t.action])," ",e.lcZ(5,6,o.i18nMap[t.resource]),"")}}function be(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"clr-dropdown-menu",50)(1,"div")(2,"button",51),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.selectAllOrUnselectAll(n.defaultAccesses))}),e.YNc(3,Ae,3,3,"span",10),e.YNc(4,Te,3,3,"span",10),e.qZA()(),e.YNc(5,Oe,6,8,"div",52),e.qZA()}if(2&s){const t=e.oxw();e.Udp("height",230,"px"),e.xp6(3),e.Q6J("ngIf",t.isSelectAll(t.defaultAccesses)),e.xp6(1),e.Q6J("ngIf",!t.isSelectAll(t.defaultAccesses)),e.xp6(1),e.Q6J("ngForOf",t.defaultAccesses)}}function Ce(s,c){1&s&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&s&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"BUTTON.SAVE")))}function Se(s,c){1&s&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&s&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"BUTTON.ADD")))}const Re=function(){return{standalone:!0}};let y=(()=>{class s{constructor(t,o,n,l){this.configService=t,this.robotService=o,this.msgHandler=n,this.operationService=l,this.i18nMap=p.Y3,this.isEditMode=!1,this.addSuccess=new e.vpe,this.addRobotOpened=!1,this.systemRobot={},this.expirationType=p.I1.DAYS,this.coverAll=!1,this.coverAllForEdit=!1,this.isNameExisting=!1,this.loading=!1,this.checkNameOnGoing=!1,this.loadingSystemConfig=!1,this.defaultAccesses=[],this.defaultAccessesForEdit=[],this.saveBtnState=i.xp5.DEFAULT,this._nameSubject=new X.x}ngOnInit(){this.subscribeName()}ngOnDestroy(){this._nameSubscription&&(this._nameSubscription.unsubscribe(),this._nameSubscription=null)}subscribeName(){this._nameSubscription||(this._nameSubscription=this._nameSubject.pipe((0,Z.b)(500),(0,x.x)(),(0,V.h)(t=>(!this.isEditMode||!this.originalRobotForEdit||this.originalRobotForEdit.name!==t)&&t?.length>0),(0,w.w)(t=>(this.isNameExisting=!1,this.checkNameOnGoing=!0,this.robotService.ListRobot({q:encodeURIComponent(`name=${t}`)}).pipe((0,A.x)(()=>this.checkNameOnGoing=!1))))).subscribe(t=>{t&&t.length>0&&(this.isNameExisting=!0)}))}isExpirationInvalid(){return this.systemRobot.duration<-1}inputExpiration(){this.expirationType=-1==+this.systemRobot.duration?p.I1.NEVER:p.I1.DAYS}changeExpirationType(){this.expirationType===p.I1.DEFAULT&&(this.systemRobot.duration=this.systemExpirationDays),this.expirationType===p.I1.DAYS&&(this.systemRobot.duration=this.systemExpirationDays),this.expirationType===p.I1.NEVER&&(this.systemRobot.duration=-1)}getSystemRobotExpiration(){this.loadingSystemConfig=!0,this.configService.getConfiguration().pipe((0,A.x)(()=>this.loadingSystemConfig=!1)).subscribe(t=>{t&&t.robot_token_duration&&t.robot_token_duration.value&&(this.systemRobot.duration=t.robot_token_duration.value,this.systemExpirationDays=this.systemRobot.duration)})}inputName(){this._nameSubject.next(this.systemRobot.name)}cancel(){this.addRobotOpened=!1}getPermissions(){let t=0;return this.defaultAccesses.forEach(o=>{o.checked&&t++}),t}chooseAccess(t){t.checked=!t.checked}reset(){this.open(!1),this.defaultAccesses=(0,_.d9)(p.B0),this.listAllProjectsComponent.init(!1),this.listAllProjectsComponent.selectedRow=[],this.systemRobot={},this.robotForm.reset(),this.expirationType=p.I1.DAYS,this.getSystemRobotExpiration()}resetForEdit(t){this.open(!0),this.defaultAccesses=(0,_.d9)(p.B0),this.defaultAccesses.forEach(n=>n.checked=!1),this.originalRobotForEdit=(0,_.d9)(t),this.systemRobot=t,this.expirationType=-1===t.duration?p.I1.NEVER:p.I1.DAYS,t&&t.permissions&&t.permissions.length&&(this.coverAll=!1,t.permissions.forEach(n=>{n.kind===p.sC.PROJECT&&n.namespace===p.IH&&(this.coverAll=!0,n&&n.access&&(n.access.forEach(l=>{this.defaultAccesses.forEach(a=>{a.resource===l.resource&&a.action===l.action&&(a.checked=!0)})}),this.defaultAccessesForEdit=(0,_.d9)(this.defaultAccesses)))})),this.coverAll||this.defaultAccesses.forEach(n=>n.checked=!0),this.robotForm.reset({name:this.systemRobot.name,expiration:this.systemRobot.duration,description:this.systemRobot.description,coverAll:this.coverAll}),this.coverAllForEdit=this.coverAll,this.listAllProjectsComponent.init(!0),this.listAllProjectsComponent.selectedRow=[];const o={};this.listAllProjectsComponent.projects.forEach((n,l)=>{this.systemRobot&&this.systemRobot.permissions&&this.systemRobot.permissions.forEach(a=>{n.name===a.namespace&&(a.access.forEach(u=>{n.permissions[0].access.forEach(m=>{m.resource===u.resource&&m.action===u.action&&(m.checked=!0)})}),o[l]=!0,this.listAllProjectsComponent.selectedRow.push(n))})}),this.listAllProjectsComponent.defaultAccesses.forEach(n=>n.checked=!0),this.listAllProjectsComponent.projects.forEach((n,l)=>{o[l]||n.permissions[0].access.forEach(a=>{a.checked=!0})})}open(t){this.isNameExisting=!1,this.isEditMode=t,this.addRobotOpened=!0,this.inlineAlertComponent.close(),this._nameSubject.next("")}disabled(){return this.isEditMode?!this.canEdit():!this.canAdd()}canAdd(){if(this.robotForm.invalid)return!1;if(this.coverAll){let t=!1;if(this.defaultAccesses.forEach(o=>{o.checked&&(t=!0)}),t)return!0}if(!this.listAllProjectsComponent||!this.listAllProjectsComponent.selectedRow||!this.listAllProjectsComponent.selectedRow.length)return!1;for(let t=0;t<this.listAllProjectsComponent.selectedRow.length;t++){let o=!1;for(let n=0;n<this.listAllProjectsComponent.selectedRow[t].permissions[0].access.length;n++)this.listAllProjectsComponent.selectedRow[t].permissions[0].access[n].checked&&(o=!0);if(!o)return!1}return!0}canEdit(){if(!this.canAdd())return!1;if(this.systemRobot.duration!=this.originalRobotForEdit.duration||this.systemRobot.description!=this.originalRobotForEdit.description)return!0;if(this.coverAll!==this.coverAllForEdit){if(this.coverAll){let l=!1;if(this.defaultAccesses.forEach(a=>{a.checked&&(l=!0)}),!l)return!1}return!0}if(this.coverAll===this.coverAllForEdit&&this.coverAll){let l=!0;return this.defaultAccessesForEdit.forEach(a=>{this.defaultAccesses.forEach(u=>{a.resource===u.resource&&a.action===u.action&&a.checked!==u.checked&&(l=!1)})}),!l}if(this.systemRobot.permissions.length!==this.listAllProjectsComponent.selectedRow.length)return!0;const t={};let o=!0;if(this.listAllProjectsComponent.selectedRow.forEach(l=>{this.systemRobot.permissions.forEach(a=>{l.name===a.namespace&&(t[l.name]=!0,a.access.length!==this.getAccessNum(l.permissions[0].access)&&(o=!1),a.access.forEach(u=>{l.permissions[0].access.forEach(m=>{u.resource===m.resource&&u.action===m.action&&!m.checked&&(o=!1)})}))})}),!o)return!0;let n=!0;return this.systemRobot.permissions.forEach(l=>{t[l.namespace]||(n=!1)}),!n}save(){const t=(0,_.d9)(this.systemRobot);if(t.disable=!1,t.level=p.sC.SYSTEM,t.duration=+this.systemRobot.duration,t.permissions=[],this.coverAll){const o=[];this.defaultAccesses.forEach(n=>{n.checked&&o.push({resource:n.resource,action:n.action})}),t.permissions.push({kind:p.sC.PROJECT,namespace:p.IH,access:o})}else this.listAllProjectsComponent.selectedRow.forEach(o=>{const n=[];o.permissions[0].access.forEach(l=>{l.checked&&n.push({resource:l.resource,action:l.action})}),t.permissions.push({kind:p.sC.PROJECT,namespace:o.name,access:n})});if(t.permissions&&t.permissions.length)for(let o=0;o<t.permissions.length;o++)if((0,p.Ji)(t.permissions[o].access))return void this.inlineAlertComponent.showInlineError("SYSTEM_ROBOT.PUSH_PERMISSION_TOOLTIP");if(this.saveBtnState=i.xp5.LOADING,this.isEditMode){t.disable=this.systemRobot.disable;const o=new d.gB;o.name="SYSTEM_ROBOT.UPDATE_ROBOT",o.data.id=t.id,o.state=d.yb.progressing,o.data.name=t.name,this.operationService.publishInfo(o),this.robotService.UpdateRobot({robotId:this.originalRobotForEdit.id,robot:t}).subscribe(n=>{this.saveBtnState=i.xp5.SUCCESS,this.addSuccess.emit(null),this.addRobotOpened=!1,(0,d.hm)(o,d.yb.success),this.msgHandler.showSuccess("SYSTEM_ROBOT.UPDATE_ROBOT_SUCCESSFULLY")},n=>{this.saveBtnState=i.xp5.ERROR,(0,d.hm)(o,d.yb.failure,(0,T.Po)(n)),this.inlineAlertComponent.showInlineError(n)})}else{const o=new d.gB;o.name="SYSTEM_ROBOT.ADD_ROBOT",o.data.id=t.id,o.state=d.yb.progressing,o.data.name=t.name,this.operationService.publishInfo(o),this.robotService.CreateRobot({robot:t}).subscribe(n=>{this.saveBtnState=i.xp5.SUCCESS,this.addSuccess.emit(n),this.addRobotOpened=!1,(0,d.hm)(o,d.yb.success)},n=>{this.saveBtnState=i.xp5.ERROR,this.inlineAlertComponent.showInlineError(n),(0,d.hm)(o,d.yb.failure,(0,T.Po)(n))})}}getAccessNum(t){let o=0;return t.forEach(n=>{n.checked&&o++}),o}calculateExpiresAt(){return this.systemRobot&&this.systemRobot.creation_time&&this.systemRobot.duration>0?new Date(new Date(this.systemRobot.creation_time).getTime()+864e5*this.systemRobot.duration):null}shouldShowWarning(){return new Date>=this.calculateExpiresAt()}isSelectAll(t){return!!t?.length&&t.filter(o=>o.checked).length<t.length/2}selectAllOrUnselectAll(t){t?.length&&(this.isSelectAll(t)?t.forEach(o=>{o.checked=!0}):t.forEach(o=>{o.checked=!1}))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(W.e),e.Y36(P.b),e.Y36(N.d),e.Y36(v.f9))},s.\u0275cmp=e.Xpm({type:s,selectors:[["new-robot"]],viewQuery:function(t,o){if(1&t&&(e.Gf(E,5),e.Gf(M.l,5),e.Gf(te,7)),2&t){let n;e.iGM(n=e.CRH())&&(o.listAllProjectsComponent=n.first),e.iGM(n=e.CRH())&&(o.inlineAlertComponent=n.first),e.iGM(n=e.CRH())&&(o.robotForm=n.first)}},outputs:{addSuccess:"addSuccess"},decls:82,vars:69,consts:[["clrModalSize","lg",3,"clrModalOpen","clrModalStaticBackdrop","clrModalClosable","clrModalOpenChange"],["class","modal-title",4,"ngIf"],[1,"modal-body"],[1,"modal-title"],["class","mt-0",4,"ngIf"],[1,"clr-form","clr-form-horizontal","mt-1"],["robotForm","ngForm"],[1,"form-block"],[1,"clr-form-control"],["for","name",1,"clr-control-label","required"],[4,"ngIf"],[1,"clr-control-container"],[1,"clr-input-wrapper"],["type","text","id","name","required","","pattern","^[a-z0-9]+(?:[._-][a-z0-9]+)*$","maxLengthExt","255","autocomplete","off","size","30","name","name",1,"clr-input","input-width",3,"disabled","ngModel","ngModelChange","keyup"],["name","ngModel"],["shape","exclamation-circle",1,"clr-validate-icon"],[1,"spinner","spinner-inline",3,"hidden"],[1,"clr-control-label","required"],["clrTooltipTrigger","","shape","info-circle","size","24"],["clrPosition","top-right","clrSize","lg",4,"clrIfOpen"],[1,"clr-control-container","input-width"],[1,"flex"],[1,"clr-select-wrapper"],["id","expiration-type",1,"clr-select",3,"ngModelOptions","ngModel","change","ngModelChange"],["value","default",4,"ngIf"],["value","days"],["value","never"],["name","expiration","type","text","autocomplete","off","required","","pattern","^[\\-1-9]{1}[0-9]*$","id","robotTokenExpiration","size","20",1,"clr-input","expiration-width",3,"disabled","ngModel","input","ngModelChange"],["expiration","ngModel"],[1,"mt-description"],["clrTextarea","","type","text","id","description","name","description",1,"input-width",3,"ngModel","ngModelChange"],[1,"clr-control-label","mt-8px"],[1,"clr-control-container","padding-top-3","flex"],["clrCheckbox","","id","coverAll","name","coverAll","type","checkbox",3,"ngModel","ngModelChange"],["clrTooltipTrigger","","shape","info-circle","size","24",1,"opacity-07"],[1,"dropdown-per",3,"clrCloseMenuOnItemClick"],["clrDropdownTrigger","",1,"btn","btn-link"],["shape","caret down"],["class","dropdown-menu","clrPosition","bottom-left",3,"height",4,"clrIfOpen"],[1,"all-projects",3,"coverAll"],[1,"modal-footer"],[1,"message"],["id","system-robot-cancel","type","button",1,"btn","btn-outline",3,"click"],["id","system-robot-save","type","button",1,"btn","btn-primary",3,"disabled","clrLoading","click"],[1,"mt-0"],["clrPosition","top-right","clrSize","lg"],["value","default"],[3,"ngClass"],["class","alert-icon","shape","exclamation-triangle",4,"ngIf"],["shape","exclamation-triangle",1,"alert-icon"],["clrPosition","bottom-left",1,"dropdown-menu"],[1,"btn","btn-link","btn-sm","select-all-for-dropdown","ml-20px",3,"click"],["clrDropdownItem","",3,"click",4,"ngFor","ngForOf"],["clrDropdownItem","",3,"click"],["shape","check",1,"check"]],template:function(t,o){if(1&t&&(e.TgZ(0,"clr-modal",0),e.NdJ("clrModalOpenChange",function(l){return o.addRobotOpened=l}),e.YNc(1,oe,3,3,"h3",1),e.YNc(2,ne,3,3,"h3",1),e.TgZ(3,"div",2),e._UZ(4,"inline-alert",3),e.YNc(5,se,3,3,"p",4),e.YNc(6,ie,3,3,"p",4),e.TgZ(7,"form",5,6)(9,"section",7)(10,"div",8)(11,"label",9),e._uU(12),e.ALo(13,"translate"),e.YNc(14,ce,3,0,"clr-tooltip",10),e.qZA(),e.TgZ(15,"div",11)(16,"div",12)(17,"input",13,14),e.NdJ("ngModelChange",function(l){return o.systemRobot.name=l})("keyup",function(){return o.inputName()}),e.qZA(),e._UZ(19,"clr-icon",15)(20,"span",16),e.qZA(),e.YNc(21,pe,3,2,"clr-control-error",10),e.qZA()(),e.TgZ(22,"div",8)(23,"label",17),e._uU(24),e.ALo(25,"translate"),e.TgZ(26,"clr-tooltip"),e._UZ(27,"clr-icon",18),e.YNc(28,de,4,3,"clr-tooltip-content",19),e.qZA()(),e.TgZ(29,"div",20)(30,"div",21)(31,"div",22)(32,"select",23),e.NdJ("change",function(){return o.changeExpirationType()})("ngModelChange",function(l){return o.expirationType=l}),e.YNc(33,_e,3,4,"option",24),e.TgZ(34,"option",25),e._uU(35),e.ALo(36,"translate"),e.qZA(),e.TgZ(37,"option",26),e._uU(38),e.ALo(39,"translate"),e.qZA()()(),e.TgZ(40,"div",12)(41,"input",27,28),e.NdJ("input",function(){return o.inputExpiration()})("ngModelChange",function(l){return o.systemRobot.duration=l}),e.qZA(),e._UZ(43,"clr-icon",15)(44,"span",16),e.YNc(45,ue,3,3,"clr-control-error",10),e.qZA()(),e.YNc(46,ge,10,11,"clr-control-helper",10),e.qZA()(),e.TgZ(47,"clr-textarea-container",29)(48,"label"),e._uU(49),e.ALo(50,"translate"),e.qZA(),e.TgZ(51,"textarea",30),e.NdJ("ngModelChange",function(l){return o.systemRobot.description=l}),e.qZA()(),e.TgZ(52,"div",8)(53,"label",31),e._uU(54),e.ALo(55,"translate"),e.qZA(),e.TgZ(56,"div",32)(57,"clr-checkbox-wrapper")(58,"input",33),e.NdJ("ngModelChange",function(l){return o.coverAll=l}),e.qZA(),e.TgZ(59,"label")(60,"clr-tooltip"),e._UZ(61,"clr-icon",34),e.YNc(62,fe,4,3,"clr-tooltip-content",19),e.qZA()()(),e.TgZ(63,"clr-dropdown",35)(64,"button",36),e._uU(65),e.ALo(66,"translate"),e._UZ(67,"clr-icon",37),e.qZA(),e.YNc(68,be,6,5,"clr-dropdown-menu",38),e.qZA()()()(),e.TgZ(69,"div",8),e._UZ(70,"app-list-all-projects",39),e.qZA()()(),e.TgZ(71,"div",40)(72,"span",41),e._uU(73),e.ALo(74,"translate"),e.qZA(),e.TgZ(75,"span")(76,"button",42),e.NdJ("click",function(){return o.cancel()}),e._uU(77),e.ALo(78,"translate"),e.qZA(),e.TgZ(79,"button",43),e.NdJ("click",function(){return o.save()}),e.YNc(80,Ce,3,3,"span",10),e.YNc(81,Se,3,3,"span",10),e.qZA()()()()),2&t){const n=e.MAs(18),l=e.MAs(42);e.Q6J("clrModalOpen",o.addRobotOpened)("clrModalStaticBackdrop",!0)("clrModalClosable",!0),e.xp6(1),e.Q6J("ngIf",!o.isEditMode),e.xp6(1),e.Q6J("ngIf",o.isEditMode),e.xp6(3),e.Q6J("ngIf",!o.isEditMode),e.xp6(1),e.Q6J("ngIf",o.isEditMode),e.xp6(6),e.hij("",e.lcZ(13,50,"P2P_PROVIDER.NAME")," "),e.xp6(2),e.Q6J("ngIf",!o.isEditMode),e.xp6(1),e.ekj("clr-error",(n.dirty||n.touched)&&n.invalid||o.isNameExisting),e.xp6(2),e.Q6J("disabled",o.loading||o.isEditMode)("ngModel",o.systemRobot.name),e.xp6(3),e.Q6J("hidden",!o.checkNameOnGoing),e.xp6(1),e.Q6J("ngIf",(n.dirty||n.touched)&&n.invalid||o.isNameExisting),e.xp6(3),e.hij("",e.lcZ(25,52,"SYSTEM_ROBOT.EXPIRATION_TIME")," "),e.xp6(5),e.ekj("clr-error",(l.dirty||l.touched)&&l.invalid||o.isExpirationInvalid()),e.xp6(3),e.Q6J("ngModelOptions",e.DdM(68,Re))("ngModel",o.expirationType),e.xp6(1),e.Q6J("ngIf",!o.isEditMode),e.xp6(2),e.hij(" ",e.lcZ(36,54,"SYSTEM_ROBOT.EXPIRATION_DAYS")," "),e.xp6(3),e.hij(" ",e.lcZ(39,56,"SYSTEM_ROBOT.EXPIRATION_NEVER")," "),e.xp6(3),e.Q6J("disabled",o.loadingSystemConfig)("ngModel",o.systemRobot.duration),e.xp6(3),e.Q6J("hidden",!o.loadingSystemConfig),e.xp6(1),e.Q6J("ngIf",(l.dirty||l.touched)&&l.invalid||o.isExpirationInvalid()),e.xp6(1),e.Q6J("ngIf",o.isEditMode&&(null==o.systemRobot?null:o.systemRobot.duration)>0&&!((l.dirty||l.touched)&&l.invalid)||o.isExpirationInvalid()),e.xp6(3),e.Oqu(e.lcZ(50,58,"DISTRIBUTION.DESCRIPTION")),e.xp6(2),e.Q6J("ngModel",o.systemRobot.description),e.xp6(3),e.Oqu(e.lcZ(55,60,"SYSTEM_ROBOT.COVER_ALL")),e.xp6(4),e.Q6J("ngModel",o.coverAll),e.xp6(5),e.Udp("visibility",o.coverAll?"visible":"hidden"),e.Q6J("clrCloseMenuOnItemClick",!1),e.xp6(2),e.AsE(" ",o.getPermissions()," ",e.lcZ(66,62,"SYSTEM_ROBOT.PERMISSIONS")," "),e.xp6(4),e.ekj("clr-form-control-disabled",o.coverAll),e.xp6(1),e.ekj("disabled",o.coverAll),e.Q6J("coverAll",o.coverAll),e.xp6(2),e.Udp("visibility",o.coverAll?"visible":"hidden"),e.xp6(1),e.Oqu(e.lcZ(74,64,"SYSTEM_ROBOT.COVER_ALL_SUMMARY")),e.xp6(4),e.hij(" ",e.lcZ(78,66,"BUTTON.CANCEL")," "),e.xp6(2),e.Q6J("disabled",o.disabled()||o.checkNameOnGoing||o.isNameExisting)("clrLoading",o.saveBtnState),e.xp6(1),e.Q6J("ngIf",o.isEditMode),e.xp6(1),e.Q6J("ngIf",!o.isEditMode)}},dependencies:[h._Y,h.YN,h.Kr,h.Fj,h.Wl,h.EJ,h.JJ,h.JL,h.Q7,h.c5,h.On,h.F,i.qvL,i.qAN,i.VLi,i.cCV,i.nqY,i.MPb,i.MgK,i.VqA,i.CM6,i.KKC,i.PEh,i.XE5,i.LAP,i.f_W,i.zwp,i.ZUS,i.lU3,i.Jmj,i.bMv,i.zDF,g.mk,g.sg,g.O5,ee.GA,M.l,E,f.X$,b.Z],styles:[".rule-width[_ngcontent-%COMP%]{width:100%}.input-width[_ngcontent-%COMP%]{width:350px}.padding-left-0[_ngcontent-%COMP%]{padding-left:0}.no-margin[_ngcontent-%COMP%]{margin:0}.permission[_ngcontent-%COMP%]{padding-top:.1rem;color:#000}.padding-left-120[_ngcontent-%COMP%]{padding-left:126px}.w-90[_ngcontent-%COMP%]{width:90%}.date[_ngcontent-%COMP%]{margin-top:-.9rem}.input-width-date[_ngcontent-%COMP%]{width:265px}.mt-description[_ngcontent-%COMP%]{margin-top:2.5rem}.width-table[_ngcontent-%COMP%]{width:388px}.all-projects[_ngcontent-%COMP%]{width:100%}.opacity-07[_ngcontent-%COMP%]{opacity:.7}.disabled[_ngcontent-%COMP%]{opacity:.5}.modal-footer[_ngcontent-%COMP%]{align-items:center;justify-content:space-between}.message[_ngcontent-%COMP%]{margin-left:10px}.flex[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.expiration-width[_ngcontent-%COMP%]{width:194px}.check[_ngcontent-%COMP%]{margin-right:5px;color:green}.dropdown-per[_ngcontent-%COMP%]{margin-top:-1px}.mt-8px[_ngcontent-%COMP%]{margin-top:8px!important}.showWarning[_ngcontent-%COMP%]{color:#b3a000}.dropdown-item[_ngcontent-%COMP%]{min-height:20px;display:flex;align-items:center}.dropdown-menu[_ngcontent-%COMP%]{overflow-y:auto}.ml-20px[_ngcontent-%COMP%]{margin-left:20px}"]}),s})();var L=r(8330),Ze=r(4004),xe=r(262);function we(s,c){if(1&s&&(e.TgZ(0,"div",21)(1,"span"),e._uU(2),e.ALo(3,"translate"),e.ALo(4,"translate"),e.qZA()()),2&s){const t=c.$implicit,o=e.oxw(3);e.xp6(2),e.AsE("",e.lcZ(3,2,o.i18nMap[t.action])," ",e.lcZ(4,4,o.i18nMap[t.resource]),"")}}function Me(s,c){if(1&s&&(e.TgZ(0,"clr-dropdown-menu",19),e.YNc(1,we,5,6,"div",20),e.qZA()),2&s){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",t.access)}}function Pe(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"clr-dg-row",12)(1,"clr-dg-cell")(2,"a",13),e.NdJ("click",function(){const l=e.CHM(t).$implicit,a=e.oxw();let u;return e.KtG(a.goToLink(null==(u=a.getProject(l))?null:u.project_id))}),e._uU(3),e.qZA()(),e.TgZ(4,"clr-dg-cell")(5,"div",14)(6,"clr-dropdown",15)(7,"button",16),e._uU(8),e.ALo(9,"translate"),e._UZ(10,"clr-icon",17),e.qZA(),e.YNc(11,Me,2,1,"clr-dropdown-menu",18),e.qZA()()(),e.TgZ(12,"clr-dg-cell"),e._uU(13),e.ALo(14,"harborDatetime"),e.qZA()()}if(2&s){const t=c.$implicit,o=e.oxw();let n;e.Q6J("clrDgItem",t),e.xp6(3),e.Oqu(t.namespace),e.xp6(3),e.Q6J("clrCloseMenuOnItemClick",!1),e.xp6(2),e.AsE(" ",null==t.access?null:t.access.length," ",e.lcZ(9,6,"SYSTEM_ROBOT.PERMISSIONS")," "),e.xp6(5),e.Oqu(e.xi3(14,8,null==(n=o.getProject(t))?null:n.creation_time,"short"))}}const Ne=function(){return[10,20,30]};let I=(()=>{class s{constructor(t){this.router=t,this.projectsModalOpened=!1,this.permissions=[],this.i18nMap=p.Y3}close(){this.projectsModalOpened=!1}getProject(t){if(this.cachedAllProjects&&this.cachedAllProjects.length)for(let o=0;o<this.cachedAllProjects.length;o++)if(t.namespace===this.cachedAllProjects[o].name)return this.cachedAllProjects[o];return null}goToLink(t){this.router.navigate(["harbor","projects",t])}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(O.F0))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-projects-modal"]],decls:38,vars:38,consts:[["clrModalSize","lg",3,"clrModalOpen","clrModalStaticBackdrop","clrModalClosable","clrModalOpenChange"],[1,"modal-title"],[1,"nav-divider"],[1,"name"],[1,"modal-body"],[1,"mt-0"],[3,"clrDgItem",4,"clrDgItems","clrDgItemsOf"],[3,"clrDgPageSize"],["pagination",""],[3,"clrPageSizeOptions"],[1,"modal-footer"],["type","button",1,"btn","btn-primary",3,"click"],[3,"clrDgItem"],["href","javascript:void(0)",3,"click"],[1,"permissions"],[3,"clrCloseMenuOnItemClick"],["clrDropdownTrigger","",1,"btn","btn-link"],["shape","caret down"],["clrPosition","bottom-left",4,"clrIfOpen"],["clrPosition","bottom-left"],["clrDropdownItem","",4,"ngFor","ngForOf"],["clrDropdownItem",""]],template:function(t,o){if(1&t&&(e.TgZ(0,"clr-modal",0),e.NdJ("clrModalOpenChange",function(l){return o.projectsModalOpened=l}),e.TgZ(1,"h3",1)(2,"span"),e._uU(3),e.ALo(4,"translate"),e.qZA(),e._UZ(5,"div",2),e.TgZ(6,"span",3),e._uU(7),e.qZA()(),e.TgZ(8,"div",4)(9,"p",5),e._uU(10),e.ALo(11,"translate"),e.qZA(),e.TgZ(12,"clr-datagrid")(13,"clr-dg-column"),e._uU(14),e.ALo(15,"translate"),e.qZA(),e.TgZ(16,"clr-dg-column"),e._uU(17),e.ALo(18,"translate"),e.qZA(),e.TgZ(19,"clr-dg-column"),e._uU(20),e.ALo(21,"translate"),e.qZA(),e.YNc(22,Pe,15,11,"clr-dg-row",6),e.TgZ(23,"clr-dg-footer")(24,"clr-dg-pagination",7,8)(26,"clr-dg-page-size",9),e._uU(27),e.ALo(28,"translate"),e.qZA(),e.TgZ(29,"span"),e._uU(30),e.ALo(31,"translate"),e.qZA(),e._uU(32),e.ALo(33,"translate"),e.qZA()()()(),e.TgZ(34,"div",10)(35,"button",11),e.NdJ("click",function(){return o.close()}),e._uU(36),e.ALo(37,"translate"),e.qZA()()()),2&t){const n=e.MAs(25);e.Q6J("clrModalOpen",o.projectsModalOpened)("clrModalStaticBackdrop",!0)("clrModalClosable",!0),e.xp6(3),e.Oqu(e.lcZ(4,19,"SYSTEM_ROBOT.PROJECTS_MODAL_TITLE")),e.xp6(4),e.Oqu(o.robotName),e.xp6(3),e.hij(" ",e.lcZ(11,21,"SYSTEM_ROBOT.PROJECTS_MODAL_SUMMARY")," "),e.xp6(4),e.Oqu(e.lcZ(15,23,"PROJECT.NAME")),e.xp6(3),e.Oqu(e.lcZ(18,25,"SYSTEM_ROBOT.PERMISSION_COLUMN")),e.xp6(3),e.Oqu(e.lcZ(21,27,"PROJECT.CREATION_TIME")),e.xp6(2),e.Q6J("clrDgItemsOf",o.permissions),e.xp6(2),e.Q6J("clrDgPageSize",10),e.xp6(2),e.Q6J("clrPageSizeOptions",e.DdM(37,Ne)),e.xp6(1),e.Oqu(e.lcZ(28,29,"PAGINATION.PAGE_SIZE")),e.xp6(3),e.lnq("",n.firstItem+1," - ",n.lastItem+1," ",e.lcZ(31,31,"PROJECT.OF")," "),e.xp6(2),e.AsE(" ",null==o.permissions?null:o.permissions.length," ",e.lcZ(33,33,"PROJECT.ITEMS")," "),e.xp6(4),e.hij(" ",e.lcZ(37,35,"BUTTON.CLOSE")," ")}},dependencies:[i.C9t,i.m4W,i.f6,i.Z4N,i.fv_,i.dRQ,i.Ltv,i.YYR,i.PDs,i.KHL,i.Gcc,i.jND,i.Nh1,i.dml,i.K8c,i.qvL,i.qAN,i.VLi,i.nqY,i.f_W,i.zwp,i.ZUS,i.lU3,g.sg,f.X$,b.Z],styles:['.nav-divider[_ngcontent-%COMP%]{display:inline-block;width:1px;height:30px;position:relative;top:10px;opacity:.15;content:"";margin-right:1rem;margin-left:1rem}.name[_ngcontent-%COMP%]{font-size:16px;opacity:.9}.permissions[_ngcontent-%COMP%]{height:16px;display:flex;align-items:center}.datagrid-host[_ngcontent-%COMP%]{position:inherit}']}),s})();var U=r(4128),ve=r(9646),D=r(8348),ye=r(529),j=r(8726),Le=r(5266),Ie=r(5681),Ue=r(1481),De=r(5538),je=r(3580);function qe(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"button",32),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.disableOrEnable())}),e._UZ(1,"clr-icon",33),e._uU(2,"\xa0 "),e.TgZ(3,"span",34),e._uU(4),e.ALo(5,"translate"),e.qZA()()}if(2&s){const t=e.oxw(2);e.Q6J("disabled",!(t.selectedRows&&1===t.selectedRows.length&&t.selectedRows[0].disable)),e.xp6(4),e.Oqu(e.lcZ(5,2,"WEBHOOK.ENABLED_BUTTON"))}}function Ye(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"button",32),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.disableOrEnable())}),e._UZ(1,"clr-icon",35),e._uU(2,"\xa0 "),e.TgZ(3,"span",36),e._uU(4),e.ALo(5,"translate"),e.qZA()()}if(2&s){const t=e.oxw(2);e.Q6J("disabled",!(t.selectedRows&&1===t.selectedRows.length&&!t.selectedRows[0].disable)),e.xp6(4),e.Oqu(e.lcZ(5,2,"WEBHOOK.DISABLED_BUTTON"))}}function Je(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"clr-dropdown-menu")(1,"button",23),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.openTokenModal())}),e._UZ(2,"clr-icon",24),e._uU(3,"\xa0 "),e.TgZ(4,"span",25),e._uU(5),e.ALo(6,"translate"),e.qZA()(),e.TgZ(7,"button",23),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.openNewRobotModal(!0))}),e._UZ(8,"clr-icon",26),e._uU(9,"\xa0 "),e.TgZ(10,"span",27),e._uU(11),e.ALo(12,"translate"),e.qZA()(),e.YNc(13,qe,6,4,"button",28),e.YNc(14,Ye,6,4,"button",28),e._UZ(15,"div",29),e.TgZ(16,"button",23),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.openDeleteRobotsDialog())}),e._UZ(17,"clr-icon",30),e._uU(18,"\xa0 "),e.TgZ(19,"span",31),e._uU(20),e.ALo(21,"translate"),e.qZA()()()}if(2&s){const t=e.oxw();e.xp6(1),e.Q6J("disabled",t.loadingData||!(t.selectedRows&&1===t.selectedRows.length)),e.xp6(4),e.Oqu(e.lcZ(6,8,"SYSTEM_ROBOT.VIEW_SECRET")),e.xp6(2),e.Q6J("disabled",t.loadingData||!(t.selectedRows&&1===t.selectedRows.length)),e.xp6(4),e.Oqu(e.lcZ(12,10,"BUTTON.EDIT")),e.xp6(2),e.Q6J("ngIf",t.selectedRows&&1===t.selectedRows.length&&t.selectedRows[0].disable),e.xp6(1),e.Q6J("ngIf",!(t.selectedRows&&1===t.selectedRows.length&&t.selectedRows[0].disable)),e.xp6(2),e.Q6J("disabled",t.loadingData||!(t.selectedRows&&t.selectedRows.length>=1)),e.xp6(4),e.Oqu(e.lcZ(21,12,"BUTTON.DELETE"))}}function ke(s,c){1&s&&e._UZ(0,"clr-icon",43)}function Be(s,c){1&s&&e._UZ(0,"clr-icon",44)}function Qe(s,c){if(1&s&&(e.TgZ(0,"div",52)(1,"span"),e._uU(2),e.ALo(3,"translate"),e.ALo(4,"translate"),e.qZA()()),2&s){const t=c.$implicit,o=e.oxw(4);e.xp6(2),e.AsE("",e.lcZ(3,2,o.i18nMap[t.action])," ",e.lcZ(4,4,o.i18nMap[t.resource]),"")}}function Fe(s,c){if(1&s&&(e.TgZ(0,"clr-dropdown-menu",50),e.YNc(1,Qe,5,6,"div",51),e.qZA()),2&s){const t=e.oxw(2).$implicit;e.xp6(1),e.Q6J("ngForOf",null==t.permissionScope?null:t.permissionScope.access)}}function ze(s,c){if(1&s&&(e.TgZ(0,"div",45)(1,"span"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"clr-dropdown",46)(5,"button",47),e._uU(6),e.ALo(7,"translate"),e._UZ(8,"clr-icon",48),e.qZA(),e.YNc(9,Fe,2,1,"clr-dropdown-menu",49),e.qZA()()),2&s){const t=e.oxw().$implicit;e.xp6(2),e.Oqu(e.lcZ(3,4,"SYSTEM_ROBOT.ALL_PROJECTS")),e.xp6(2),e.Q6J("clrCloseMenuOnItemClick",!1),e.xp6(2),e.AsE(" ",null==t.permissionScope||null==t.permissionScope.access?null:t.permissionScope.access.length," ",e.lcZ(7,6,"SYSTEM_ROBOT.PERMISSIONS")," ")}}function Ge(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"a",54),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2).$implicit,l=e.oxw();return e.KtG(l.openProjectModal(l.getProjects(n),n.name))}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&s){const t=e.oxw(2).$implicit,o=e.oxw();let n;e.xp6(1),e.AsE(" ",null==(n=o.getProjects(t))?null:n.length," ",e.lcZ(2,2,"SYSTEM_ROBOT.COVERED_PROJECTS")," ")}}function He(s,c){1&s&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&s&&(e.xp6(1),e.hij(" 0 ",e.lcZ(2,1,"SYSTEM_ROBOT.COVERED_PROJECTS")," "))}function Ke(s,c){if(1&s&&(e.TgZ(0,"span"),e.YNc(1,Ge,3,4,"a",53),e.YNc(2,He,3,3,"span",20),e.qZA()),2&s){const t=e.oxw().$implicit,o=e.oxw();let n,l;e.xp6(1),e.Q6J("ngIf",null==(n=o.getProjects(t))?null:n.length),e.xp6(1),e.Q6J("ngIf",!(null!=(l=o.getProjects(t))&&l.length))}}function $e(s,c){if(1&s&&(e.TgZ(0,"clr-dg-row",37)(1,"clr-dg-cell"),e._uU(2),e.qZA(),e.TgZ(3,"clr-dg-cell",38),e.YNc(4,ke,1,0,"clr-icon",39),e.YNc(5,Be,1,0,"clr-icon",40),e.qZA(),e.TgZ(6,"clr-dg-cell"),e.YNc(7,ze,10,8,"div",41),e.YNc(8,Ke,3,2,"span",20),e.qZA(),e.TgZ(9,"clr-dg-cell"),e._uU(10),e.ALo(11,"harborDatetime"),e.qZA(),e.TgZ(12,"clr-dg-cell"),e._UZ(13,"app-remaining-time",42),e.qZA(),e.TgZ(14,"clr-dg-cell"),e._uU(15),e.qZA()()),2&s){const t=c.$implicit,o=e.oxw();e.Q6J("clrDgItem",t),e.xp6(2),e.Oqu(t.name),e.xp6(1),e.Q6J("ngSwitch",t.disable),e.xp6(1),e.Q6J("ngSwitchCase",!1),e.xp6(1),e.Q6J("ngSwitchCase",!0),e.xp6(2),e.Q6J("ngIf",null==t.permissionScope?null:t.permissionScope.coverAll),e.xp6(1),e.Q6J("ngIf",!t.permissionScope||!(null!=t.permissionScope&&t.permissionScope.coverAll)),e.xp6(2),e.Oqu(e.xi3(11,11,t.creation_time,"short")),e.xp6(3),e.Q6J("deadline",null==t?null:t.expires_at)("timeDiff",o.deltaTime),e.xp6(2),e.Oqu(t.description)}}function Ve(s,c){if(1&s&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&s){e.oxw();const t=e.MAs(50);e.xp6(1),e.lnq("",t.firstItem+1," - ",t.lastItem+1," ",e.lcZ(2,3,"ROBOT_ACCOUNT.OF")," ")}}const Xe=function(){return[15,25,50]},C=100;let We=(()=>{class s{constructor(t,o,n,l,a,u,m,S){this.robotService=t,this.projectService=o,this.msgHandler=n,this.operateDialogService=l,this.operationService=a,this.sanitizer=u,this.translate=m,this.systemInfoService=S,this.i18nMap=p.Y3,this.pageSize=(0,_.tb)(_.V2.SYSTEM_ROBOT_COMPONENT),this.currentPage=1,this.total=0,this.robots=[],this.selectedRows=[],this.loading=!0,this.loadingData=!1,this.addBtnState=i.xp5.DEFAULT}ngOnInit(){this.getCurrenTime(),this.loadDataFromBackend(),this.searchSub||(this.searchSub=this.filterComponent.filterTerms.pipe((0,Z.b)(500),(0,x.x)(),(0,w.w)(t=>{this.currentPage=1,this.selectedRows=[];const o={page:this.currentPage,pageSize:this.pageSize};return this.searchKey=t,this.searchKey&&(o.q=encodeURIComponent(`name=~${this.searchKey}`)),this.loading=!0,this.robotService.ListRobotResponse(o).pipe((0,A.x)(()=>{this.loading=!1}))})).subscribe(t=>{this.total=Number.parseInt(t.headers.get("x-total-count"),10),this.robots=t.body,this.calculateProjects()},t=>{this.msgHandler.handleError(t)})),this.subscription||(this.subscription=this.operateDialogService.confirmationConfirm$.subscribe(t=>{t&&1===t.state&&4===t.source&&this.deleteRobots(t.data),1===t.state&&18===t.source&&this.operateRobot()}))}ngOnDestroy(){this.searchSub&&(this.searchSub.unsubscribe(),this.searchSub=null),this.subscription&&(this.subscription.unsubscribe(),this.subscription=null)}getCurrenTime(){this.systemInfoService.getSystemInfo().subscribe(t=>{t?.current_time&&(this.deltaTime=(new Date).getTime()-new Date(t?.current_time).getTime())})}loadDataFromBackend(){this.loadingData=!0,this.addBtnState=i.xp5.LOADING,this.projectService.listProjectsResponse({withDetail:!1,page:1,pageSize:C}).subscribe(t=>{if(t.headers){const o=t.headers.get("X-Total-Count"),n=parseInt(o,0);let l=t.body||[];if(n<=C)this.newRobotComponent&&this.newRobotComponent.listAllProjectsComponent&&(this.newRobotComponent.listAllProjectsComponent.cachedAllProjects=t.body),this.projectsModalComponent&&(this.projectsModalComponent.cachedAllProjects=t.body),this.loadingData=!1,this.addBtnState=i.xp5.ERROR;else{const a=Math.ceil(n/C),u=[];for(let m=2;m<=a;m++)u.push(this.projectService.listProjects({withDetail:!1,page:m,pageSize:C}));(0,U.D)(u).pipe((0,A.x)(()=>{this.loadingData=!1,this.addBtnState=i.xp5.ERROR})).subscribe(m=>{m&&m.length&&(m.forEach(S=>{l=l.concat(S)}),this.newRobotComponent&&this.newRobotComponent.listAllProjectsComponent&&(this.newRobotComponent.listAllProjectsComponent.cachedAllProjects=l),this.projectsModalComponent&&(this.projectsModalComponent.cachedAllProjects=l))})}}},t=>{this.loadingData=!1,this.addBtnState=i.xp5.ERROR})}clrLoad(t){t&&t.page&&t.page.size&&(this.pageSize=t.page.size,(0,_.Pe)(_.V2.SYSTEM_ROBOT_COMPONENT,this.pageSize)),this.selectedRows=[];const o={page:this.currentPage,pageSize:this.pageSize,sort:(0,_.td)(t)};this.searchKey&&(o.q=encodeURIComponent(`name=~${this.searchKey}`)),this.loading=!0,this.robotService.ListRobotResponse(o).pipe((0,A.x)(()=>this.loading=!1)).subscribe(n=>{this.total=Number.parseInt(n.headers.get("x-total-count"),10),this.robots=n.body,this.calculateProjects()},n=>{this.msgHandler.error(n)})}openNewRobotModal(t){t?this.newRobotComponent.resetForEdit((0,_.d9)(this.selectedRows[0])):this.newRobotComponent.reset()}openTokenModal(){this.viewTokenComponent.open(),this.viewTokenComponent.robot=(0,_.d9)(this.selectedRows[0])}calculateProjects(){if(this.robots&&this.robots.length)for(let t=0;t<this.robots.length;t++)if(this.robots[t]&&this.robots[t].permissions&&this.robots[t].permissions.length)for(let o=0;o<this.robots[t].permissions.length;o++)if(this.robots[t].permissions[o].kind===p.sC.PROJECT&&this.robots[t].permissions[o].namespace===p.IH){this.robots[t].permissionScope={coverAll:!0,access:this.robots[t].permissions[o].access};break}}getProjects(t){const o=[];if(t&&t.permissions&&t.permissions.length)for(let n=0;n<t.permissions.length;n++)t.permissions[n].kind===p.sC.PROJECT&&o.push(t.permissions[n]);return o}openProjectModal(t,o){this.projectsModalComponent.projectsModalOpened=!0,this.projectsModalComponent.robotName=o,this.projectsModalComponent.permissions=t}refresh(){this.currentPage=1,this.selectedRows=[],this.clrLoad()}deleteRobots(t){let o=[];t&&t.length&&(t.forEach(n=>{o.push(this.deleteRobot(n))}),(0,U.D)(...o).subscribe(n=>{let l;n&&n.length&&n.forEach(a=>{a instanceof ye.UA&&(l=(0,T.Po)(a))}),l?this.msgHandler.handleError(l):this.msgHandler.showSuccess("SYSTEM_ROBOT.DELETE_ROBOT_SUCCESS"),this.refresh()}))}deleteRobot(t){let o=new d.gB;return o.name="SYSTEM_ROBOT.DELETE_ROBOT",o.data.id=t.id,o.state=d.yb.progressing,o.data.name=t.name,this.operationService.publishInfo(o),this.robotService.DeleteRobot({robotId:t.id}).pipe((0,Ze.U)(()=>{(0,d.hm)(o,d.yb.success)}),(0,xe.K)(n=>{const l=(0,T.Po)(n);return(0,d.hm)(o,d.yb.failure,l),(0,ve.of)(n)}))}openDeleteRobotsDialog(){const t=this.selectedRows.map(n=>n.name).join(","),o=new j.c("ROBOT_ACCOUNT.DELETION_TITLE","ROBOT_ACCOUNT.DELETION_SUMMARY",t,this.selectedRows,4,2);this.operateDialogService.openComfirmDialog(o)}disableOrEnable(){const n=new j.c(this.selectedRows[0].disable?"SYSTEM_ROBOT.ENABLE_TITLE":"SYSTEM_ROBOT.DISABLE_TITLE",this.selectedRows[0].disable?"SYSTEM_ROBOT.ENABLE_SUMMARY":"SYSTEM_ROBOT.DISABLE_SUMMARY",this.selectedRows[0].name,this.selectedRows[0],18,this.selectedRows[0].disable?4:5);this.operateDialogService.openComfirmDialog(n)}operateRobot(){const t=(0,_.d9)(this.selectedRows[0]),o=t.disable?"SYSTEM_ROBOT.ENABLE_ROBOT_SUCCESSFULLY":"SYSTEM_ROBOT.DISABLE_ROBOT_SUCCESSFULLY";t.disable=!t.disable,delete t.secret;const n=new d.gB;n.name=t.disable?"SYSTEM_ROBOT.DISABLE_TITLE":"SYSTEM_ROBOT.ENABLE_TITLE",n.data.id=t.id,n.state=d.yb.progressing,n.data.name=t.name,this.operationService.publishInfo(n),this.robotService.UpdateRobot({robot:t,robotId:t.id}).subscribe(l=>{(0,d.hm)(n,d.yb.success),this.msgHandler.showSuccess(o),this.refresh()},l=>{(0,d.hm)(n,d.yb.failure,(0,T.Po)(l)),this.msgHandler.showSuccess(l)})}addSuccess(t){if(t){this.viewTokenComponent.open(),this.viewTokenComponent.tokenModalOpened=!1,this.viewTokenComponent.robot=(0,_.d9)(t),this.viewTokenComponent.copyToken=!0,this.translate.get("ROBOT_ACCOUNT.CREATED_SUCCESS",{param:t.name}).subscribe(n=>{this.viewTokenComponent.createSuccess=n});const o=`data:text/json;charset=utf-8, ${encodeURIComponent(JSON.stringify(t))}`;this.viewTokenComponent.downLoadHref=this.sanitizer.bypassSecurityTrustUrl(o),this.viewTokenComponent.downLoadFileName=`${t.name}.json`}this.refresh()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(P.b),e.Y36(Le.Y),e.Y36(N.d),e.Y36(Ie.O),e.Y36(v.f9),e.Y36(Ue.H7),e.Y36(f.sK),e.Y36(De.e))},s.\u0275cmp=e.Xpm({type:s,selectors:[["system-robot-accounts"]],viewQuery:function(t,o){if(1&t&&(e.Gf(y,7),e.Gf(L.N,5),e.Gf(I,5),e.Gf(D.z,7)),2&t){let n;e.iGM(n=e.CRH())&&(o.newRobotComponent=n.first),e.iGM(n=e.CRH())&&(o.viewTokenComponent=n.first),e.iGM(n=e.CRH())&&(o.projectsModalComponent=n.first),e.iGM(n=e.CRH())&&(o.filterComponent=n.first)}},decls:60,vars:56,consts:[[1,"custom-h2"],[1,"row","robot-space"],[1,"row","flex-items-xs-between","rightPos"],[1,"flex-xs-middle","option-left"],[1,"flex-xs-middle","option-right"],[3,"width","withDivider","filterPlaceholder"],[1,"refresh-btn",3,"click"],["shape","refresh"],[1,"col-lg-12","col-md-12","col-sm-12","col-xs-12"],[1,"btn","btn-secondary",3,"disabled","clrLoading","click"],["shape","plus","size","16"],["clrDropdownTrigger","",1,"btn","btn-link",3,"clrCloseMenuOnItemClick"],["shape","caret\n            down"],[4,"clrIfOpen"],[3,"clrDgLoading","clrDgSelected","clrDgRefresh","clrDgSelectedChange"],[3,"clrDgSortBy"],[3,"clrDgItem",4,"ngFor","ngForOf"],[3,"clrDgPageSize","clrDgPage","clrDgTotalItems","clrDgPageChange"],["pagination",""],[3,"clrPageSizeOptions"],[4,"ngIf"],[3,"addSuccess"],[3,"refreshSuccess"],["clrDropdownItem","",3,"disabled","click"],["shape","details","size","16"],["id","system-robot-token"],["shape","edit","size","16"],["id","system-robot-edit"],["type","button","class","btn btn-secondary",3,"disabled","click",4,"ngIf"],[1,"dropdown-divider"],["shape","window-close","size","16"],["id","system-robot-delete"],["type","button",1,"btn","btn-secondary",3,"disabled","click"],["size","16","shape","success-standard"],["id","distribution-enable"],["size","16","shape","ban"],["id","distribution-disable"],[3,"clrDgItem"],[3,"ngSwitch"],["shape","check-circle","size","20","class","color-green",4,"ngSwitchCase"],["shape","times-circle","size","16","class","color-red red-position",4,"ngSwitchCase"],["class","all-projects",4,"ngIf"],[3,"deadline","timeDiff"],["shape","check-circle","size","20",1,"color-green"],["shape","times-circle","size","16",1,"color-red","red-position"],[1,"all-projects"],[3,"clrCloseMenuOnItemClick"],["clrDropdownTrigger","",1,"btn","btn-link"],["shape","caret down"],["clrPosition","bottom-left",4,"clrIfOpen"],["clrPosition","bottom-left"],["clrDropdownItem","",4,"ngFor","ngForOf"],["clrDropdownItem",""],["href","javascript:void(0)",3,"click",4,"ngIf"],["href","javascript:void(0)",3,"click"]],template:function(t,o){1&t&&(e.TgZ(0,"h2",0),e._uU(1),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"div",1)(4,"div")(5,"div",2),e._UZ(6,"div",3),e.TgZ(7,"div",4),e._UZ(8,"hbr-filter",5),e.ALo(9,"translate"),e.TgZ(10,"span",6),e.NdJ("click",function(){return o.refresh()}),e._UZ(11,"clr-icon",7),e.qZA()()()(),e.TgZ(12,"div",8)(13,"clr-dg-action-bar")(14,"button",9),e.NdJ("click",function(){return o.openNewRobotModal(!1)}),e.TgZ(15,"span"),e._UZ(16,"clr-icon",10),e._uU(17),e.ALo(18,"translate"),e.qZA()(),e.TgZ(19,"clr-dropdown",11)(20,"span"),e._uU(21),e.ALo(22,"translate"),e._UZ(23,"clr-icon",12),e.qZA(),e.YNc(24,Je,22,14,"clr-dropdown-menu",13),e.qZA()(),e.TgZ(25,"clr-datagrid",14),e.NdJ("clrDgRefresh",function(l){return o.clrLoad(l)})("clrDgSelectedChange",function(l){return o.selectedRows=l}),e.TgZ(26,"clr-dg-column",15),e._uU(27),e.ALo(28,"translate"),e.qZA(),e.TgZ(29,"clr-dg-column"),e._uU(30),e.ALo(31,"translate"),e.qZA(),e.TgZ(32,"clr-dg-column"),e._uU(33),e.ALo(34,"translate"),e.qZA(),e.TgZ(35,"clr-dg-column",15),e._uU(36),e.ALo(37,"translate"),e.qZA(),e.TgZ(38,"clr-dg-column"),e._uU(39),e.ALo(40,"translate"),e.qZA(),e.TgZ(41,"clr-dg-column"),e._uU(42),e.ALo(43,"translate"),e.qZA(),e.TgZ(44,"clr-dg-placeholder"),e._uU(45),e.ALo(46,"translate"),e.qZA(),e.YNc(47,$e,16,14,"clr-dg-row",16),e.TgZ(48,"clr-dg-footer")(49,"clr-dg-pagination",17,18),e.NdJ("clrDgPageChange",function(l){return o.currentPage=l}),e.TgZ(51,"clr-dg-page-size",19),e._uU(52),e.ALo(53,"translate"),e.qZA(),e.YNc(54,Ve,3,5,"span",20),e._uU(55),e.ALo(56,"translate"),e.qZA()()()()(),e.TgZ(57,"new-robot",21),e.NdJ("addSuccess",function(l){return o.addSuccess(l)}),e.qZA(),e.TgZ(58,"view-token",22),e.NdJ("refreshSuccess",function(){return o.refresh()}),e.qZA(),e._UZ(59,"app-projects-modal")),2&t&&(e.xp6(1),e.Oqu(e.lcZ(2,29,"SYSTEM_ROBOT.ROBOT_ACCOUNT_NAV")),e.xp6(7),e.s9C("filterPlaceholder",e.lcZ(9,31,"SYSTEM_ROBOT.SEARCH_BY_NAME")),e.Q6J("width",240)("withDivider",!0),e.xp6(6),e.Q6J("disabled",o.loadingData)("clrLoading",o.addBtnState),e.xp6(3),e.hij("\xa0",e.lcZ(18,33,"ROBOT_ACCOUNT.NEW_ROBOT_ACCOUNT")," "),e.xp6(2),e.Q6J("clrCloseMenuOnItemClick",!1),e.xp6(2),e.Oqu(e.lcZ(22,35,"MEMBER.ACTION")),e.xp6(4),e.Q6J("clrDgLoading",o.loading)("clrDgSelected",o.selectedRows),e.xp6(1),e.Q6J("clrDgSortBy","name"),e.xp6(1),e.Oqu(e.lcZ(28,37,"ROBOT_ACCOUNT.NAME")),e.xp6(3),e.Oqu(e.lcZ(31,39,"ROBOT_ACCOUNT.ENABLED_STATE")),e.xp6(3),e.Oqu(e.lcZ(34,41,"SYSTEM_ROBOT.PROJECTS")),e.xp6(2),e.Q6J("clrDgSortBy","creation_time"),e.xp6(1),e.Oqu(e.lcZ(37,43,"ROBOT_ACCOUNT.CREATETION")),e.xp6(3),e.Oqu(e.lcZ(40,45,"SYSTEM_ROBOT.EXPIRES_IN")),e.xp6(3),e.Oqu(e.lcZ(43,47,"ROBOT_ACCOUNT.DESCRIPTION")),e.xp6(3),e.Oqu(e.lcZ(46,49,"SYSTEM_ROBOT.NOT_FOUND")),e.xp6(2),e.Q6J("ngForOf",o.robots),e.xp6(2),e.Q6J("clrDgPageSize",o.pageSize)("clrDgPage",o.currentPage)("clrDgTotalItems",o.total),e.xp6(2),e.Q6J("clrPageSizeOptions",e.DdM(55,Xe)),e.xp6(1),e.Oqu(e.lcZ(53,51,"PAGINATION.PAGE_SIZE")),e.xp6(2),e.Q6J("ngIf",o.total),e.xp6(1),e.AsE(" ",o.total," ",e.lcZ(56,53,"ROBOT_ACCOUNT.ITEMS")," "))},dependencies:[i.C9t,i.Gwl,i.m4W,i.Z4N,i.fv_,i.dRQ,i.Ltv,i.YYR,i.F7K,i.PDs,i.KHL,i.Gcc,i.jND,i.Nh1,i.dml,i.K8c,i.qvL,i.cCV,i.nqY,i.MPb,i.f_W,i.zwp,i.ZUS,i.lU3,g.sg,g.O5,g.RF,g.n9,D.z,L.N,je.h,y,I,f.X$,b.Z],styles:[".robot-space[_ngcontent-%COMP%]{margin-top:28px;position:relative}.robot-space[_ngcontent-%COMP%]   clr-icon.red-position[_ngcontent-%COMP%]{margin-left:2px}.robot-space[_ngcontent-%COMP%]   .rightPos[_ngcontent-%COMP%]{position:absolute;z-index:100;right:35px;margin-top:4px}.robot-space[_ngcontent-%COMP%]   .rightPos[_ngcontent-%COMP%]   .option-left[_ngcontent-%COMP%]{padding-left:16px;position:relative;top:10px}.robot-space[_ngcontent-%COMP%]   .rightPos[_ngcontent-%COMP%]   .option-right[_ngcontent-%COMP%]{padding-right:16px}.robot-space[_ngcontent-%COMP%]   .rightPos[_ngcontent-%COMP%]   .option-right[_ngcontent-%COMP%]   .refresh-btn[_ngcontent-%COMP%]{cursor:pointer}.all-projects[_ngcontent-%COMP%]{display:flex;align-items:center;height:16px}"]}),s})();var et=r(6296);const tt=[{path:"",component:We}];let ot=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[et.m,O.Bz.forChild(tt)]}),s})()}}]);