"use strict";(self.webpackChunkharbor_portal=self.webpackChunkharbor_portal||[]).push([[6669],{822:(L,E,l)=>{l.d(E,{k:()=>e});var p=l(529),C=l(2529),P=l(9300),m=l(4004),O=l(4650),Z=l(5060);let e=(()=>{class u extends C.b{constructor(o,a){super(o,a)}listRegistryProviderTypesResponse(o){let a=this.newParams(),s=new p.WM;null!=o&&(s=s.set("X-Request-Id",o.toString()));let f=new p.aW("GET",this.rootUrl+"/replication/adapters",null,{headers:s,params:a,responseType:"json"});return this.http.request(f).pipe((0,P.h)(_=>_ instanceof p.Zn),(0,m.U)(_=>_))}listRegistryProviderTypes(o){return this.listRegistryProviderTypesResponse(o).pipe((0,m.U)(a=>a.body))}listRegistryProviderInfosResponse(o){let a=this.newParams(),s=new p.WM;null!=o&&(s=s.set("X-Request-Id",o.toString()));let f=new p.aW("GET",this.rootUrl+"/replication/adapterinfos",null,{headers:s,params:a,responseType:"json"});return this.http.request(f).pipe((0,P.h)(_=>_ instanceof p.Zn),(0,m.U)(_=>_))}listRegistryProviderInfos(o){return this.listRegistryProviderInfosResponse(o).pipe((0,m.U)(a=>a.body))}createRegistryResponse(o){let a=this.newParams(),s=new p.WM,g=null;g=o.registry,null!=o.XRequestId&&(s=s.set("X-Request-Id",o.XRequestId.toString()));let f=new p.aW("POST",this.rootUrl+"/registries",g,{headers:s,params:a,responseType:"json"});return this.http.request(f).pipe((0,P.h)(_=>_ instanceof p.Zn),(0,m.U)(_=>_))}createRegistry(o){return this.createRegistryResponse(o).pipe((0,m.U)(a=>a.body))}listRegistriesResponse(o){let a=this.newParams(),s=new p.WM;null!=o.sort&&(a=a.set("sort",o.sort.toString())),null!=o.q&&(a=a.set("q",o.q.toString())),null!=o.pageSize&&(a=a.set("page_size",o.pageSize.toString())),null!=o.page&&(a=a.set("page",o.page.toString())),null!=o.name&&(a=a.set("name",o.name.toString())),null!=o.XRequestId&&(s=s.set("X-Request-Id",o.XRequestId.toString()));let f=new p.aW("GET",this.rootUrl+"/registries",null,{headers:s,params:a,responseType:"json"});return this.http.request(f).pipe((0,P.h)(_=>_ instanceof p.Zn),(0,m.U)(_=>_))}listRegistries(o){return this.listRegistriesResponse(o).pipe((0,m.U)(a=>a.body))}pingRegistryResponse(o){let a=this.newParams(),s=new p.WM,g=null;g=o.registry,null!=o.XRequestId&&(s=s.set("X-Request-Id",o.XRequestId.toString()));let f=new p.aW("POST",this.rootUrl+"/registries/ping",g,{headers:s,params:a,responseType:"json"});return this.http.request(f).pipe((0,P.h)(_=>_ instanceof p.Zn),(0,m.U)(_=>_))}pingRegistry(o){return this.pingRegistryResponse(o).pipe((0,m.U)(a=>a.body))}getRegistryResponse(o){let a=this.newParams(),s=new p.WM;null!=o.XRequestId&&(s=s.set("X-Request-Id",o.XRequestId.toString()));let f=new p.aW("GET",this.rootUrl+`/registries/${o.id}`,null,{headers:s,params:a,responseType:"json"});return this.http.request(f).pipe((0,P.h)(_=>_ instanceof p.Zn),(0,m.U)(_=>_))}getRegistry(o){return this.getRegistryResponse(o).pipe((0,m.U)(a=>a.body))}deleteRegistryResponse(o){let a=this.newParams(),s=new p.WM;null!=o.XRequestId&&(s=s.set("X-Request-Id",o.XRequestId.toString()));let f=new p.aW("DELETE",this.rootUrl+`/registries/${o.id}`,null,{headers:s,params:a,responseType:"json"});return this.http.request(f).pipe((0,P.h)(_=>_ instanceof p.Zn),(0,m.U)(_=>_))}deleteRegistry(o){return this.deleteRegistryResponse(o).pipe((0,m.U)(a=>a.body))}updateRegistryResponse(o){let a=this.newParams(),s=new p.WM,g=null;g=o.registry,null!=o.XRequestId&&(s=s.set("X-Request-Id",o.XRequestId.toString()));let f=new p.aW("PUT",this.rootUrl+`/registries/${o.id}`,g,{headers:s,params:a,responseType:"json"});return this.http.request(f).pipe((0,P.h)(_=>_ instanceof p.Zn),(0,m.U)(_=>_))}updateRegistry(o){return this.updateRegistryResponse(o).pipe((0,m.U)(a=>a.body))}getRegistryInfoResponse(o){let a=this.newParams(),s=new p.WM;null!=o.XRequestId&&(s=s.set("X-Request-Id",o.XRequestId.toString()));let f=new p.aW("GET",this.rootUrl+`/registries/${o.id}/info`,null,{headers:s,params:a,responseType:"json"});return this.http.request(f).pipe((0,P.h)(_=>_ instanceof p.Zn),(0,m.U)(_=>_))}getRegistryInfo(o){return this.getRegistryInfoResponse(o).pipe((0,m.U)(a=>a.body))}}return u.listRegistryProviderTypesPath="/replication/adapters",u.listRegistryProviderInfosPath="/replication/adapterinfos",u.createRegistryPath="/registries",u.listRegistriesPath="/registries",u.pingRegistryPath="/registries/ping",u.getRegistryPath="/registries/{id}",u.deleteRegistryPath="/registries/{id}",u.updateRegistryPath="/registries/{id}",u.getRegistryInfoPath="/registries/{id}/info",u.\u0275fac=function(o){return new(o||u)(O.LFG(Z.p),O.LFG(p.eN))},u.\u0275prov=O.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"}),u})()},98:(L,E,l)=>{l.d(E,{B:()=>e});var p=l(529),C=l(2529),P=l(9300),m=l(4004),O=l(4650),Z=l(5060);let e=(()=>{class u extends C.b{constructor(o,a){super(o,a)}getStatisticResponse(o){let a=this.newParams(),s=new p.WM;null!=o&&(s=s.set("X-Request-Id",o.toString()));let f=new p.aW("GET",this.rootUrl+"/statistics",null,{headers:s,params:a,responseType:"json"});return this.http.request(f).pipe((0,P.h)(_=>_ instanceof p.Zn),(0,m.U)(_=>_))}getStatistic(o){return this.getStatisticResponse(o).pipe((0,m.U)(a=>a.body))}}return u.getStatisticPath="/statistics",u.\u0275fac=function(o){return new(o||u)(O.LFG(Z.p),O.LFG(p.eN))},u.\u0275prov=O.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"}),u})()},6669:(L,E,l)=>{l.r(E),l.d(E,{ProjectsModule:()=>Ke});var p=l(6296),C=l(4004),P=l(8372),m=l(1884),O=l(9300),Z=l(3900),e=l(4650),u=l(4006),T=l(4128),o=l(4968);class a{constructor(){this.metadata={},this.metadata.public=!1}}var s=l(6742),g=l(3526),f=l(2421),_=l(5266),y=l(2466),S=l(9151),X=l(822),h=l(9375),A=l(6895),R=l(858);const z=["projectForm"],H=["projectName"];function W(i,d){if(1&i&&(e.TgZ(0,"clr-control-error",29)(1,"span",30),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&i){const t=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,1,t.nameTooltipText))}}function k(i,d){1&i&&(e.TgZ(0,"clr-tooltip-content",31)(1,"span"),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&i&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"PROJECT.INLINE_HELP_PUBLIC")))}function K(i,d){1&i&&(e.TgZ(0,"clr-tooltip-content",31)(1,"span"),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&i&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"PROJECT.QUOTA_UNLIMIT_TIP")))}function $(i,d){if(1&i&&(e.TgZ(0,"option",39),e._uU(1),e.qZA()),2&i){const t=e.oxw().$implicit;e.Q6J("value",t.UNIT),e.xp6(1),e.hij(" ",t.UNIT," ")}}function ee(i,d){1&i&&e.YNc(0,$,2,2,"option",38),2&i&&e.Q6J("ngIf",d.index>1)}function te(i,d){1&i&&(e.TgZ(0,"clr-control-error",29),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"PROJECT.STORAGE_QUOTA_TIP")," "))}function ne(i,d){if(1&i){const t=e.EpF();e.TgZ(0,"div",5)(1,"label",32),e._uU(2),e.ALo(3,"translate"),e.TgZ(4,"clr-tooltip"),e._UZ(5,"clr-icon",15),e.YNc(6,K,4,3,"clr-tooltip-content",16),e.qZA()(),e.TgZ(7,"div",7)(8,"input",33,34),e.NdJ("ngModelChange",function(r){e.CHM(t);const c=e.oxw();return e.KtG(c.storageLimit=r)}),e.qZA(),e._UZ(10,"clr-icon",11),e.TgZ(11,"div",35)(12,"select",36),e.NdJ("ngModelChange",function(r){e.CHM(t);const c=e.oxw();return e.KtG(c.storageLimitUnit=r)}),e.YNc(13,ee,1,1,"ng-template",37),e.qZA()(),e.YNc(14,te,3,3,"clr-control-error",13),e.qZA()()}if(2&i){const t=e.MAs(9),n=e.oxw();e.xp6(2),e.hij("",e.lcZ(3,7,"PROJECT.STORAGE_QUOTA")," "),e.xp6(5),e.ekj("clr-error",t.invalid&&(t.dirty||t.touched)||t.errors),e.xp6(1),e.Q6J("ngModel",n.storageLimit),e.xp6(4),e.Q6J("ngModel",n.storageLimitUnit),e.xp6(1),e.Q6J("ngForOf",n.quotaUnits),e.xp6(1),e.Q6J("ngIf",t.invalid&&(t.dirty||t.touched)||t.errors)}}function ie(i,d){1&i&&(e.TgZ(0,"clr-tooltip-content",31)(1,"span"),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&i&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"PROJECT.PROXY_CACHE_TOOLTIP")))}function re(i,d){if(1&i&&(e.TgZ(0,"option",39),e._uU(1),e.qZA()),2&i){const t=d.$implicit;e.Q6J("value",t.id),e.xp6(1),e.AsE(" ",t.name,"-",t.url," ")}}function oe(i,d){if(1&i){const t=e.EpF();e.TgZ(0,"div",43)(1,"select",44),e.NdJ("ngModelChange",function(r){e.CHM(t);const c=e.oxw(2);return e.KtG(c.project.registry_id=r)}),e._UZ(2,"option",45),e.YNc(3,re,2,3,"option",46),e.qZA()()}if(2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("ngModel",t.project.registry_id),e.xp6(2),e.Q6J("ngForOf",t.registries)}}function se(i,d){if(1&i){const t=e.EpF();e.TgZ(0,"div",5)(1,"label",20),e._uU(2),e.ALo(3,"translate"),e.TgZ(4,"clr-tooltip"),e._UZ(5,"clr-icon",15),e.YNc(6,ie,4,3,"clr-tooltip-content",16),e.qZA()(),e.TgZ(7,"clr-toggle-wrapper",40)(8,"input",41),e.NdJ("ngModelChange",function(r){e.CHM(t);const c=e.oxw();return e.KtG(c.enableProxyCache=r)}),e.qZA()(),e.YNc(9,oe,4,2,"div",42),e.qZA()}if(2&i){const t=e.oxw();e.xp6(2),e.hij("",e.lcZ(3,3,"PROJECT.PROXY_CACHE")," "),e.xp6(6),e.Q6J("ngModel",t.enableProxyCache),e.xp6(1),e.Q6J("ngIf",t.enableProxyCache)}}function le(i,d){1&i&&(e.TgZ(0,"div",47)(1,"span",48),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"a",49),e._uU(5),e.ALo(6,"translate"),e.qZA()()),2&i&&(e.xp6(2),e.Oqu(e.lcZ(3,2,"REPLICATION.NO_ENDPOINT_INFO")),e.xp6(3),e.Oqu(e.lcZ(6,4,"REPLICATION.ENDPOINTS")))}const I=100;let J=(()=>{class i{constructor(t,n,r,c){this.projectService=t,this.translateService=n,this.messageHandlerService=r,this.endpointService=c,this.quotaUnits=s.NZ,this.project=new a,this.storageLimitUnit=s.NZ[3].UNIT,this.initVal=new a,this.isSubmitOnGoing=!1,this.staticBackdrop=!0,this.closable=!1,this.isNameExisted=!1,this.nameTooltipText="PROJECT.NAME_TOOLTIP",this.checkOnGoing=!1,this.enableProxyCache=!1,this.endpoint="",this.create=new e.vpe,this.registries=[],this.supportedRegistryTypeQueryString="type={docker-hub harbor azure-acr aws-ecr google-gcr quay docker-registry github-ghcr jfrog-artifactory}"}ngOnInit(){this.isSystemAdmin&&this.getRegistries()}getRegistries(){this.endpointService.listRegistriesResponse({page:1,pageSize:I,q:this.supportedRegistryTypeQueryString}).subscribe(t=>{if(t.headers){const n=t.headers.get("X-Total-Count"),r=parseInt(n,0);let c=t.body||[];if(r<=I)this.registries=t.body||[];else{const v=Math.ceil(r/I),b=[];for(let x=2;x<=v;x++)b.push(this.endpointService.listRegistries({page:x,pageSize:I,q:this.supportedRegistryTypeQueryString}));(0,T.D)(b).subscribe(x=>{x&&x.length&&(x.forEach(N=>{c=c.concat(N)}),this.registries=c)})}}},t=>{this.messageHandlerService.error(t)})}ngAfterViewInit(){this.checkNameSubscribe||(this.checkNameSubscribe=(0,o.R)(this.projectNameInput.nativeElement,"input").pipe((0,C.U)(t=>t.target.value),(0,P.b)(300),(0,m.x)(),(0,O.h)(t=>this.currentForm.controls.create_project_name.valid&&t.length>0),(0,Z.w)(t=>(this.checkOnGoing=!0,this.isNameExisted=!1,this.projectService.listProjects({q:encodeURIComponent(`name=${t}`)})))).subscribe(t=>{t&&t.length&&(this.isNameExisted=!0),this.checkOnGoing=!1},t=>{this.checkOnGoing=!1,this.isNameExisted=!1}))}get isNameValid(){return!(this.currentForm&&this.currentForm.controls&&this.currentForm.controls.create_project_name&&(this.currentForm.controls.create_project_name.dirty||this.currentForm.controls.create_project_name.touched)&&!this.checkOnGoing&&(this.currentForm.controls.create_project_name.errors?(this.nameTooltipText="PROJECT.NAME_TOOLTIP",1):this.isNameExisted&&(this.nameTooltipText="PROJECT.NAME_ALREADY_EXISTS",1)))}ngOnChanges(t){t&&t.quotaObj&&t.quotaObj.currentValue&&(this.storageLimit=(0,g.gv)(this.quotaObj.storage_per_project,(0,g.d9)(s.NZ),0,(0,g.d9)(s.NZ)).partNumberHard,this.storageLimitUnit=this.storageLimit===s.GI?s.NZ[3].UNIT:(0,g.gv)(this.quotaObj.storage_per_project,(0,g.d9)(s.NZ),0,(0,g.d9)(s.NZ)).partCharacterHard,this.storageDefaultLimit=this.storageLimit,this.storageDefaultLimitUnit=this.storageLimitUnit,this.isSystemAdmin&&this.currentForm.form.controls.create_project_storage_limit.setValidators([u.kI.required,u.kI.pattern("(^-1$)|(^([1-9]+)([0-9]+)*$)"),(0,g.CG)(this.currentForm.form.controls.create_project_storage_limit_unit)]),this.currentForm.form.valueChanges.pipe((0,m.x)((n,r)=>JSON.stringify(n)===JSON.stringify(r))).subscribe(n=>{["create_project_storage_limit","create_project_storage_limit_unit"].forEach(r=>{this.currentForm.form.get(r)&&null!==this.currentForm.form.get(r).value&&this.currentForm.form.get(r).updateValueAndValidity()})}))}ngOnDestroy(){this.checkNameSubscribe&&(this.checkNameSubscribe.unsubscribe(),this.checkNameSubscribe=null)}onSubmit(){if(this.isSubmitOnGoing)return;this.isSubmitOnGoing=!0;const t=+this.storageLimit===s.GI?this.storageLimit:(0,g.J1)(+this.storageLimit,this.storageLimitUnit);this.projectService.createProject({project:{project_name:this.project.name,metadata:{public:this.project.metadata.public?"true":"false"},storage_limit:+t,registry_id:this.enableProxyCache?+this.project.registry_id:null}}).subscribe(r=>{this.isSubmitOnGoing=!1,this.create.emit(!0),this.messageHandlerService.showSuccess("PROJECT.CREATED_SUCCESS"),this.createProjectOpened=!1},r=>{this.isSubmitOnGoing=!1,this.inlineAlert.showInlineError(r)})}onCancel(){this.createProjectOpened=!1}newProject(){this.project=new a,this.hasChanged=!1,this.createProjectOpened=!0,this.enableProxyCache=!1,this.endpoint="",this.currentForm&&this.currentForm.controls&&this.currentForm.controls.create_project_name&&this.currentForm.controls.create_project_name.reset(),this.inlineAlert.close(),this.storageLimit=this.storageDefaultLimit,this.storageLimitUnit=this.storageDefaultLimitUnit}get isValid(){return this.currentForm&&this.currentForm.valid&&!this.isSubmitOnGoing&&this.isNameValid&&!this.checkOnGoing}getEndpoint(){if(this.registries&&this.registries.length&&this.project.registry_id)for(let t=0;t<this.registries.length;t++)if(+this.registries[t].id==+this.project.registry_id)return this.registries[t].url;return""}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(_.Y),e.Y36(y.sK),e.Y36(S.d),e.Y36(X.k))},i.\u0275cmp=e.Xpm({type:i,selectors:[["create-project"]],viewQuery:function(t,n){if(1&t&&(e.Gf(z,7),e.Gf(f.l,7),e.Gf(H,5)),2&t){let r;e.iGM(r=e.CRH())&&(n.currentForm=r.first),e.iGM(r=e.CRH())&&(n.inlineAlert=r.first),e.iGM(r=e.CRH())&&(n.projectNameInput=r.first)}},inputs:{quotaObj:"quotaObj",isSystemAdmin:"isSystemAdmin"},outputs:{create:"create"},features:[e.TTD],decls:52,vars:39,consts:[[3,"clrModalOpen","clrModalStaticBackdrop","clrModalClosable","clrModalOpenChange"],[1,"modal-title"],[1,"modal-body","modal-height"],[1,"clr-form","clr-form-horizontal"],["projectForm","ngForm"],[1,"clr-form-control"],[1,"required","clr-control-label"],[1,"clr-control-container"],[1,"clr-input-wrapper"],["type","text","id","create_project_name","name","create_project_name","required","","pattern","^[a-z0-9]+(?:[._-][a-z0-9]+)*$","autocomplete","off",1,"clr-input","input-width",3,"ngModel","ngModelChange"],["projectName",""],["shape","exclamation-circle",1,"clr-validate-icon"],[1,"spinner","spinner-inline",3,"hidden"],["class","tooltip-content",4,"ngIf"],[1,"form-group-label-override"],["clrTooltipTrigger","","shape","info-circle","size","24"],["clrPosition","bottom-left","clrSize","lg",4,"clrIfOpen"],["clrCheckbox","","type","checkbox","id","create_project_public","name","public",3,"ngModel","ngModelChange"],["class","clr-form-control",4,"ngIf"],[1,"clr-form-control","mt-0"],["for","create_project_storage_limit",1,"clr-control-label"],[1,"clr-control-container","input-width"],["class","space-between",4,"ngIf"],[1,"clr-form-control","mt-05"],[1,"clr-control-label","endpoint","required"],["placeholder","http(s)://192.168.1.1","readonly","","type","text","id","endpoint","autocomplete","off",1,"clr-input",3,"value"],[1,"modal-footer"],["id","new-project-cancel","type","button",1,"btn","btn-outline",3,"click"],["id","new-project-ok","type","button",1,"btn","btn-primary",3,"disabled","click"],[1,"tooltip-content"],["id","name-error"],["clrPosition","bottom-left","clrSize","lg"],["for","create_project_storage_limit",1,"required","clr-control-label"],["type","text","id","create_project_storage_limit","name","create_project_storage_limit","autocomplete","off",1,"mr-10","clr-input","width-182",3,"ngModel","ngModelChange"],["projectStorageLimit","ngModel"],[1,"clr-select-wrapper"],["id","create_project_storage_limit_unit","name","create_project_storage_limit_unit",3,"ngModel","ngModelChange"],["ngFor","",3,"ngForOf"],[3,"value",4,"ngIf"],[3,"value"],[1,"mt-02"],["type","checkbox","clrToggle","","name","proxy-cache","id","proxy-cache",3,"ngModel","ngModelChange"],["class","clr-select-wrapper ml-1",4,"ngIf"],[1,"clr-select-wrapper","ml-1"],["id","registry","name","registry",1,"width-164",3,"ngModel","ngModelChange"],["value","",1,"display-none"],[3,"value",4,"ngFor","ngForOf"],[1,"space-between"],[1,"alert-label"],["routerLink","/harbor/registries",1,"alert-label","go-link"]],template:function(t,n){1&t&&(e.TgZ(0,"clr-modal",0),e.NdJ("clrModalOpenChange",function(c){return n.createProjectOpened=c}),e.TgZ(1,"h3",1),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",2),e._UZ(5,"inline-alert"),e.TgZ(6,"form",3,4)(8,"div",5)(9,"label",6),e._uU(10),e.ALo(11,"translate"),e.qZA(),e.TgZ(12,"div",7)(13,"div",8)(14,"input",9,10),e.NdJ("ngModelChange",function(c){return n.project.name=c}),e.qZA(),e._UZ(16,"clr-icon",11)(17,"span",12),e.qZA(),e.YNc(18,W,4,3,"clr-control-error",13),e.qZA()(),e.TgZ(19,"clr-checkbox-container")(20,"label",14),e._uU(21),e.ALo(22,"translate"),e.TgZ(23,"clr-tooltip"),e._UZ(24,"clr-icon",15),e.YNc(25,k,4,3,"clr-tooltip-content",16),e.qZA()(),e.TgZ(26,"clr-checkbox-wrapper")(27,"input",17),e.NdJ("ngModelChange",function(c){return n.project.metadata.public=c}),e.qZA(),e.TgZ(28,"label"),e._uU(29),e.ALo(30,"translate"),e.qZA()()(),e.YNc(31,ne,15,9,"div",18),e.YNc(32,se,10,5,"div",18),e.TgZ(33,"div",19),e._UZ(34,"label",20),e.TgZ(35,"div",21),e.YNc(36,le,7,6,"div",22),e.qZA()(),e.TgZ(37,"div",23),e._UZ(38,"label",20),e.TgZ(39,"div",7)(40,"div",8)(41,"label",24),e._uU(42),e.ALo(43,"translate"),e.qZA(),e._UZ(44,"input",25),e.qZA()()()()(),e.TgZ(45,"div",26)(46,"button",27),e.NdJ("click",function(){return n.onCancel()}),e._uU(47),e.ALo(48,"translate"),e.qZA(),e.TgZ(49,"button",28),e.NdJ("click",function(){return n.onSubmit()}),e._uU(50),e.ALo(51,"translate"),e.qZA()()()),2&t&&(e.Q6J("clrModalOpen",n.createProjectOpened)("clrModalStaticBackdrop",n.staticBackdrop)("clrModalClosable",n.closable),e.xp6(2),e.Oqu(e.lcZ(3,25,"PROJECT.NEW_PROJECT")),e.xp6(8),e.Oqu(e.lcZ(11,27,"PROJECT.NAME")),e.xp6(2),e.ekj("clr-error",!n.isNameValid),e.xp6(2),e.Q6J("ngModel",n.project.name),e.xp6(3),e.Q6J("hidden",!n.checkOnGoing),e.xp6(1),e.Q6J("ngIf",!n.isNameValid),e.xp6(3),e.hij("",e.lcZ(22,29,"PROJECT.ACCESS_LEVEL")," "),e.xp6(6),e.Q6J("ngModel",n.project.metadata.public),e.xp6(2),e.Oqu(e.lcZ(30,31,"PROJECT.PUBLIC")),e.xp6(2),e.Q6J("ngIf",n.isSystemAdmin),e.xp6(1),e.Q6J("ngIf",n.isSystemAdmin),e.xp6(1),e.Udp("visibility",n.isSystemAdmin&&n.enableProxyCache?"visible":"hidden"),e.xp6(3),e.Q6J("ngIf",n.enableProxyCache&&!n.registries.length),e.xp6(1),e.Udp("visibility",n.isSystemAdmin&&n.enableProxyCache?"visible":"hidden"),e.xp6(5),e.Oqu(e.lcZ(43,33,"PROJECT.ENDPOINT")),e.xp6(2),e.Q6J("value",n.getEndpoint()),e.xp6(3),e.hij(" ",e.lcZ(48,35,"BUTTON.CANCEL")," "),e.xp6(2),e.Q6J("disabled",!n.isValid||n.enableProxyCache&&!n.project.registry_id),e.xp6(1),e.hij(" ",e.lcZ(51,37,"BUTTON.OK")," "))},dependencies:[u._Y,u.YN,u.Kr,u.Fj,u.Wl,u.EJ,u.JJ,u.JL,u.Q7,u.c5,u.On,u.F,h.qvL,h.qAN,h.VLi,h.nqY,h.MgK,h.VqA,h.KKC,h.Y_4,h.PEh,h.Jmj,h.bMv,h.zDF,A.sg,A.O5,f.l,R.yS,y.X$],styles:[".mr-10[_ngcontent-%COMP%]{margin-right:.5rem}.display-flex[_ngcontent-%COMP%]{display:flex;align-items:center}.pos-inherit[_ngcontent-%COMP%]{position:inherit}.clr-error[_ngcontent-%COMP%]   .clr-select-wrapper[_ngcontent-%COMP%]:after{right:.25rem!important}.input-width[_ngcontent-%COMP%]{width:242px}.mt-02[_ngcontent-%COMP%]{margin-top:.2rem}.width-164[_ngcontent-%COMP%]{width:164px}.endpoint[_ngcontent-%COMP%]{display:inline-block;width:72px}.display-none[_ngcontent-%COMP%]{display:none}.space-between[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.go-link[_ngcontent-%COMP%]{line-height:1rem;cursor:pointer}.alert-label[_ngcontent-%COMP%]{color:red;font-size:12px}.width-182[_ngcontent-%COMP%]{width:182px}.mt-05[_ngcontent-%COMP%]{margin-top:.5rem}"]}),i})();var ae=l(9646),M=l(268),U=l(8746),ce=l(262),j=l(3819),pe=l(529),D=l(5832),de=l(8726),F=l(38),ge=l(1647),ue=l(6078),he=l(6082);const _e=["names"],me=["exportCVEForm"];function fe(i,d){if(1&i&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.hij("(",null==t.selectedProjects?null:t.selectedProjects.length,")")}}function Ce(i,d){if(1&i&&e._UZ(0,"hbr-label-piece",35),2&i){const t=e.oxw().$implicit;e.Q6J("hasIcon",!1)("label",t)("labelWidth",84)}}function Te(i,d){if(1&i&&(e.ynx(0),e.YNc(1,Ce,1,3,"hbr-label-piece",34),e.BQk()),2&i){const t=d.index;e.xp6(1),e.Q6J("ngIf",t<=0)}}function Pe(i,d){1&i&&(e.TgZ(0,"span",36),e._uU(1,"\xb7\xb7\xb7"),e.qZA())}function ve(i,d){1&i&&e._UZ(0,"clr-spinner",39),2&i&&e.Q6J("clrMedium",!0)}function be(i,d){if(1&i){const t=e.EpF();e.TgZ(0,"button",42),e.NdJ("click",function(){const c=e.CHM(t).$implicit,v=e.oxw(3);return e.KtG(v.selectOrUnselect(c))}),e._UZ(1,"clr-icon",43)(2,"hbr-label-piece",44),e.qZA()}if(2&i){const t=d.$implicit,n=e.oxw(3);e.xp6(1),e.Udp("visibility",n.isSelected(t)?"visible":"hidden"),e.xp6(1),e.Q6J("label",t)("labelWidth",130)}}function Oe(i,d){1&i&&(e.TgZ(0,"button",45)(1,"span",46),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"span",47),e._uU(5),e.ALo(6,"translate"),e.qZA()()),2&i&&(e.xp6(2),e.Oqu(e.lcZ(3,2,"REPLICATION.NO_LABEL_INFO")),e.xp6(3),e.Oqu(e.lcZ(6,4,"CONFIG.LABEL")))}function Ee(i,d){if(1&i&&(e.ynx(0),e.YNc(1,be,3,4,"button",40),e.YNc(2,Oe,7,6,"button",41),e.BQk()),2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.allLabels),e.xp6(1),e.Q6J("ngIf",!(null!=t.allLabels&&t.allLabels.length))}}const Ze=function(){return{"max-height.px":230}};function xe(i,d){if(1&i&&(e.TgZ(0,"clr-dropdown-menu",37),e.YNc(1,ve,1,1,"clr-spinner",38),e.YNc(2,Ee,3,2,"ng-container",13),e.qZA()),2&i){const t=e.oxw();e.Q6J("ngStyle",e.DdM(3,Ze)),e.xp6(1),e.Q6J("ngIf",t.loadingAllLabels),e.xp6(1),e.Q6J("ngIf",!t.loadingAllLabels)}}let Q=(()=>{class i{constructor(t,n,r,c){this.labelService=t,this.scanDataExportService=n,this.msgHandler=r,this.event=c,this.triggerExportSuccess=new e.vpe,this.selectedProjects=[],this.opened=!1,this.loading=!1,this.selectedLabels=[],this.loadingAllLabels=!1,this.allLabels=[],this.saveBtnState=h.xp5.DEFAULT}reset(){this.inlineAlertComponent?.close(),this.selectedProjects=[],this.repos=null,this.tags=null,this.selectedLabels=[],this.CVEIds=null,this.currentForm?.reset(),this.allLabels=[]}open(t){this.reset(),this.opened=!0,this.selectedProjects=t,this.getAllLabels()}close(){this.opened=!1}cancel(){this.close()}save(){this.loading=!0,this.saveBtnState=h.xp5.LOADING;const t={criteria:{projects:this.selectedProjects.map(n=>n.project_id),labels:this.selectedLabels.map(n=>n.id),repositories:this.handleBrace(this.repos),tags:this.handleBrace(this.tags),cveIds:this.handleBrace(this.CVEIds)},XScanDataType:"application/vnd.security.vulnerability.report; version=1.1"};this.scanDataExportService.exportScanData(t).pipe((0,U.x)(()=>{this.loading=!1,this.saveBtnState=h.xp5.DEFAULT})).subscribe(n=>{this.triggerExportSuccess.emit(),this.msgHandler.showSuccess("CVE_EXPORT.TRIGGER_EXPORT_SUCCESS"),this.event.publish(F.n.REFRESH_EXPORT_JOBS),this.close()},n=>{this.inlineAlertComponent.showInlineError(n)})}inputName(){}isSelected(t){let n=!1;return this.selectedLabels.forEach(r=>{r.id===t.id&&(n=!0)}),n}selectOrUnselect(t){this.isSelected(t)?this.selectedLabels=this.selectedLabels.filter(n=>n.id!==t.id):this.selectedLabels.push(t)}getProjectNames(){if(this.selectedProjects?.length){const t=[];return this.selectedProjects.forEach(n=>{t.push(n.name)}),t.join(", ")}return"CVE_EXPORT.ALL_PROJECTS"}isOverflow(){return!(this.namesSpan?.nativeElement?.clientWidth>=this.namesSpan?.nativeElement?.scrollWidth)}getAllLabels(){this.loadingAllLabels=!0,this.labelService.getAllGlobalAndSpecificProjectLabels(this.selectedProjects[0].project_id).pipe((0,U.x)(()=>this.loadingAllLabels=!1)).subscribe(t=>{this.allLabels=t})}handleBrace(t){return t?-1!==t.indexOf(",")&&-1===t.indexOf("{")&&-1===t.indexOf("}")?`{${t}}`:t:null}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(ge.Q),e.Y36(ue.f),e.Y36(S.d),e.Y36(F.P))},i.\u0275cmp=e.Xpm({type:i,selectors:[["export-cve"]],viewQuery:function(t,n){if(1&t&&(e.Gf(_e,7),e.Gf(me,7),e.Gf(f.l,5)),2&t){let r;e.iGM(r=e.CRH())&&(n.namesSpan=r.first),e.iGM(r=e.CRH())&&(n.currentForm=r.first),e.iGM(r=e.CRH())&&(n.inlineAlertComponent=r.first)}},outputs:{triggerExportSuccess:"triggerExportSuccess"},decls:82,vars:57,consts:[["clrModalSize","md",3,"clrModalOpen","clrModalStaticBackdrop","clrModalClosable","clrModalOpenChange"],[1,"modal-title"],[1,"modal-body"],[1,"mt-0"],[1,"clr-form","clr-form-horizontal"],["exportCVEForm","ngForm"],[1,"form-block"],[1,"clr-form-control"],[1,"clr-control-label","required"],[1,"clr-control-container"],[1,"clr-input-wrapper","flex"],[1,"names"],["names",""],[4,"ngIf"],["for","repo",1,"clr-control-label"],[1,"clr-input-wrapper"],[1,"sub-label"],["placeholder","**","autocomplete","off","type","text","id","repo","size","30","name","repo",1,"clr-input","width-220",3,"disabled","ngModel","ngModelChange"],["shape","exclamation-circle",1,"clr-validate-icon"],[1,"margin-left-90px","opacity-08"],[1,"clr-form-control","margin-top-06"],["placeholder","**","autocomplete","off","type","text","id","tag","size","30","name","tag",1,"clr-input","width-220",3,"disabled","ngModel","ngModelChange"],[1,"dropdown","clr-select-wrapper","absolute"],[1,"width-tag-label"],[1,"label-text"],["clrDropdownTrigger","",1,"dropdown-toggle","labels"],[4,"ngFor","ngForOf"],["class","ellipsis color-white-dark",4,"ngIf"],["class","right-align","clrPosition","bottom-left",3,"ngStyle",4,"clrIfOpen"],["for","ids",1,"clr-control-label"],["autocomplete","off","type","text","id","ids","size","30","name","tag",1,"clr-input","width-220",3,"disabled","ngModel","ngModelChange"],[1,"modal-footer"],["id","system-robot-cancel","type","button",1,"btn","btn-outline",3,"disabled","click"],["id","system-robot-save","type","button",1,"btn","btn-primary",3,"clrLoading","disabled","click"],[3,"hasIcon","label","labelWidth",4,"ngIf"],[3,"hasIcon","label","labelWidth"],[1,"ellipsis","color-white-dark"],["clrPosition","bottom-left",1,"right-align",3,"ngStyle"],["class","spinner",3,"clrMedium",4,"ngIf"],[1,"spinner",3,"clrMedium"],["type","button","class","dropdown-item flex",3,"click",4,"ngFor","ngForOf"],["type","button","class","dropdown-item space-between no-labels",4,"ngIf"],["type","button",1,"dropdown-item","flex",3,"click"],["shape","check"],[3,"label","labelWidth"],["type","button",1,"dropdown-item","space-between","no-labels"],[1,"alert-label"],["routerLink","/harbor/labels",1,"alert-label","go-link"]],template:function(t,n){1&t&&(e.TgZ(0,"clr-modal",0),e.NdJ("clrModalOpenChange",function(c){return n.opened=c}),e.TgZ(1,"h3",1),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",2),e._UZ(5,"inline-alert",1),e.TgZ(6,"p",3),e._uU(7),e.ALo(8,"translate"),e.qZA(),e.TgZ(9,"form",4,5)(11,"section",6)(12,"div",7)(13,"label",8),e._uU(14),e.ALo(15,"translate"),e.qZA(),e.TgZ(16,"div",9)(17,"div",10)(18,"span",11,12),e._uU(20),e.ALo(21,"translate"),e.qZA(),e.YNc(22,fe,2,1,"span",13),e.qZA()()(),e.TgZ(23,"div",7)(24,"label",14),e._uU(25),e.ALo(26,"translate"),e.qZA(),e.TgZ(27,"div",9)(28,"div",15)(29,"label",16),e._uU(30),e.ALo(31,"translate"),e.qZA(),e.TgZ(32,"input",17),e.NdJ("ngModelChange",function(c){return n.repos=c}),e.qZA(),e._UZ(33,"clr-icon",18),e.qZA(),e.TgZ(34,"clr-control-helper",19),e._uU(35),e.ALo(36,"translate"),e.qZA()()(),e.TgZ(37,"div",20),e._UZ(38,"label",14),e.TgZ(39,"div",9)(40,"div",15)(41,"label",16),e._uU(42),e.ALo(43,"translate"),e.qZA(),e.TgZ(44,"input",21),e.NdJ("ngModelChange",function(c){return n.tags=c}),e.qZA(),e._UZ(45,"clr-icon",18),e.qZA(),e.TgZ(46,"clr-control-helper",19),e._uU(47),e.ALo(48,"translate"),e.qZA()()(),e.TgZ(49,"div",20),e._UZ(50,"label",14),e.TgZ(51,"div",9)(52,"div",15)(53,"label",16),e._uU(54),e.ALo(55,"translate"),e.qZA(),e.TgZ(56,"div",22)(57,"clr-dropdown",23)(58,"div",24)(59,"div",25),e.YNc(60,Te,2,1,"ng-container",26),e.YNc(61,Pe,2,0,"span",27),e.qZA()(),e.YNc(62,xe,3,4,"clr-dropdown-menu",28),e.qZA()()()()(),e.TgZ(63,"div",20),e._UZ(64,"label",29),e.TgZ(65,"div",9)(66,"div",15)(67,"label",16),e._uU(68),e.ALo(69,"translate"),e.qZA(),e.TgZ(70,"input",30),e.NdJ("ngModelChange",function(c){return n.CVEIds=c}),e.qZA(),e._UZ(71,"clr-icon",18),e.qZA(),e.TgZ(72,"clr-control-helper",19),e._uU(73),e.ALo(74,"translate"),e.qZA()()()()()(),e.TgZ(75,"div",31)(76,"button",32),e.NdJ("click",function(){return n.cancel()}),e._uU(77),e.ALo(78,"translate"),e.qZA(),e.TgZ(79,"button",33),e.NdJ("click",function(){return n.save()}),e._uU(80),e.ALo(81,"translate"),e.qZA()()()),2&t&&(e.Q6J("clrModalOpen",n.opened)("clrModalStaticBackdrop",!0)("clrModalClosable",!0),e.xp6(2),e.Oqu(e.lcZ(3,29,"CVE_EXPORT.EXPORT_TITLE")),e.xp6(5),e.Oqu(e.lcZ(8,31,"CVE_EXPORT.EXPORT_SUBTITLE")),e.xp6(7),e.Oqu(e.lcZ(15,33,"SIDE_NAV.PROJECTS")),e.xp6(6),e.hij("",e.lcZ(21,35,n.getProjectNames())," "),e.xp6(2),e.Q6J("ngIf",n.isOverflow()&&!(null==n.selectedProjects||!n.selectedProjects.length)),e.xp6(3),e.Oqu(e.lcZ(26,37,"P2P_PROVIDER.FILTERS")),e.xp6(5),e.Oqu(e.lcZ(31,39,"P2P_PROVIDER.REPOS")),e.xp6(2),e.Q6J("disabled",n.loading)("ngModel",n.repos),e.xp6(3),e.Oqu(e.lcZ(36,41,"TAG_RETENTION.REP_SEPARATOR")),e.xp6(7),e.Oqu(e.lcZ(43,43,"P2P_PROVIDER.TAGS")),e.xp6(2),e.Q6J("disabled",n.loading)("ngModel",n.tags),e.xp6(3),e.Oqu(e.lcZ(48,45,"P2P_PROVIDER.TAG_SEPARATOR")),e.xp6(7),e.Oqu(e.lcZ(55,47,"P2P_PROVIDER.LABELS")),e.xp6(6),e.Q6J("ngForOf",n.selectedLabels),e.xp6(1),e.Q6J("ngIf",n.selectedLabels.length>1),e.xp6(7),e.Oqu(e.lcZ(69,49,"CVE_EXPORT.CVE_IDS")),e.xp6(2),e.Q6J("disabled",n.loading)("ngModel",n.CVEIds),e.xp6(3),e.Oqu(e.lcZ(74,51,"CVE_EXPORT.EXPORT_CVE_FILTER_HELP_TEXT")),e.xp6(3),e.Q6J("disabled",n.loading),e.xp6(1),e.hij(" ",e.lcZ(78,53,"BUTTON.CANCEL")," "),e.xp6(2),e.Q6J("clrLoading",n.saveBtnState)("disabled",n.loading||n.currentForm.invalid),e.xp6(1),e.hij(" ",e.lcZ(81,55,"CVE_EXPORT.EXPORT_BUTTON")," "))},dependencies:[u._Y,u.Fj,u.JJ,u.JL,u.On,u.F,h.qvL,h.qAN,h.VLi,h.cCV,h.nqY,h.MPb,h.MgK,h.CM6,h.f_W,h.zwp,h.ZUS,h.vNO,A.sg,A.O5,A.PC,f.l,he.q,R.rH,y.X$],styles:[".sub-label[_ngcontent-%COMP%]{display:inline-block;width:90px;font-size:.5417rem;font-weight:400}.width-220[_ngcontent-%COMP%]{width:220px}.label-text[_ngcontent-%COMP%]{text-transform:none;letter-spacing:normal;font-size:13px;font-weight:400;color:#000;height:1.2rem;margin:0!important;line-height:1rem;text-align:left;padding-left:6px;outline:none;border-bottom:1px solid rgb(154,154,154)}.dropdown-toggle[_ngcontent-%COMP%]{height:24px;width:212px}.right-align[_ngcontent-%COMP%]{min-width:220px;overflow-y:auto}.no-labels[_ngcontent-%COMP%]{cursor:default;padding:0 .5rem}.dropdown-item[_ngcontent-%COMP%]{min-height:26px}.spinner[_ngcontent-%COMP%]{margin:auto}.absolute[_ngcontent-%COMP%]{position:absolute}.flex[_ngcontent-%COMP%]{display:flex}.clr-control-label[_ngcontent-%COMP%]{width:8rem!important}.names[_ngcontent-%COMP%]{text-overflow:ellipsis;max-width:270px;display:inline-block;overflow:hidden}.space-between[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.input-width[_ngcontent-%COMP%]{width:310px}.labels[_ngcontent-%COMP%]{display:flex;justify-content:left}"]}),i})();var q=l(1992),Ae=l(8025),je=l(5412),Se=l(7579);let Y=(()=>{class i{constructor(){this.refreshSource=new Se.x,this.refreshChan$=this.refreshSource.asObservable()}refresh(){this.refreshSource.next(!0)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var Re=l(5681),Me=l(312),Le=l(3046);function Ie(i,d){if(1&i){const t=e.EpF();e.TgZ(0,"button",12),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.addNewProject())}),e._UZ(1,"clr-icon",13),e._uU(2),e.ALo(3,"translate"),e.qZA()}2&i&&(e.xp6(2),e.hij("\xa0",e.lcZ(3,1,"PROJECT.NEW_PROJECT")," "))}function Ue(i,d){if(1&i){const t=e.EpF();e.TgZ(0,"clr-dropdown-menu")(1,"button",14),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.exportCVE())}),e._UZ(2,"clr-icon",15),e._uU(3,"\xa0 "),e.TgZ(4,"span",16),e._uU(5),e.ALo(6,"translate"),e.qZA()(),e._UZ(7,"div",17),e.TgZ(8,"button",18),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.deleteProjects(r.selectedRow))}),e._UZ(9,"clr-icon",19),e._uU(10,"\xa0 "),e.TgZ(11,"span"),e._uU(12),e.ALo(13,"translate"),e.qZA()()()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("disabled",!t.hasPermission||!t.canClickExport),e.xp6(4),e.Oqu(e.lcZ(6,4,"CVE_EXPORT.EXPORT_SOME_PROJECTS")),e.xp6(3),e.Q6J("disabled",!t.canDelete),e.xp6(4),e.Oqu(e.lcZ(13,6,"PROJECT.DELETE"))}}function we(i,d){1&i&&(e.TgZ(0,"clr-dg-column"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"PROJECT.CHART_COUNT")))}function qe(i,d){if(1&i&&(e.TgZ(0,"clr-dg-cell"),e._uU(1),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.Oqu(t.chart_count)}}function Ne(i,d){if(1&i){const t=e.EpF();e.TgZ(0,"clr-dg-row",20)(1,"clr-dg-cell")(2,"a",21),e.NdJ("click",function(){const c=e.CHM(t).$implicit,v=e.oxw();return e.KtG(v.clickLink(c.project_id))}),e._uU(3),e.qZA()(),e.TgZ(4,"clr-dg-cell"),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"clr-dg-cell"),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"clr-dg-cell"),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.TgZ(13,"clr-dg-cell"),e._uU(14),e.qZA(),e.YNc(15,qe,2,1,"clr-dg-cell",6),e.TgZ(16,"clr-dg-cell"),e._uU(17),e.ALo(18,"harborDatetime"),e.qZA()()}if(2&i){const t=d.$implicit,n=e.oxw();e.Q6J("clrDgItem",t),e.xp6(2),e.Q6J("routerLink",n.getLink(t.project_id)),e.xp6(1),e.Oqu(t.name),e.xp6(2),e.Oqu(e.lcZ(6,9,"true"===t.metadata.public?"PROJECT.PUBLIC":"PROJECT.PRIVATE")),e.xp6(3),e.Oqu(n.roleInfo[t.current_user_role_id]?e.lcZ(9,11,n.roleInfo[t.current_user_role_id]):"-"),e.xp6(3),e.Oqu(e.lcZ(12,13,n.projectTypeMap[t.registry_id?1:0])),e.xp6(3),e.Oqu(t.repo_count),e.xp6(1),e.Q6J("ngIf",n.withChartMuseum),e.xp6(2),e.Oqu(e.xi3(18,15,t.creation_time,"short"))}}function Je(i,d){if(1&i&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i){e.oxw();const t=e.MAs(31);e.xp6(1),e.lnq("",t.firstItem+1," - ",t.lastItem+1," ",e.lcZ(2,3,"PROJECT.OF")," ")}}const De=function(){return[15,25,50]};let G=(()=>{class i{constructor(t,n,r,c,v,b,x,N,V,$e,et,tt){this.session=t,this.appConfigService=n,this.router=r,this.searchTrigger=c,this.proService=v,this.msgHandler=b,this.statisticHandler=x,this.translate=N,this.deletionDialogService=V,this.operationService=$e,this.translateService=et,this.permissionService=tt,this.loading=!0,this.projects=[],this.filteredType=0,this.searchKeyword="",this.selectedRow=[],this.addProject=new e.vpe,this.roleInfo=s.Hp,this.currentPage=1,this.totalCount=0,this.pageSize=(0,g.tb)(g.V2.LIST_PROJECT_COMPONENT),this.projectTypeMap={0:"PROJECT.PROJECT",1:"PROJECT.PROXY_CACHE"},this.hasPermission=!1,this.canClickExport=!0,this.subscription=V.confirmationConfirm$.subscribe(w=>{w&&1===w.state&&1===w.source&&this.delProjects(w.data)})}get projectCreationRestriction(){let t=this.session.getCurrentUser();if(t)switch(this.appConfigService.getConfig().project_creation_restriction){case"adminonly":return t.has_admin_role;case"everyone":return!0}return!1}get withChartMuseum(){return this.appConfigService.getConfig().with_chartmuseum}get isSystemAdmin(){let t=this.session.getCurrentUser();return null!=t&&t.has_admin_role}get canDelete(){return!!this.selectedRow.length&&(this.isSystemAdmin||this.selectedRow.every(t=>1===t.current_user_role_id))}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}addNewProject(){this.addProject.emit()}clickLink(t){this.searchTrigger.closeSearch(!0)}getLink(t){return`/harbor/projects/${t}/repositories`}clrLoad(t){if(!t||!t.page)return;this.state=t,this.pageSize=t.page.size,(0,g.Pe)(g.V2.LIST_PROJECT_COMPONENT,this.pageSize),this.selectedRow=[],this.currentState=t;let r,n=(0,g.wy)(t);n<=0&&(n=1),this.loading=!0,this.filteredType>0&&(r=this.filteredType-1),this.proService.listProjects(this.searchKeyword,r,n,this.pageSize,(0,g.td)(t)).pipe((0,U.x)(()=>{this.loading=!1})).subscribe(c=>{if(c.headers){let v=c.headers.get("X-Total-Count");v&&(this.totalCount=parseInt(v,0))}this.projects=c.body,this.projects?.forEach(v=>{if(this.selectedRow?.length)for(let b=this.selectedRow?.length-1;b>=0;b--)this.selectedRow[b].project_id===v.project_id&&(this.selectedRow.splice(b,1),this.selectedRow.push(v))})},c=>{this.msgHandler.handleError(c)})}newReplicationRule(t){t&&this.router.navigateByUrl(`/harbor/projects/${t.project_id}/replications?is_create=true`)}deleteProjects(t){let n=[];if(t&&t.length){t.forEach(c=>{n.push(c.name)});let r=new de.c("PROJECT.DELETION_TITLE","PROJECT.DELETION_SUMMARY",n.join(","),t,1,2);this.deletionDialogService.openComfirmDialog(r)}}delProjects(t){let n=[];t&&t.length&&(t.forEach(r=>{n.push(this.delOperate(r))}),(0,T.D)(...n).subscribe(r=>{let c;r&&r.length&&r.forEach(b=>{b instanceof pe.UA&&(c=(0,D.Po)(b))}),c?this.msgHandler.handleError(c):this.translate.get("BATCH.DELETED_SUCCESS").subscribe(b=>{this.msgHandler.showSuccess(b)});let v=this.getStateAfterDeletion();this.selectedRow=[],v?(this.clrLoad(v),this.statisticHandler.refresh()):this.refresh()}))}delOperate(t){let n=new j.gB;return n.name="OPERATION.DELETE_PROJECT",n.data.id=t.project_id,n.state=j.yb.progressing,n.data.name=t.name,this.operationService.publishInfo(n),this.proService.deleteProject(t.project_id).pipe((0,C.U)(()=>{(0,j.hm)(n,j.yb.success)}),(0,ce.K)(r=>{const c=(0,D.Po)(r);return this.translateService.get(c).subscribe(v=>{(0,j.hm)(n,j.yb.failure,v)}),(0,ae.of)(r)}))}refresh(){this.currentPage=1,this.filteredType=0,this.searchKeyword="",this.selectedRow=[],this.reload(),this.statisticHandler.refresh()}doFilterProject(t){this.currentPage=1,this.filteredType=t,this.reload()}doSearchProject(t){this.currentPage=1,this.searchKeyword=t,this.reload()}reload(){let t=this.currentState;t||(t={page:{}}),t.page.from=0,t.page.to=this.pageSize-1,t.page.size=this.pageSize,this.clrLoad(t)}getStateAfterDeletion(){let t=this.totalCount-this.selectedRow.length;if(t<=0)return null;let n=Math.ceil(t/this.pageSize),r=this.currentPage;this.currentPage>n&&(r=n);let c=this.currentState;return c||(c={page:{}}),c.page.size=this.pageSize,c.page.from=(r-1)*this.pageSize,c.page.to=r*this.pageSize-1,c}exportCVE(){this.exportCveComponent.open(this.selectedRow)}selectionChanged(){if(this.hasPermission=!1,this.selectedRow?.length&&this.selectedRow?.length<=1){const t=[];this.selectedRow.forEach(n=>{t.push(this.permissionService.getPermission(n.project_id,M._W.EXPORT_CVE.KEY,M._W.EXPORT_CVE.VALUE.CREATE))}),(0,T.D)(t).subscribe(n=>{n?.length&&(this.hasPermission=n.every(r=>r))})}}triggerExportSuccess(){this.canClickExport=!1,setTimeout(()=>{this.canClickExport=!0},3e4)}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(q.m),e.Y36(Ae._),e.Y36(R.F0),e.Y36(je.V),e.Y36(M.Y4),e.Y36(S.d),e.Y36(Y),e.Y36(y.sK),e.Y36(Re.O),e.Y36(Me.f9),e.Y36(y.sK),e.Y36(M.Hx))},i.\u0275cmp=e.Xpm({type:i,selectors:[["list-project"]],viewQuery:function(t,n){if(1&t&&e.Gf(Q,5),2&t){let r;e.iGM(r=e.CRH())&&(n.exportCveComponent=r.first)}},outputs:{addProject:"addProject"},decls:39,vars:42,consts:[[3,"clrDgLoading","clrDgSelected","clrDgRefresh","clrDgSelectedChange"],["type","button","class","btn btn-secondary",3,"click",4,"ngIf"],["clrDropdownTrigger","",1,"btn","btn-link",3,"clrCloseMenuOnItemClick"],["shape","caret\n            down"],[4,"clrIfOpen"],[3,"clrDgSortBy"],[4,"ngIf"],[3,"clrDgItem",4,"ngFor","ngForOf"],[3,"clrDgPageSize","clrDgPage","clrDgTotalItems","clrDgPageChange"],["pagination",""],[3,"clrPageSizeOptions"],[3,"triggerExportSuccess"],["type","button",1,"btn","btn-secondary",3,"click"],["shape","plus","size","16"],["clrDropdownItem","",3,"disabled","click"],["shape","export","size","16"],["id","export-cve"],[1,"dropdown-divider"],["id","delete-project","type","button",1,"btn","btn-secondary",3,"disabled","click"],["shape","times","size","16"],[3,"clrDgItem"],["href","javascript:void(0)",3,"routerLink","click"]],template:function(t,n){1&t&&(e.TgZ(0,"clr-datagrid",0),e.NdJ("clrDgRefresh",function(c){return n.clrLoad(c)})("clrDgSelectedChange",function(c){return n.selectedRow=c})("clrDgSelectedChange",function(){return n.selectionChanged()}),e.TgZ(1,"clr-dg-action-bar"),e.YNc(2,Ie,4,3,"button",1),e.TgZ(3,"clr-dropdown",2)(4,"span"),e._uU(5),e.ALo(6,"translate"),e._UZ(7,"clr-icon",3),e.qZA(),e.YNc(8,Ue,14,8,"clr-dropdown-menu",4),e.qZA()(),e.TgZ(9,"clr-dg-column",5),e._uU(10),e.ALo(11,"translate"),e.qZA(),e.TgZ(12,"clr-dg-column"),e._uU(13),e.ALo(14,"translate"),e.qZA(),e.TgZ(15,"clr-dg-column"),e._uU(16),e.ALo(17,"translate"),e.qZA(),e.TgZ(18,"clr-dg-column"),e._uU(19),e.ALo(20,"translate"),e.qZA(),e.TgZ(21,"clr-dg-column"),e._uU(22),e.ALo(23,"translate"),e.qZA(),e.YNc(24,we,3,3,"clr-dg-column",6),e.TgZ(25,"clr-dg-column",5),e._uU(26),e.ALo(27,"translate"),e.qZA(),e.YNc(28,Ne,19,18,"clr-dg-row",7),e.TgZ(29,"clr-dg-footer")(30,"clr-dg-pagination",8,9),e.NdJ("clrDgPageChange",function(c){return n.currentPage=c}),e.TgZ(32,"clr-dg-page-size",10),e._uU(33),e.ALo(34,"translate"),e.qZA(),e.YNc(35,Je,3,5,"span",6),e._uU(36),e.ALo(37,"translate"),e.qZA()()(),e.TgZ(38,"export-cve",11),e.NdJ("triggerExportSuccess",function(){return n.triggerExportSuccess()}),e.qZA()),2&t&&(e.Q6J("clrDgLoading",n.loading)("clrDgSelected",n.selectedRow),e.xp6(2),e.Q6J("ngIf",n.projectCreationRestriction),e.xp6(1),e.Q6J("clrCloseMenuOnItemClick",!1),e.xp6(2),e.Oqu(e.lcZ(6,23,"MEMBER.ACTION")),e.xp6(4),e.Q6J("clrDgSortBy","name"),e.xp6(1),e.Oqu(e.lcZ(11,25,"PROJECT.NAME")),e.xp6(3),e.Oqu(e.lcZ(14,27,"PROJECT.ACCESS_LEVEL")),e.xp6(3),e.Oqu(e.lcZ(17,29,"PROJECT.ROLE")),e.xp6(3),e.Oqu(e.lcZ(20,31,"PROJECT.TYPE")),e.xp6(3),e.Oqu(e.lcZ(23,33,"PROJECT.REPO_COUNT")),e.xp6(2),e.Q6J("ngIf",n.withChartMuseum),e.xp6(1),e.Q6J("clrDgSortBy","creation_time"),e.xp6(1),e.Oqu(e.lcZ(27,35,"PROJECT.CREATION_TIME")),e.xp6(2),e.Q6J("ngForOf",n.projects),e.xp6(2),e.Q6J("clrDgPageSize",n.pageSize)("clrDgPage",n.currentPage)("clrDgTotalItems",n.totalCount),e.xp6(2),e.Q6J("clrPageSizeOptions",e.DdM(41,De)),e.xp6(1),e.Oqu(e.lcZ(34,37,"PAGINATION.PAGE_SIZE")),e.xp6(2),e.Q6J("ngIf",n.totalCount),e.xp6(1),e.AsE(" ",n.totalCount," ",e.lcZ(37,39,"PROJECT.ITEMS")," "))},dependencies:[h.C9t,h.Gwl,h.m4W,h.Z4N,h.fv_,h.dRQ,h.Ltv,h.YYR,h.PDs,h.KHL,h.Gcc,h.jND,h.Nh1,h.dml,h.K8c,h.qvL,h.nqY,h.f_W,h.zwp,h.ZUS,h.lU3,A.sg,A.O5,R.yS,Q,y.X$,Le.Z],encapsulation:2}),i})();var B=l(8348),Ye=l(946),Ge=l(98);function Be(i,d){if(1&i&&(e.TgZ(0,"div",5)(1,"div",6),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",7),e._uU(5),e.qZA()()),2&i){const t=e.oxw();e.xp6(2),e.hij(" ",e.lcZ(3,2,"STATISTICS.INDEX_PRIVATE")," "),e.xp6(3),e.hij(" ",null==t.originalCopy?null:t.originalCopy.private_project_count," ")}}function Ve(i,d){if(1&i&&(e.TgZ(0,"div",5)(1,"div",6),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",7),e._uU(5),e.qZA()()),2&i){const t=e.oxw();e.xp6(2),e.hij(" ",e.lcZ(3,2,"STATISTICS.INDEX_TOTAL")," "),e.xp6(3),e.hij(" ",null==t.originalCopy?null:t.originalCopy.total_project_count," ")}}function Xe(i,d){if(1&i&&(e.TgZ(0,"div",5)(1,"div",6),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",7),e._uU(5),e.qZA()()),2&i){const t=e.oxw();e.xp6(2),e.hij(" ",e.lcZ(3,2,"STATISTICS.INDEX_PRIVATE")," "),e.xp6(3),e.hij(" ",null==t.originalCopy?null:t.originalCopy.private_repo_count," ")}}function ze(i,d){if(1&i&&(e.TgZ(0,"div",5)(1,"div",6),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",7),e._uU(5),e.qZA()()),2&i){const t=e.oxw();e.xp6(2),e.hij(" ",e.lcZ(3,2,"STATISTICS.INDEX_TOTAL")," "),e.xp6(3),e.hij(" ",null==t.originalCopy?null:t.originalCopy.total_repo_count," ")}}function He(i,d){if(1&i&&(e.TgZ(0,"div",1)(1,"div",9)(2,"h4",3),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"div",10)(6,"div")(7,"span",11),e._uU(8),e.qZA(),e.TgZ(9,"span"),e._uU(10),e.qZA()()()()()),2&i){const t=e.oxw();e.xp6(3),e.Oqu(e.lcZ(4,3,"STATISTICS.STORAGE_USED")),e.xp6(5),e.Oqu(t.getSizeNumber()),e.xp6(2),e.Oqu(t.getSizeUnit())}}let We=(()=>{class i{constructor(t,n,r,c){this.statistics=t,this.msgHandler=n,this.session=r,this.statisticHandler=c}ngOnInit(){this.refreshSub=this.statisticHandler.refreshChan$.subscribe(t=>{this.getStatistics()}),this.session.getCurrentUser()&&this.getStatistics()}ngOnDestroy(){this.refreshSub&&this.refreshSub.unsubscribe()}getStatistics(){this.statistics.getStatistic().subscribe(t=>this.originalCopy=t,t=>{this.msgHandler.handleError(t)})}get isValidSession(){let t=this.session.getCurrentUser();return t&&t.has_admin_role}getSizeNumber(){return this.originalCopy?(0,g.Zj)(this.originalCopy.total_storage_consumption):0}getSizeUnit(){return this.originalCopy?(0,g.T2)(this.originalCopy.total_storage_consumption):null}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(Ge.B),e.Y36(S.d),e.Y36(q.m),e.Y36(Y))},i.\u0275cmp=e.Xpm({type:i,selectors:[["statistics-panel"]],decls:28,vars:19,consts:[[1,"clr-row","flex-end"],[1,"card"],[1,"card-block"],[1,"head"],["class","clr-row",4,"ngIf"],[1,"clr-row"],[1,"clr-col"],[1,"clr-col","font-weight-700"],["class","card",4,"ngIf"],[1,"card-block","container"],[1,"storage-used","font-weight-700"],[1,"size-number","margin-right-5px"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h4",3),e._uU(4),e.ALo(5,"translate"),e.qZA(),e.YNc(6,Be,6,4,"div",4),e.TgZ(7,"div",5)(8,"div",6),e._uU(9),e.ALo(10,"translate"),e.qZA(),e.TgZ(11,"div",7),e._uU(12),e.qZA()(),e.YNc(13,Ve,6,4,"div",4),e.qZA()(),e.TgZ(14,"div",1)(15,"div",2)(16,"h4",3),e._uU(17),e.ALo(18,"translate"),e.qZA(),e.YNc(19,Xe,6,4,"div",4),e.TgZ(20,"div",5)(21,"div",6),e._uU(22),e.ALo(23,"translate"),e.qZA(),e.TgZ(24,"div",7),e._uU(25),e.qZA()(),e.YNc(26,ze,6,4,"div",4),e.qZA()(),e.YNc(27,He,11,5,"div",8),e.qZA()),2&t&&(e.xp6(4),e.Oqu(e.lcZ(5,11,"STATISTICS.PRO_ITEM")),e.xp6(2),e.Q6J("ngIf",n.isValidSession),e.xp6(3),e.hij(" ",e.lcZ(10,13,"STATISTICS.INDEX_PUB")," "),e.xp6(3),e.hij(" ",null==n.originalCopy?null:n.originalCopy.public_project_count," "),e.xp6(1),e.Q6J("ngIf",n.isValidSession),e.xp6(4),e.Oqu(e.lcZ(18,15,"STATISTICS.REPO_ITEM")),e.xp6(2),e.Q6J("ngIf",n.isValidSession),e.xp6(3),e.hij(" ",e.lcZ(23,17,"STATISTICS.INDEX_PUB")," "),e.xp6(3),e.hij(" ",null==n.originalCopy?null:n.originalCopy.public_repo_count," "),e.xp6(1),e.Q6J("ngIf",n.isValidSession),e.xp6(1),e.Q6J("ngIf",n.isValidSession))},dependencies:[A.O5,y.X$],styles:[".head[_ngcontent-%COMP%]{margin-top:0;margin-bottom:.25rem}.card[_ngcontent-%COMP%]{width:10rem;margin-right:.5rem;margin-top:0}.flex-end[_ngcontent-%COMP%]{justify-content:flex-end}.font-weight-700[_ngcontent-%COMP%]{font-weight:700}.storage-used[_ngcontent-%COMP%]{flex:1;display:flex;align-items:center;justify-content:center}.size-number[_ngcontent-%COMP%]{font-size:1.5rem}.container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}.margin-right-5px[_ngcontent-%COMP%]{margin-right:5px}"]}),i})();const ke=[{path:"",component:(()=>{class i{constructor(t,n,r,c){this.configService=t,this.session=n,this.proService=r,this.msgHandler=c,this.projectTypes=s.sX,this.currentFilteredType=0,this.projectName=""}get selecteType(){return this.currentFilteredType+""}set selecteType(t){this.currentFilteredType=+t,window.sessionStorage&&(window.sessionStorage.projectTypeValue=+t)}ngOnInit(){window.sessionStorage&&window.sessionStorage.projectTypeValue&&window.sessionStorage.fromDetails&&(this.currentFilteredType=+window.sessionStorage.projectTypeValue,window.sessionStorage.removeItem("fromDetails")),this.isSystemAdmin&&this.getConfigration(),this.searchSub||(this.searchSub=this.filterComponent.filterTerms.pipe((0,P.b)(500),(0,m.x)(),(0,Z.w)(t=>{let n;return this.listProject.currentPage=1,this.listProject.searchKeyword=t,this.listProject.selectedRow=[],this.listProject.loading=!0,this.listProject.filteredType>0&&(n=this.listProject.filteredType-1),this.proService.listProjects(this.listProject.searchKeyword,n,this.listProject.currentPage,this.listProject.pageSize,(0,g.td)(this.listProject.state)).pipe((0,U.x)(()=>{this.listProject.loading=!1}))})).subscribe(t=>{if(t.headers){let n=t.headers.get("X-Total-Count");n&&(this.listProject.totalCount=parseInt(n,0))}this.listProject.projects=t.body},t=>{this.msgHandler.handleError(t)}))}ngOnDestroy(){this.searchSub&&(this.searchSub.unsubscribe(),this.searchSub=null)}getConfigration(){this.configService.getConfiguration().subscribe(t=>{this.quotaObj={storage_per_project:t.storage_per_project?t.storage_per_project.value:-1}})}get isSystemAdmin(){let t=this.session.getCurrentUser();return null!=t&&t.has_admin_role}openModal(){this.creationProject.newProject()}createProject(t){t&&this.refresh()}doFilterProjects(){this.listProject.doFilterProject(+this.selecteType)}refresh(){this.currentFilteredType=0,this.projectName="",this.listProject.refresh()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(Ye.e),e.Y36(q.m),e.Y36(M.Y4),e.Y36(S.d))},i.\u0275cmp=e.Xpm({type:i,selectors:[["projects"]],viewQuery:function(t,n){if(1&t&&(e.Gf(J,5),e.Gf(G,5),e.Gf(B.z,7)),2&t){let r;e.iGM(r=e.CRH())&&(n.creationProject=r.first),e.iGM(r=e.CRH())&&(n.listProject=r.first),e.iGM(r=e.CRH())&&(n.filterComponent=r.first)}},decls:27,vars:21,consts:[[1,"row"],[1,"col-lg-12","col-md-12","col-sm-12","col-xs-12","position-r"],[1,"row","flex-items-xs-between","flex-items-xs-top","projectPos"],[1,"header-title"],[1,"row","flex-items-xs-between","rightPos"],[1,"display-flex"],[1,"clr-select-wrapper"],[3,"ngModel","change","ngModelChange"],["value","0",3,"selected"],["value","1"],["value","2"],[3,"withDivider","filterPlaceholder","currentValue"],[1,"refresh-btn",3,"click"],["shape","refresh"],[3,"quotaObj","isSystemAdmin","create"],[3,"addProject"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),e._uU(4),e.ALo(5,"translate"),e.qZA(),e.TgZ(6,"div"),e._UZ(7,"statistics-panel"),e.qZA()(),e.TgZ(8,"div",4)(9,"div",5)(10,"div",6)(11,"select",7),e.NdJ("change",function(){return n.doFilterProjects()})("ngModelChange",function(c){return n.selecteType=c}),e.TgZ(12,"option",8),e._uU(13),e.ALo(14,"translate"),e.qZA(),e.TgZ(15,"option",9),e._uU(16),e.ALo(17,"translate"),e.qZA(),e.TgZ(18,"option",10),e._uU(19),e.ALo(20,"translate"),e.qZA()()(),e._UZ(21,"hbr-filter",11),e.ALo(22,"translate"),e.TgZ(23,"span",12),e.NdJ("click",function(){return n.refresh()}),e._UZ(24,"clr-icon",13),e.qZA()()(),e.TgZ(25,"create-project",14),e.NdJ("create",function(c){return n.createProject(c)}),e.qZA(),e.TgZ(26,"list-project",15),e.NdJ("addProject",function(){return n.openModal()}),e.qZA()()()),2&t&&(e.xp6(4),e.Oqu(e.lcZ(5,11,"PROJECT.PROJECTS")),e.xp6(7),e.Q6J("ngModel",n.selecteType),e.xp6(1),e.Q6J("selected",0===n.currentFilteredType),e.xp6(1),e.hij(" ",e.lcZ(14,13,n.projectTypes[0])," "),e.xp6(3),e.hij(" ",e.lcZ(17,15,n.projectTypes[1])," "),e.xp6(3),e.hij(" ",e.lcZ(20,17,n.projectTypes[2])," "),e.xp6(2),e.s9C("filterPlaceholder",e.lcZ(22,19,"PROJECT.FILTER_PLACEHOLDER")),e.Q6J("withDivider",!0)("currentValue",n.projectName),e.xp6(4),e.Q6J("quotaObj",n.quotaObj)("isSystemAdmin",n.isSystemAdmin))},dependencies:[u.YN,u.Kr,u.EJ,u.JJ,u.On,h.qvL,B.z,G,J,We,y.X$],styles:[".header-title[_ngcontent-%COMP%]{margin-bottom:-34px}.option-left[_ngcontent-%COMP%]{padding-left:16px}.display-flex[_ngcontent-%COMP%]{display:flex;align-items:baseline}.refresh-btn[_ngcontent-%COMP%]{cursor:pointer}.refresh-btn[_ngcontent-%COMP%]:hover{color:#007cbb}.rightPos[_ngcontent-%COMP%]{position:absolute;z-index:100;right:35px;margin-top:28px}.projectPos[_ngcontent-%COMP%]{padding-left:15px;padding-right:15px}.position-r[_ngcontent-%COMP%]{position:relative}"]}),i})()}];let Ke=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[p.m,R.Bz.forChild(ke)]}),i})()},8348:(L,E,l)=>{l.d(E,{z:()=>T});var p=l(4650),C=l(7579),P=l(8372),m=l(4006),O=l(6895),Z=l(9375);const e=["inputElement"];function u(o,a){1&o&&p._UZ(0,"span",4)}let T=(()=>{class o{constructor(s){this.cd=s,this.placeHolder="",this.filterTerms=new C.x,this.isExpanded=!1,this.filterEvt=new p.vpe,this.openFlag=new p.vpe,this.readonly=null,this.expandMode=!1,this.withDivider=!1}set filterPlaceholder(s){this.placeHolder=s}ngOnInit(){this.filterTerms.pipe((0,P.b)(500)).subscribe(s=>{this.filterEvt.emit(s)})}valueChange(){this.filterTerms.next(this.currentValue&&this.currentValue.trim())}inputFocus(){this.openFlag.emit(this.isExpanded)}onClick(){this.expandMode||(this.isExpanded=!this.isExpanded,this.isExpanded&&(this.cd.detectChanges(),this.inputElement.nativeElement.focus()),this.openFlag.emit(this.isExpanded))}get isShowSearchBox(){return this.expandMode||!this.expandMode&&this.isExpanded}}return o.\u0275fac=function(s){return new(s||o)(p.Y36(p.sBO))},o.\u0275cmp=p.Xpm({type:o,selectors:[["hbr-filter"]],viewQuery:function(s,g){if(1&s&&p.Gf(e,5),2&s){let f;p.iGM(f=p.CRH())&&(g.inputElement=f.first)}},inputs:{readonly:"readonly",currentValue:"currentValue",filterPlaceholder:"filterPlaceholder",expandMode:"expandMode",withDivider:"withDivider",width:"width"},outputs:{filterEvt:"filterEvt",openFlag:"openFlag"},decls:5,vars:9,consts:[["shape","search","size","20",1,"search-btn",3,"click"],["type","text","autofocus","",1,"filter-input","clr-input",3,"hidden","placeholder","ngModel","keyup","focus","ngModelChange"],["inputElement",""],["class","filter-divider",4,"ngIf"],[1,"filter-divider"]],template:function(s,g){1&s&&(p.TgZ(0,"span")(1,"clr-icon",0),p.NdJ("click",function(){return g.onClick()}),p.qZA(),p.TgZ(2,"input",1,2),p.NdJ("keyup",function(){return g.valueChange()})("focus",function(){return g.inputFocus()})("ngModelChange",function(_){return g.currentValue=_}),p.qZA(),p.YNc(4,u,1,0,"span",3),p.qZA()),2&s&&(p.xp6(1),p.ekj("filter-icon",g.isShowSearchBox),p.xp6(1),p.Udp("width",g.width,"px"),p.s9C("placeholder",g.placeHolder),p.Q6J("hidden",!g.isShowSearchBox)("ngModel",g.currentValue),p.uIk("readOnly",g.readonly),p.xp6(2),p.Q6J("ngIf",g.withDivider))},dependencies:[m.Fj,m.JJ,m.On,O.O5,Z.qvL],styles:[".filter-icon[_ngcontent-%COMP%]{position:relative;right:-20px}.filter-divider[_ngcontent-%COMP%]{display:inline-block;height:16px;width:1px;padding-top:12px;padding-bottom:12px;position:relative;top:9px;margin-right:6px;margin-left:6px}.search-btn[_ngcontent-%COMP%]{cursor:pointer}.search-btn[_ngcontent-%COMP%]:hover{color:#007cbb}.filter-input[_ngcontent-%COMP%]{padding-left:24px}"]}),o})()},6082:(L,E,l)=>{l.d(E,{q:()=>u});var p=l(6742),C=l(4650),P=l(6895),m=l(9375);function O(T,o){1&T&&C._UZ(0,"clr-icon",4)}function Z(T,o){1&T&&C._UZ(0,"clr-icon",5)}const e=function(T,o,a){return{"background-color":T,color:o,border:a}};let u=(()=>{class T{constructor(){this.hasIcon=!0}ngOnChanges(){if(this.label){let a=this.label.color;a||(a="#FFFFFF"),this.labelColor=p.oW.find(s=>s.color===a)}}}return T.\u0275fac=function(a){return new(a||T)},T.\u0275cmp=C.Xpm({type:T,selectors:[["hbr-label-piece"]],inputs:{label:"label",labelWidth:"labelWidth",hasIcon:"hasIcon"},features:[C.TTD],decls:6,vars:10,consts:[[1,"label",3,"ngStyle"],["shape","organization",4,"ngIf"],["shape","administrator",4,"ngIf"],[1,"label-name"],["shape","organization"],["shape","administrator"]],template:function(a,s){1&a&&(C.TgZ(0,"label",0)(1,"span"),C.YNc(2,O,1,0,"clr-icon",1),C.YNc(3,Z,1,0,"clr-icon",2),C.qZA(),C.TgZ(4,"span",3),C._uU(5),C.qZA()()),2&a&&(C.Udp("max-width",s.labelWidth,"px"),C.Q6J("ngStyle",C.kEZ(6,e,null==s.labelColor?null:s.labelColor.color,null==s.labelColor?null:s.labelColor.textColor,"#FFFFFF"===(null==s.labelColor?null:s.labelColor.color)?"1px solid #A1A1A1":"none")),C.xp6(2),C.Q6J("ngIf",s.hasIcon&&"p"===s.label.scope),C.xp6(1),C.Q6J("ngIf",s.hasIcon&&"g"===s.label.scope),C.xp6(2),C.Oqu(s.label.name))},dependencies:[P.O5,P.PC,m.qvL,m.MgK],styles:[".label[_ngcontent-%COMP%]{display:flex;align-items:center;cursor:inherit}.label[_ngcontent-%COMP%]   clr-icon[_ngcontent-%COMP%]{margin-right:3px;margin-top:3px}.label-name[_ngcontent-%COMP%]{min-width:0;overflow:hidden;text-overflow:ellipsis}"]}),T})()}}]);