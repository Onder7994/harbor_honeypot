"use strict";(self.webpackChunkharbor_portal=self.webpackChunkharbor_portal||[]).push([[8324],{622:(P,T,s)=>{s.d(T,{M:()=>w});var m=s(529),A=s(2529),_=s(9300),e=s(4004),h=s(4650),Z=s(5060);let w=(()=>{class f extends A.b{constructor(c,d){super(c,d)}getLatestScanAllMetricsResponse(c){let d=this.newParams(),l=new m.WM;null!=c&&(l=l.set("X-Request-Id",c.toString()));let o=new m.aW("GET",this.rootUrl+"/scans/all/metrics",null,{headers:l,params:d,responseType:"json"});return this.http.request(o).pipe((0,_.h)(p=>p instanceof m.Zn),(0,e.U)(p=>p))}getLatestScanAllMetrics(c){return this.getLatestScanAllMetricsResponse(c).pipe((0,e.U)(d=>d.body))}getLatestScheduledScanAllMetricsResponse(c){let d=this.newParams(),l=new m.WM;null!=c&&(l=l.set("X-Request-Id",c.toString()));let o=new m.aW("GET",this.rootUrl+"/scans/schedule/metrics",null,{headers:l,params:d,responseType:"json"});return this.http.request(o).pipe((0,_.h)(p=>p instanceof m.Zn),(0,e.U)(p=>p))}getLatestScheduledScanAllMetrics(c){return this.getLatestScheduledScanAllMetricsResponse(c).pipe((0,e.U)(d=>d.body))}getScanAllScheduleResponse(c){let d=this.newParams(),l=new m.WM;null!=c&&(l=l.set("X-Request-Id",c.toString()));let o=new m.aW("GET",this.rootUrl+"/system/scanAll/schedule",null,{headers:l,params:d,responseType:"json"});return this.http.request(o).pipe((0,_.h)(p=>p instanceof m.Zn),(0,e.U)(p=>p))}getScanAllSchedule(c){return this.getScanAllScheduleResponse(c).pipe((0,e.U)(d=>d.body))}updateScanAllScheduleResponse(c){let d=this.newParams(),l=new m.WM,S=null;S=c.schedule,null!=c.XRequestId&&(l=l.set("X-Request-Id",c.XRequestId.toString()));let o=new m.aW("PUT",this.rootUrl+"/system/scanAll/schedule",S,{headers:l,params:d,responseType:"json"});return this.http.request(o).pipe((0,_.h)(p=>p instanceof m.Zn),(0,e.U)(p=>p))}updateScanAllSchedule(c){return this.updateScanAllScheduleResponse(c).pipe((0,e.U)(d=>d.body))}createScanAllScheduleResponse(c){let d=this.newParams(),l=new m.WM,S=null;S=c.schedule,null!=c.XRequestId&&(l=l.set("X-Request-Id",c.XRequestId.toString()));let o=new m.aW("POST",this.rootUrl+"/system/scanAll/schedule",S,{headers:l,params:d,responseType:"json"});return this.http.request(o).pipe((0,_.h)(p=>p instanceof m.Zn),(0,e.U)(p=>p))}createScanAllSchedule(c){return this.createScanAllScheduleResponse(c).pipe((0,e.U)(d=>d.body))}stopScanAllResponse(c){let d=this.newParams(),l=new m.WM;null!=c&&(l=l.set("X-Request-Id",c.toString()));let o=new m.aW("POST",this.rootUrl+"/system/scanAll/stop",null,{headers:l,params:d,responseType:"json"});return this.http.request(o).pipe((0,_.h)(p=>p instanceof m.Zn),(0,e.U)(p=>p))}stopScanAll(c){return this.stopScanAllResponse(c).pipe((0,e.U)(d=>d.body))}}return f.getLatestScanAllMetricsPath="/scans/all/metrics",f.getLatestScheduledScanAllMetricsPath="/scans/schedule/metrics",f.getScanAllSchedulePath="/system/scanAll/schedule",f.updateScanAllSchedulePath="/system/scanAll/schedule",f.createScanAllSchedulePath="/system/scanAll/schedule",f.stopScanAllPath="/system/scanAll/stop",f.\u0275fac=function(c){return new(c||f)(h.LFG(Z.p),h.LFG(m.eN))},f.\u0275prov=h.Yz7({token:f,factory:f.\u0275fac,providedIn:"root"}),f})()},8324:(P,T,s)=>{s.r(T),s.d(T,{InterrogationServicesModule:()=>ke});var m=s(6296),A=s(858),_=s(7121),e=s(4650),h=s(4006),Z=s(4968),w=s(4004),f=s(8372),v=s(1884),c=s(9300),d=s(3900),l=s(8746),S=s(7894),o=s(9375),p=s(6895),C=s(2466);const D=["name"],k=["endpointUrl"];function G(i,a){if(1&i&&(e.TgZ(0,"clr-control-error")(1,"span",29),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&i){const n=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,1,n.nameTooltip))}}function V(i,a){if(1&i&&(e.TgZ(0,"clr-control-error")(1,"span",30),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&i){const n=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,1,n.endpointTooltip))}}function J(i,a){1&i&&(e.TgZ(0,"clr-control-error"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"SCANNER.USERNAME_REQUIRED")," "))}function Q(i,a){if(1&i&&(e.TgZ(0,"div",1)(1,"label",2),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",3)(5,"div",4),e._UZ(6,"input",31)(7,"clr-icon",7),e.qZA(),e.YNc(8,J,3,3,"clr-control-error",9),e.qZA()()),2&i){const n=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,4,"SCANNER.USERNAME")),e.xp6(2),e.ekj("clr-error",!n.isUserNameValid),e.xp6(4),e.Q6J("ngIf",!n.isUserNameValid)}}function Y(i,a){1&i&&(e.TgZ(0,"clr-control-error")(1,"span",33),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&i&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"SCANNER.PASSWORD_REQUIRED")))}function K(i,a){if(1&i&&(e.TgZ(0,"div",1)(1,"label",2),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",3)(5,"div",4),e._UZ(6,"input",32)(7,"clr-icon",7),e.qZA(),e.YNc(8,Y,4,3,"clr-control-error",9),e.qZA()()),2&i){const n=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,4,"SCANNER.PASSWORD")),e.xp6(2),e.ekj("clr-error",!n.isPasswordValid),e.xp6(4),e.Q6J("ngIf",!n.isPasswordValid)}}function B(i,a){1&i&&(e.TgZ(0,"clr-control-error"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"SCANNER.TOKEN_REQUIRED")," "))}function H(i,a){if(1&i&&(e.TgZ(0,"div",1)(1,"label",2),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",3)(5,"div",4),e._UZ(6,"input",34)(7,"clr-icon",7),e.qZA(),e.YNc(8,B,3,3,"clr-control-error",9),e.qZA()()),2&i){const n=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,4,"SCANNER.TOKEN")),e.xp6(2),e.ekj("clr-error",!n.isTokenValid),e.xp6(4),e.Q6J("ngIf",!n.isTokenValid)}}function j(i,a){1&i&&(e.TgZ(0,"clr-control-error"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"SCANNER.API_KEY_REQUIRED")," "))}function W(i,a){if(1&i&&(e.TgZ(0,"div",1)(1,"label",2),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",3)(5,"div",4),e._UZ(6,"input",35)(7,"clr-icon",7),e.qZA(),e.YNc(8,j,3,3,"clr-control-error",9),e.qZA()()),2&i){const n=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,4,"SCANNER.API_KEY")),e.xp6(2),e.ekj("clr-error",!n.isApiKeyValid),e.xp6(4),e.Q6J("ngIf",!n.isApiKeyValid)}}function z(i,a){1&i&&(e.TgZ(0,"clr-tooltip-content",36),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"SCANNER.SKIP_CERT_VERIFY")," "))}function $(i,a){1&i&&(e.TgZ(0,"clr-tooltip-content",36),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"SCANNER.USE_INNER_TIP")," "))}let O=(()=>{class i{constructor(n,t){this.fb=n,this.scannerService=t,this.checkOnGoing=!1,this.newScannerForm=this.fb.group({name:this.fb.control("",[h.kI.required]),description:this.fb.control(""),url:this.fb.control("",[h.kI.required,h.kI.pattern(/^http[s]?:\/\//)]),auth:this.fb.control(""),accessCredential:this.fb.group({username:this.fb.control("",h.kI.required),password:this.fb.control("",h.kI.required),token:this.fb.control("",h.kI.required),apiKey:this.fb.control("",h.kI.required)}),skipCertVerify:this.fb.control(!1),useInner:this.fb.control(!1)}),this.isNameExisting=!1,this.checkEndpointOnGoing=!1,this.isEndpointUrlExisting=!1,this.showEndpointError=!1}ngAfterViewInit(){this.checkNameSubscribe||(this.checkNameSubscribe=(0,Z.R)(this.scannerName.nativeElement,"input").pipe((0,w.U)(n=>n.target.value),(0,f.b)(500),(0,v.x)(),(0,c.h)(n=>(!this.isEdit||!this.originValue||this.originValue.name!==n)&&this.newScannerForm.get("name").valid&&n.length>0),(0,d.w)(n=>(this.isNameExisting=!1,this.checkOnGoing=!0,this.scannerService.listScanners({q:encodeURIComponent(`name=${n}`)}).pipe((0,l.x)(()=>this.checkOnGoing=!1))))).subscribe(n=>{n&&n.length>0&&n.forEach(t=>{t.name!==this.newScannerForm.get("name").value||(this.isNameExisting=!0)})},n=>{this.isNameExisting=!1})),this.checkEndpointUrlSubscribe||(this.checkEndpointUrlSubscribe=(0,Z.R)(this.scannerEndpointUrl.nativeElement,"input").pipe((0,w.U)(n=>n.target.value),(0,f.b)(800),(0,v.x)(),(0,c.h)(n=>(!this.isEdit||!this.originValue||this.originValue.url!==n)&&this.newScannerForm.get("url").valid&&n.length>6),(0,d.w)(n=>(this.isEndpointUrlExisting=!1,this.checkEndpointOnGoing=!0,this.scannerService.listScanners({q:encodeURIComponent(`url=${n}`)}).pipe((0,l.x)(()=>this.checkEndpointOnGoing=!1))))).subscribe(n=>{n&&n.length>0&&n.forEach(t=>{t.url!==this.newScannerForm.get("url").value||(this.isEndpointUrlExisting=!0)})},n=>{this.isEndpointUrlExisting=!1}))}ngOnDestroy(){this.checkNameSubscribe&&(this.checkNameSubscribe.unsubscribe(),this.checkNameSubscribe=null),this.checkEndpointUrlSubscribe&&(this.checkEndpointUrlSubscribe.unsubscribe(),this.checkEndpointUrlSubscribe=null)}get isNameValid(){return!((this.newScannerForm.get("name").dirty||this.newScannerForm.get("name").touched)&&!this.checkOnGoing&&(this.isNameExisting?(this.nameTooltip="SCANNER.NAME_EXISTS",1):this.newScannerForm.get("name").errors&&this.newScannerForm.get("name").errors.required?(this.nameTooltip="SCANNER.NAME_REQUIRED",1):this.newScannerForm.get("name").errors&&this.newScannerForm.get("name").errors.pattern&&(this.nameTooltip="SCANNER.NAME_REX",1)))}get isEndpointValid(){return!((this.newScannerForm.get("url").dirty||this.newScannerForm.get("url").touched)&&!this.checkEndpointOnGoing&&(this.isEndpointUrlExisting?(this.endpointTooltip="SCANNER.ENDPOINT_EXISTS",1):this.newScannerForm.get("url").errors&&this.newScannerForm.get("url").errors.required?(this.endpointTooltip="SCANNER.ENDPOINT_REQUIRED",1):(this.newScannerForm.get("url").errors&&this.newScannerForm.get("url"),0)))}checkEndpointUrl(){this.newScannerForm.get("url").errors&&this.newScannerForm.get("url").errors.pattern&&(this.endpointTooltip="SCANNER.ILLEGAL_ENDPOINT",this.showEndpointError=!0)}get auth(){return this.newScannerForm.get("auth").value}get isUserNameValid(){return!(this.newScannerForm.get("accessCredential").get("username").invalid&&(this.newScannerForm.get("accessCredential").get("username").dirty||this.newScannerForm.get("accessCredential").get("username").touched))}get isPasswordValid(){return!(this.newScannerForm.get("accessCredential").get("password").invalid&&(this.newScannerForm.get("accessCredential").get("password").dirty||this.newScannerForm.get("accessCredential").get("password").touched))}get isTokenValid(){return!(this.newScannerForm.get("accessCredential").get("token").invalid&&(this.newScannerForm.get("accessCredential").get("token").dirty||this.newScannerForm.get("accessCredential").get("token").touched))}get isApiKeyValid(){return!(this.newScannerForm.get("accessCredential").get("apiKey").invalid&&(this.newScannerForm.get("accessCredential").get("apiKey").dirty||this.newScannerForm.get("accessCredential").get("apiKey").touched))}}return i.\u0275fac=function(n){return new(n||i)(e.Y36(h.QS),e.Y36(S.L))},i.\u0275cmp=e.Xpm({type:i,selectors:[["new-scanner-form"]],viewQuery:function(n,t){if(1&n&&(e.Gf(D,5),e.Gf(k,5)),2&n){let r;e.iGM(r=e.CRH())&&(t.scannerName=r.first),e.iGM(r=e.CRH())&&(t.scannerEndpointUrl=r.first)}},decls:76,vars:46,consts:[[1,"clr-form","clr-form-horizontal",3,"formGroup"],[1,"clr-form-control"],[1,"required","clr-control-label"],[1,"clr-control-container"],[1,"clr-input-wrapper"],["autocomplete","off","formControlName","name","type","text","id","scanner-name",1,"clr-input","width-280"],["name",""],["shape","exclamation-circle",1,"clr-validate-icon"],[1,"spinner","spinner-inline",3,"hidden"],[4,"ngIf"],[1,"clr-control-label"],["autocomplete","off","formControlName","description","type","text","id","description",1,"clr-textarea","width-280"],["placeholder","http(s)://192.168.1.1","autocomplete","off","formControlName","url","type","text","id","scanner-endpoint",1,"clr-input","width-280",3,"focus","blur"],["endpointUrl",""],[1,"clr-select-wrapper"],["formControlName","auth","id","scanner-authorization",1,"clr-select","width-280"],["value","None"],["value","Basic"],["value","Bearer"],["value","APIKey"],["formGroupName","accessCredential"],["class","clr-form-control",4,"ngIf"],[1,"clr-control-container","padding-top-3"],["name","scanner-skipCertVerify","clrCheckbox","","formControlName","skipCertVerify","type","checkbox","id","scanner-skipCertVerify"],["for","scanner-skipCertVerify"],["clrTooltipTrigger","","shape","info-circle","size","24",1,"color-57"],["clrPosition","top-left","clrSize","md",4,"clrIfOpen"],["name","scanner-use-inner","clrCheckbox","","formControlName","useInner","type","checkbox","id","scanner-use-inner"],["for","scanner-use-inner"],["id","name-error"],["id","endpoint-error"],["formControlName","username","autocomplete","off","type","text","id","scanner-username",1,"clr-input","width-280"],["formControlName","password","autocomplete","off","type","password","id","scanner-password",1,"clr-input","width-280"],["id","pwd-error"],["formControlName","token","autocomplete","off","type","text","id","scanner-token",1,"clr-input","width-280"],["formControlName","apiKey","autocomplete","off","type","text","id","scanner-apiKey",1,"clr-input","width-280"],["clrPosition","top-left","clrSize","md"]],template:function(n,t){1&n&&(e.TgZ(0,"div")(1,"form",0)(2,"div",1)(3,"label",2),e._uU(4),e.ALo(5,"translate"),e.qZA(),e.TgZ(6,"div",3)(7,"div",4),e._UZ(8,"input",5,6)(10,"clr-icon",7)(11,"span",8),e.qZA(),e.YNc(12,G,4,3,"clr-control-error",9),e.qZA()(),e.TgZ(13,"div",1)(14,"label",10),e._uU(15),e.ALo(16,"translate"),e.qZA(),e.TgZ(17,"div",3)(18,"textarea",11),e._uU(19,"                "),e.qZA()()(),e.TgZ(20,"div",1)(21,"label",2),e._uU(22),e.ALo(23,"translate"),e.qZA(),e.TgZ(24,"div",3)(25,"div",4)(26,"input",12,13),e.NdJ("focus",function(){return t.showEndpointError=!1})("blur",function(){return t.checkEndpointUrl()}),e.qZA(),e._UZ(28,"clr-icon",7)(29,"span",8),e.qZA(),e.YNc(30,V,4,3,"clr-control-error",9),e.qZA()(),e.TgZ(31,"div",1)(32,"label",10),e._uU(33),e.ALo(34,"translate"),e.qZA(),e.TgZ(35,"div",3)(36,"div",14)(37,"select",15)(38,"option",16),e._uU(39),e.ALo(40,"translate"),e.qZA(),e.TgZ(41,"option",17),e._uU(42),e.ALo(43,"translate"),e.qZA(),e.TgZ(44,"option",18),e._uU(45),e.ALo(46,"translate"),e.qZA(),e.TgZ(47,"option",19),e._uU(48),e.ALo(49,"translate"),e.qZA()()()()(),e.ynx(50,20),e.YNc(51,Q,9,6,"div",21),e.YNc(52,K,9,6,"div",21),e.YNc(53,H,9,6,"div",21),e.YNc(54,W,9,6,"div",21),e.BQk(),e.TgZ(55,"div",1)(56,"label",10),e._uU(57),e.ALo(58,"translate"),e.qZA(),e.TgZ(59,"div",22)(60,"clr-checkbox-wrapper"),e._UZ(61,"input",23),e.TgZ(62,"label",24),e._uU(63),e.ALo(64,"translate"),e.TgZ(65,"clr-tooltip"),e._UZ(66,"clr-icon",25),e.YNc(67,z,3,3,"clr-tooltip-content",26),e.qZA()()(),e.TgZ(68,"clr-checkbox-wrapper"),e._UZ(69,"input",27),e.TgZ(70,"label",28),e._uU(71),e.ALo(72,"translate"),e.TgZ(73,"clr-tooltip"),e._UZ(74,"clr-icon",25),e.YNc(75,$,3,3,"clr-tooltip-content",26),e.qZA()()()()()()()),2&n&&(e.xp6(1),e.Q6J("formGroup",t.newScannerForm),e.xp6(3),e.Oqu(e.lcZ(5,24,"SCANNER.NAME")),e.xp6(2),e.ekj("clr-error",!t.isNameValid),e.xp6(5),e.Q6J("hidden",!t.checkOnGoing),e.xp6(1),e.Q6J("ngIf",!t.isNameValid),e.xp6(3),e.Oqu(e.lcZ(16,26,"SCANNER.DESCRIPTION")),e.xp6(7),e.Oqu(e.lcZ(23,28,"SCANNER.ENDPOINT")),e.xp6(2),e.ekj("clr-error",!t.isEndpointValid||t.showEndpointError),e.xp6(5),e.Q6J("hidden",!t.checkEndpointOnGoing),e.xp6(1),e.Q6J("ngIf",!t.isEndpointValid||t.showEndpointError),e.xp6(3),e.Oqu(e.lcZ(34,30,"SCANNER.AUTH")),e.xp6(6),e.hij(" ",e.lcZ(40,32,"SCANNER.NONE")," "),e.xp6(3),e.hij(" ",e.lcZ(43,34,"SCANNER.BASIC")," "),e.xp6(3),e.hij(" ",e.lcZ(46,36,"SCANNER.BEARER")," "),e.xp6(3),e.hij(" ",e.lcZ(49,38,"SCANNER.API_KEY")," "),e.xp6(3),e.Q6J("ngIf","Basic"===t.auth),e.xp6(1),e.Q6J("ngIf","Basic"===t.auth),e.xp6(1),e.Q6J("ngIf","Bearer"===t.auth),e.xp6(1),e.Q6J("ngIf","APIKey"===t.auth),e.xp6(3),e.Oqu(e.lcZ(58,40,"SCANNER.OPTIONS")),e.xp6(6),e.hij("",e.lcZ(64,42,"SCANNER.SKIP")," "),e.xp6(8),e.hij("",e.lcZ(72,44,"SCANNER.USE_INNER")," "))},dependencies:[h._Y,h.YN,h.Kr,h.Fj,h.Wl,h.EJ,h.JJ,h.JL,h.sg,h.u,h.x0,o.qvL,o.nqY,o.MgK,o.VqA,o.KKC,o.PEh,o.Jmj,o.bMv,o.zDF,p.O5,C.X$],styles:[".width-280[_ngcontent-%COMP%]{width:280px}.color-57[_ngcontent-%COMP%]{color:#575757}.padding-top-3[_ngcontent-%COMP%]{padding-top:3px}"]}),i})();var M=s(2421),u=s(3526),y=s(9151);function X(i,a){1&i&&(e.TgZ(0,"h3",3),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"SCANNER.ADD_SCANNER")," "))}function ee(i,a){1&i&&(e.TgZ(0,"h3",3),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"SCANNER.EDIT_SCANNER")," "))}function ne(i,a){if(1&i){const n=e.EpF();e.TgZ(0,"button",9),e.NdJ("click",function(){e.CHM(n);const r=e.oxw();return e.KtG(r.create())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&i){const n=e.oxw();e.Q6J("clrLoading",n.saveBtnState)("disabled",!n.valid),e.xp6(1),e.hij(" ",e.lcZ(2,3,"BUTTON.ADD")," ")}}function te(i,a){if(1&i){const n=e.EpF();e.TgZ(0,"button",10),e.NdJ("click",function(){e.CHM(n);const r=e.oxw();return e.KtG(r.save())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&i){const n=e.oxw();e.Q6J("clrLoading",n.saveBtnState)("disabled",!n.validForSaving),e.xp6(1),e.hij(" ",e.lcZ(2,3,"BUTTON.SAVE")," ")}}let I=(()=>{class i{constructor(n,t,r){this.configScannerService=n,this.msgHandler=t,this.translate=r,this.testMap={},this.opened=!1,this.notify=new e.vpe,this.checkBtnState=o.xp5.DEFAULT,this.saveBtnState=o.xp5.DEFAULT,this.onTesting=!1,this.onSaving=!1,this.isEdit=!1}open(){this.opened=!0,this.inlineAlert.close(),this.testMap={},this.newScannerFormComponent.showEndpointError=!1,this.newScannerFormComponent.newScannerForm.reset({auth:"None"})}close(){this.opened=!1}create(){this.onSaving=!0,this.saveBtnState=o.xp5.LOADING;const n={name:"",url:""},t=this.newScannerFormComponent.newScannerForm.value;n.name=t.name,n.description=t.description,n.url=t.url,"None"===t.auth?n.auth="":"Basic"===t.auth?(n.auth=t.auth,n.access_credential=t.accessCredential.username+":"+t.accessCredential.password):"APIKey"===t.auth?(n.auth=t.auth,n.access_credential=t.accessCredential.apiKey):(n.auth=t.auth,n.access_credential=t.accessCredential.token),n.skip_certVerify=!!t.skipCertVerify,n.use_internal_addr=!!t.useInner,this.configScannerService.createScanner({registration:n}).pipe((0,l.x)(()=>this.onSaving=!1)).subscribe(r=>{this.close(),this.msgHandler.showSuccess("SCANNER.ADD_SUCCESS"),this.notify.emit(),this.saveBtnState=o.xp5.SUCCESS},r=>{this.inlineAlert.showInlineError(r),this.saveBtnState=o.xp5.ERROR})}get hasPassedTest(){return this.testMap[this.newScannerFormComponent.newScannerForm.get("url").value]}get canTestEndpoint(){return"Basic"===this.newScannerFormComponent.newScannerForm.get("auth").value?this.newScannerFormComponent.newScannerForm.get("accessCredential").get("username").valid&&this.newScannerFormComponent.newScannerForm.get("accessCredential").get("password").valid:"Bearer"===this.newScannerFormComponent.newScannerForm.get("auth").value?this.newScannerFormComponent.newScannerForm.get("accessCredential").get("token").valid:"APIKey"===this.newScannerFormComponent.newScannerForm.get("auth").value?this.newScannerFormComponent.newScannerForm.get("accessCredential").get("apiKey").valid:!this.onTesting&&this.newScannerFormComponent&&!this.newScannerFormComponent.checkOnGoing&&this.newScannerFormComponent.newScannerForm.get("name").valid&&!this.newScannerFormComponent.checkEndpointOnGoing&&this.newScannerFormComponent.newScannerForm.get("url").valid}get valid(){return!(this.onSaving||this.newScannerFormComponent.isNameExisting||this.newScannerFormComponent.isEndpointUrlExisting||this.onTesting||!this.newScannerFormComponent||this.newScannerFormComponent.checkOnGoing||this.newScannerFormComponent.checkEndpointOnGoing||this.newScannerFormComponent.newScannerForm.get("name").invalid||this.newScannerFormComponent.newScannerForm.get("url").invalid)&&("Basic"===this.newScannerFormComponent.newScannerForm.get("auth").value?this.newScannerFormComponent.newScannerForm.get("accessCredential").get("username").valid&&this.newScannerFormComponent.newScannerForm.get("accessCredential").get("password").valid:"Bearer"===this.newScannerFormComponent.newScannerForm.get("auth").value?this.newScannerFormComponent.newScannerForm.get("accessCredential").get("token").valid:"APIKey"!==this.newScannerFormComponent.newScannerForm.get("auth").value||this.newScannerFormComponent.newScannerForm.get("accessCredential").get("apiKey").valid)}get validForSaving(){return this.valid&&this.hasChange()}hasChange(){return this.originValue.name!==this.newScannerFormComponent.newScannerForm.get("name").value||this.originValue.description!==this.newScannerFormComponent.newScannerForm.get("description").value||this.originValue.url!==this.newScannerFormComponent.newScannerForm.get("url").value||this.originValue.auth!==this.newScannerFormComponent.newScannerForm.get("auth").value||this.originValue.skipCertVerify!==this.newScannerFormComponent.newScannerForm.get("skipCertVerify").value||this.originValue.useInner!==this.newScannerFormComponent.newScannerForm.get("useInner").value||"Basic"===this.originValue.auth&&(this.originValue.accessCredential.username!==this.newScannerFormComponent.newScannerForm.get("accessCredential").get("username").value||this.originValue.accessCredential.password!==this.newScannerFormComponent.newScannerForm.get("accessCredential").get("password").value)||"Bearer"===this.originValue.auth&&this.originValue.accessCredential.token!==this.newScannerFormComponent.newScannerForm.get("accessCredential").get("token").value||"APIKey"===this.originValue.auth&&this.originValue.accessCredential.apiKey!==this.newScannerFormComponent.newScannerForm.get("accessCredential").get("apiKey").value}onTestEndpoint(){this.onTesting=!0,this.checkBtnState=o.xp5.LOADING;const n={name:"",url:""},t=this.newScannerFormComponent.newScannerForm.value;n.name=t.name,n.description=t.description,n.url=t.url,"None"===t.auth?n.auth="":"Basic"===t.auth?(n.auth=t.auth,n.access_credential=t.accessCredential.username+":"+t.accessCredential.password):"APIKey"===t.auth?(n.auth=t.auth,n.access_credential=t.accessCredential.apiKey):(n.auth=t.auth,n.access_credential=t.accessCredential.token),n.skip_certVerify=!!t.skipCertVerify,n.use_internal_addr=!!t.useInner,this.configScannerService.pingScanner({settings:n}).pipe((0,l.x)(()=>this.onTesting=!1)).subscribe(r=>{this.inlineAlert.showInlineSuccess({message:"SCANNER.TEST_PASS"}),this.checkBtnState=o.xp5.SUCCESS,this.testMap[this.newScannerFormComponent.newScannerForm.get("url").value]=!0},r=>{this.translate.get("SCANNER.TEST_FAILED",{name:this.newScannerFormComponent.newScannerForm.get("name").value,url:this.newScannerFormComponent.newScannerForm.get("url").value}).subscribe(g=>{this.inlineAlert.showInlineError(g)}),this.checkBtnState=o.xp5.ERROR})}save(){this.onSaving=!0,this.saveBtnState=o.xp5.LOADING;let n=this.newScannerFormComponent.newScannerForm.value;this.editScanner.name=n.name,this.editScanner.description=n.description,this.editScanner.url=n.url,"None"===n.auth?this.editScanner.auth="":"Basic"===n.auth?(this.editScanner.auth=n.auth,this.editScanner.access_credential=n.accessCredential.username+":"+n.accessCredential.password):"APIKey"===n.auth?(this.editScanner.auth=n.auth,this.editScanner.access_credential=n.accessCredential.apiKey):(this.editScanner.auth=n.auth,this.editScanner.access_credential=n.accessCredential.token),this.editScanner.skip_certVerify=!!n.skipCertVerify,this.editScanner.use_internal_addr=!!n.useInner,this.editScanner.uuid=this.uid;const t=(0,u.d9)(this.editScanner);this.configScannerService.updateScanner({registrationId:this.editScanner.uuid,registration:t}).pipe((0,l.x)(()=>this.onSaving=!1)).subscribe(r=>{this.close(),this.msgHandler.showSuccess("SCANNER.UPDATE_SUCCESS"),this.notify.emit(),this.saveBtnState=o.xp5.SUCCESS},r=>{this.inlineAlert.showInlineError(r),this.saveBtnState=o.xp5.ERROR})}}return i.\u0275fac=function(n){return new(n||i)(e.Y36(S.L),e.Y36(y.d),e.Y36(C.sK))},i.\u0275cmp=e.Xpm({type:i,selectors:[["new-scanner-modal"]],viewQuery:function(n,t){if(1&n&&(e.Gf(O,7),e.Gf(M.l,5)),2&n){let r;e.iGM(r=e.CRH())&&(t.newScannerFormComponent=r.first),e.iGM(r=e.CRH())&&(t.inlineAlert=r.first)}},outputs:{notify:"notify"},decls:15,vars:15,consts:[[3,"clrModalOpen","clrModalStaticBackdrop","clrModalClosable","clrModalOpenChange"],["class","modal-title",4,"ngIf"],[1,"modal-body","body-format"],[1,"modal-title"],[1,"modal-footer"],["id","button-test","type","button",1,"btn","btn-outline",3,"clrLoading","disabled","click"],["id","button-cancel","type","button",1,"btn","btn-outline",3,"click"],["id","button-add","type","button","class","btn btn-primary",3,"clrLoading","disabled","click",4,"ngIf"],["id","button-save","type","button","class","btn btn-primary",3,"clrLoading","disabled","click",4,"ngIf"],["id","button-add","type","button",1,"btn","btn-primary",3,"clrLoading","disabled","click"],["id","button-save","type","button",1,"btn","btn-primary",3,"clrLoading","disabled","click"]],template:function(n,t){1&n&&(e.TgZ(0,"clr-modal",0),e.NdJ("clrModalOpenChange",function(g){return t.opened=g}),e.YNc(1,X,3,3,"h3",1),e.YNc(2,ee,3,3,"h3",1),e.TgZ(3,"div",2),e._UZ(4,"inline-alert",3)(5,"new-scanner-form"),e.qZA(),e.TgZ(6,"div",4)(7,"button",5),e.NdJ("click",function(){return t.onTestEndpoint()}),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"button",6),e.NdJ("click",function(){return t.close()}),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.YNc(13,ne,3,5,"button",7),e.YNc(14,te,3,5,"button",8),e.qZA()()),2&n&&(e.Q6J("clrModalOpen",t.opened)("clrModalStaticBackdrop",!0)("clrModalClosable",!1),e.xp6(1),e.Q6J("ngIf",!t.isEdit),e.xp6(1),e.Q6J("ngIf",t.isEdit),e.xp6(5),e.Q6J("clrLoading",t.checkBtnState)("disabled",!t.canTestEndpoint),e.xp6(1),e.hij(" ",e.lcZ(9,11,"SCANNER.TEST_CONNECTION")," "),e.xp6(3),e.hij(" ",e.lcZ(12,13,"BUTTON.CANCEL")," "),e.xp6(2),e.Q6J("ngIf",!t.isEdit),e.xp6(1),e.Q6J("ngIf",t.isEdit))},dependencies:[o.qAN,o.VLi,o.cCV,o.MPb,p.O5,M.l,O,C.X$],styles:[".form-group-override[_ngcontent-%COMP%]{padding-left:170px!important}.form-group-label-override[_ngcontent-%COMP%]{font-size:14px;font-weight:400}.sub-label-for-input[_ngcontent-%COMP%]{position:absolute;top:26px;font-size:10px;font-weight:400;line-height:12px;left:170px}.body-format[_ngcontent-%COMP%]{overflow-y:hidden}.loading-top[_ngcontent-%COMP%]{top:8px}"]}),i})();var ie=s(8726),b=s(2443),re=s(5681);function ae(i,a){if(1&i&&(e.TgZ(0,"div",2)(1,"span"),e._uU(2),e.qZA(),e.TgZ(3,"span",2),e._uU(4),e.qZA()()),2&i){const n=a.$implicit,t=e.oxw();e.xp6(2),e.hij("",null==n?null:n.key,":"),e.xp6(2),e.Oqu(t.parseDate(n))}}let oe=(()=>{class i{constructor(n,t){this.configScannerService=n,this.errorHandler=t,this.loading=!1}ngOnInit(){this.loading=!0,this.configScannerService.getScannerMetadata({registrationId:this.uid}).pipe((0,l.x)(()=>this.loading=!1)).subscribe(n=>{this.scannerMetadata=n},n=>{this.errorHandler.error(n)})}parseDate(n){return this.hasValue(n)&&this.hasDateValue(n)?new p.uU("en-us").transform(n.value,"short"):this.hasValue(n)?n.value:""}hasValue(n){return n&&n.value}hasDateValue(n){switch(n.key){case u.XZ:case u.vP:return!0;default:return!1}}toString(n){return n&&n.length>0?"["+n.join(" , ")+"]":n}}return i.\u0275fac=function(n){return new(n||i)(e.Y36(S.L),e.Y36(b.q))},i.\u0275cmp=e.Xpm({type:i,selectors:[["scanner-metadata"]],inputs:{uid:"uid"},decls:40,vars:33,consts:[[1,"ml-2",3,"clrLoading"],[1,"clr-control-label"],[1,"ml-1"],["id","scannerMetadata-name",1,"ml-1"],[1,"ml-1",3,"innerHTML"],["class","ml-1",4,"ngFor","ngForOf"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0)(1,"div",1),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",2)(5,"span"),e._uU(6),e.ALo(7,"translate"),e.qZA(),e.TgZ(8,"span",3),e._uU(9),e.qZA()(),e.TgZ(10,"div",2)(11,"span"),e._uU(12),e.ALo(13,"translate"),e.qZA(),e.TgZ(14,"span",2),e._uU(15),e.qZA()(),e.TgZ(16,"div",2)(17,"span"),e._uU(18),e.ALo(19,"translate"),e.qZA(),e.TgZ(20,"span",2),e._uU(21),e.qZA()(),e.TgZ(22,"div",1),e._uU(23),e.ALo(24,"translate"),e.qZA(),e.TgZ(25,"div",2)(26,"span"),e._uU(27),e.ALo(28,"translate"),e.qZA(),e._UZ(29,"span",4),e.qZA(),e.TgZ(30,"div",2)(31,"span"),e._uU(32),e.ALo(33,"translate"),e.qZA(),e._UZ(34,"span",4),e.qZA(),e.TgZ(35,"div",1),e._uU(36),e.ALo(37,"translate"),e.qZA(),e.YNc(38,ae,5,2,"div",5),e.ALo(39,"keyvalue"),e.qZA()),2&n&&(e.Q6J("clrLoading",t.loading),e.xp6(2),e.hij(" ",e.lcZ(3,15,"SCANNER.SCANNER_COLON")," "),e.xp6(4),e.Oqu(e.lcZ(7,17,"SCANNER.NAME_COLON")),e.xp6(3),e.Oqu(null==t.scannerMetadata||null==t.scannerMetadata.scanner?null:t.scannerMetadata.scanner.name),e.xp6(3),e.Oqu(e.lcZ(13,19,"SCANNER.VENDOR_COLON")),e.xp6(3),e.Oqu(null==t.scannerMetadata||null==t.scannerMetadata.scanner?null:t.scannerMetadata.scanner.vendor),e.xp6(3),e.Oqu(e.lcZ(19,21,"SCANNER.VERSION_COLON")),e.xp6(3),e.Oqu(null==t.scannerMetadata||null==t.scannerMetadata.scanner?null:t.scannerMetadata.scanner.version),e.xp6(2),e.hij(" ",e.lcZ(24,23,"SCANNER.CAPABILITIES")," "),e.xp6(4),e.Oqu(e.lcZ(28,25,"SCANNER.CONSUMES_MIME_TYPES_COLON")),e.xp6(2),e.Q6J("innerHTML",t.toString(null==t.scannerMetadata||null==t.scannerMetadata.capabilities[0]?null:t.scannerMetadata.capabilities[0].consumes_mime_types),e.oJD),e.xp6(3),e.Oqu(e.lcZ(33,27,"SCANNER.PRODUCTS_MIME_TYPES_COLON")),e.xp6(2),e.Q6J("innerHTML",t.toString(null==t.scannerMetadata||null==t.scannerMetadata.capabilities[0]?null:t.scannerMetadata.capabilities[0].produces_mime_types),e.oJD),e.xp6(2),e.Oqu(e.lcZ(37,29,"SCANNER.PROPERTIES")),e.xp6(2),e.Q6J("ngForOf",e.lcZ(39,31,null==t.scannerMetadata?null:t.scannerMetadata.properties)))},dependencies:[o.cCV,p.sg,C.X$,p.Nd]}),i})();function se(i,a){if(1&i&&(e.TgZ(0,"clr-signpost-content")(1,"a",23),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&i){const n=e.oxw();e.xp6(1),e.s9C("href",n.scannerDocUrl,e.LSH),e.xp6(1),e.Oqu(e.lcZ(3,2,"SCANNER.VIEW_DOC"))}}function ce(i,a){1&i&&(e.TgZ(0,"span"),e._UZ(1,"clr-icon",31),e.TgZ(2,"span",26),e._uU(3),e.ALo(4,"translate"),e.qZA()()),2&i&&(e.xp6(3),e.Oqu(e.lcZ(4,1,"WEBHOOK.ENABLED_BUTTON")))}function le(i,a){1&i&&(e.TgZ(0,"span"),e._UZ(1,"clr-icon",32),e.TgZ(2,"span",26),e._uU(3),e.ALo(4,"translate"),e.qZA()()),2&i&&(e.xp6(3),e.Oqu(e.lcZ(4,1,"WEBHOOK.DISABLED_BUTTON")))}function pe(i,a){if(1&i){const n=e.EpF();e.TgZ(0,"clr-dropdown-menu")(1,"button",24),e.NdJ("click",function(){e.CHM(n);const r=e.oxw();return e.KtG(r.editScanner())}),e._UZ(2,"clr-icon",25),e.TgZ(3,"span",26),e._uU(4),e.ALo(5,"translate"),e.qZA()(),e.TgZ(6,"button",27),e.NdJ("click",function(){e.CHM(n);const r=e.oxw();return e.KtG(r.changeStat())}),e.YNc(7,ce,5,3,"span",21),e.YNc(8,le,5,3,"span",21),e.qZA(),e._UZ(9,"div",28),e.TgZ(10,"button",24),e.NdJ("click",function(){e.CHM(n);const r=e.oxw();return e.KtG(r.deleteScanners())}),e._UZ(11,"clr-icon",29),e.TgZ(12,"span",30),e._uU(13),e.ALo(14,"translate"),e.qZA()()()}if(2&i){const n=e.oxw();e.xp6(1),e.Q6J("disabled",!n.selectedRow),e.xp6(3),e.Oqu(e.lcZ(5,7,"BUTTON.EDIT")),e.xp6(2),e.Q6J("disabled",!(n.selectedRow&&!n.selectedRow.is_default)),e.xp6(1),e.Q6J("ngIf",n.selectedRow&&n.selectedRow.disabled),e.xp6(1),e.Q6J("ngIf",!(n.selectedRow&&n.selectedRow.disabled)),e.xp6(2),e.Q6J("disabled",!n.selectedRow),e.xp6(3),e.Oqu(e.lcZ(14,9,"BUTTON.DELETE"))}}function ue(i,a){1&i&&(e.TgZ(0,"span",40),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"SCANNER.DEFAULT")))}function de(i,a){1&i&&e._UZ(0,"span",41)}function ge(i,a){1&i&&(e.TgZ(0,"span",44),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"SCANNER.HEALTHY")))}function he(i,a){1&i&&(e.TgZ(0,"span",45),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"SCANNER.UNHEALTHY")))}function me(i,a){if(1&i&&(e.YNc(0,ge,3,3,"span",42),e.YNc(1,he,3,3,"ng-template",null,43,e.W1O)),2&i){const n=e.MAs(2),t=e.oxw().$implicit;e.Q6J("ngIf",t.metadata)("ngIfElse",n)}}function Se(i,a){1&i&&(e.TgZ(0,"div",46),e._UZ(1,"clr-icon",47),e.TgZ(2,"span",48),e._uU(3),e.ALo(4,"translate"),e.qZA()()),2&i&&(e.xp6(3),e.Oqu(e.lcZ(4,1,"WEBHOOK.ENABLED")))}function fe(i,a){1&i&&(e.TgZ(0,"div",46),e._UZ(1,"clr-icon",49),e.TgZ(2,"span",48),e._uU(3),e.ALo(4,"translate"),e.qZA()()),2&i&&(e.xp6(3),e.Oqu(e.lcZ(4,1,"WEBHOOK.DISABLED")))}function _e(i,a){if(1&i&&e._UZ(0,"scanner-metadata",50),2&i){const n=e.oxw().$implicit;e.Q6J("uid",n.uuid)}}function Ce(i,a){if(1&i&&(e.TgZ(0,"clr-dg-row",33)(1,"clr-dg-cell",34)(2,"span"),e._uU(3),e.qZA(),e.YNc(4,ue,3,3,"span",35),e.qZA(),e.TgZ(5,"clr-dg-cell"),e._uU(6),e.qZA(),e.TgZ(7,"clr-dg-cell",34),e.YNc(8,de,1,0,"span",36),e.YNc(9,me,3,2,"ng-template",null,37,e.W1O),e.qZA(),e.TgZ(11,"clr-dg-cell"),e.YNc(12,Se,5,3,"div",38),e.YNc(13,fe,5,3,"div",38),e.qZA(),e.TgZ(14,"clr-dg-cell"),e._uU(15),e.qZA(),e.YNc(16,_e,1,1,"scanner-metadata",39),e.qZA()),2&i){const n=a.$implicit,t=e.MAs(10);e.Q6J("clrDgItem",n),e.xp6(3),e.Oqu(n.name),e.xp6(1),e.Q6J("ngIf",n.is_default),e.xp6(2),e.Oqu(n.url),e.xp6(2),e.Q6J("ngIf",n.loadingMetadata)("ngIfElse",t),e.xp6(4),e.Q6J("ngIf",!n.disabled),e.xp6(1),e.Q6J("ngIf",n.disabled),e.xp6(2),e.Oqu(n.auth?n.auth:"None")}}function Ae(i,a){if(1&i&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i){e.oxw();const n=e.MAs(49);e.xp6(1),e.lnq("",n.firstItem+1," - ",n.lastItem+1," ",e.lcZ(2,3,"DESTINATION.OF"),"")}}const Ne=function(){return[15,25,50]};let Ee=(()=>{class i{constructor(n,t,r,g){this.configScannerService=n,this.errorHandler=t,this.msgHandler=r,this.deletionDialogService=g,this.scanners=[],this.onGoing=!0,this.scannerDocUrl=_.f,this.page=1,this.pageSize=(0,u.tb)(u.V2.SYSTEM_SCANNER_COMPONENT),this.total=0}ngOnInit(){this.deletionSubscription||(this.deletionSubscription=this.deletionDialogService.confirmationConfirm$.subscribe(n=>{n&&16===n.source&&1===n.state&&this.configScannerService.deleteScanner({registrationId:n.data[0].uuid}).subscribe(t=>{this.msgHandler.showSuccess("SCANNER.DELETE_SUCCESS"),this.refresh()},t=>{this.errorHandler.error(t)})}))}ngOnDestroy(){this.deletionSubscription&&(this.deletionSubscription.unsubscribe(),this.deletionSubscription=null)}refresh(){this.page=1,this.selectedRow=null,this.total=0,this.getScanners(this.state)}getScanners(n){let t,r;this.state=n,n&&n.page&&(this.pageSize=n.page.size,(0,u.Pe)(u.V2.SYSTEM_SCANNER_COMPONENT,this.pageSize)),n&&n.filters&&n.filters.length&&(t=encodeURIComponent(`${n.filters[0].property}=~${n.filters[0].value}`)),r=n&&n.sort&&n.sort.by?(0,u.td)(n):"-creation_time",this.onGoing=!0,this.configScannerService.listScannersResponse({page:this.page,pageSize:this.pageSize,q:t,sort:r}).pipe((0,l.x)(()=>this.onGoing=!1)).subscribe(g=>{if(g.headers){let q=g.headers.get("X-Total-Count");q&&(this.total=parseInt(q,0))}this.scanners=g.body||[],this.getMetadataForAll()},g=>{this.errorHandler.error(g)})}getMetadataForAll(){this.scanners&&this.scanners.length>0&&this.scanners.forEach((n,t)=>{n.uuid&&(this.scanners[t].loadingMetadata=!0,this.configScannerService.getScannerMetadata({registrationId:n.uuid}).pipe((0,l.x)(()=>this.scanners[t].loadingMetadata=!1)).subscribe(r=>{this.scanners[t].metadata=r},r=>{this.scanners[t].metadata=null}))})}addNewScanner(){this.newScannerDialog.open(),this.newScannerDialog.isEdit=!1,this.newScannerDialog.newScannerFormComponent.isEdit=!1}addSuccess(){this.getScanners()}changeStat(){if(this.selectedRow){let n=(0,u.d9)(this.selectedRow);n.disabled=!n.disabled,this.configScannerService.updateScanner({registrationId:this.selectedRow.uuid,registration:n}).subscribe(t=>{this.msgHandler.showSuccess("SCANNER.UPDATE_SUCCESS"),this.refresh()},t=>{this.errorHandler.error(t)})}}setAsDefault(){this.selectedRow&&this.configScannerService.setScannerAsDefault({registrationId:this.selectedRow.uuid,payload:{is_default:!0}}).subscribe(n=>{this.msgHandler.showSuccess("SCANNER.UPDATE_SUCCESS"),this.refresh()},n=>{this.errorHandler.error(n)})}deleteScanners(){if(this.selectedRow){let n=new ie.c("SCANNER.CONFIRM_DELETION","SCANNER.DELETION_SUMMARY",this.selectedRow.name,[this.selectedRow],16,2);this.deletionDialogService.openComfirmDialog(n)}}editScanner(){if(this.selectedRow){this.newScannerDialog.open();let n={};if(n.name=this.selectedRow.name,n.description=this.selectedRow.description,n.url=this.selectedRow.url,n.skipCertVerify=this.selectedRow.skip_certVerify,n.useInner=this.selectedRow.use_internal_addr,"Basic"===this.selectedRow.auth){n.auth="Basic";let t=this.selectedRow.access_credential.split(":")[0],r=this.selectedRow.access_credential.split(":")[1];n.accessCredential={username:t,password:r}}else"Bearer"===this.selectedRow.auth?(n.auth="Bearer",n.accessCredential={token:this.selectedRow.access_credential}):"APIKey"===this.selectedRow.auth?(n.auth="APIKey",n.accessCredential={apiKey:this.selectedRow.access_credential}):n.auth="None";this.newScannerDialog.newScannerFormComponent.newScannerForm.reset(n),this.newScannerDialog.isEdit=!0,this.newScannerDialog.newScannerFormComponent.isEdit=!0,this.newScannerDialog.uid=this.selectedRow.uuid,this.newScannerDialog.originValue=(0,u.d9)(n),this.newScannerDialog.newScannerFormComponent.originValue=(0,u.d9)(n),this.newScannerDialog.editScanner=(0,u.d9)(this.selectedRow)}}}return i.\u0275fac=function(n){return new(n||i)(e.Y36(S.L),e.Y36(b.q),e.Y36(y.d),e.Y36(re.O))},i.\u0275cmp=e.Xpm({type:i,selectors:[["config-scanner"]],viewQuery:function(n,t){if(1&n&&e.Gf(I,5),2&n){let r;e.iGM(r=e.CRH())&&(t.newScannerDialog=r.first)}},decls:57,vars:51,consts:[[1,"row"],[1,"mt-1"],[4,"clrIfOpen"],[3,"clrDgLoading","clrDgSingleSelected","clrDgRefresh","clrDgSingleSelectedChange"],[1,"clr-row"],[1,"clr-col-7"],["type","button",1,"btn","btn-secondary",3,"click"],["shape","plus","size","16"],["id","set-default",1,"btn","btn-secondary",3,"disabled","click"],["clrDropdownTrigger","",1,"btn","btn-link",3,"clrCloseMenuOnItemClick"],["id","action-scanner"],["shape","caret down",1,"clr-icon"],[1,"clr-col-5"],[1,"action-head-pos"],[1,"refresh-btn",3,"click"],["shape","refresh",3,"hidden"],[1,"width-240",3,"clrDgField"],[3,"clrDgItem",4,"ngFor","ngForOf"],[3,"clrDgPageSize","clrDgPage","clrDgTotalItems","clrDgPageChange"],["pagination",""],[3,"clrPageSizeOptions"],[4,"ngIf"],[3,"notify"],["rel","noopener noreferrer","target","_blank",1,"doc",3,"href"],["clrDropdownItem","",1,"btn","btn-secondary",3,"disabled","click"],["size","16","shape","pencil",1,"margin-top-0"],[1,"margin-left-10"],["clrDropdownItem","",3,"disabled","click"],[1,"dropdown-divider"],["size","16","shape","times",1,"margin-top-0"],["id","delete-scanner-action",1,"margin-left-10"],["size","16","shape","success-standard",1,"margin-top-2"],["size","16","shape","ban",1,"margin-top-2"],[3,"clrDgItem"],[1,"position-relative"],["class","label label-info ml-1",4,"ngIf"],["class","spinner spinner-inline ml-2",4,"ngIf","ngIfElse"],["elseBlockLoading",""],["class","icon-wrap",4,"ngIf"],["ngProjectAs","clr-dg-row-detail",5,["clr-dg-row-detail"],3,"uid",4,"clrIfExpanded"],[1,"label","label-info","ml-1"],[1,"spinner","spinner-inline","ml-2"],["class","label label-success",4,"ngIf","ngIfElse"],["elseBlock",""],[1,"label","label-success"],[1,"label","label-danger"],[1,"icon-wrap"],["shape","check-circle","size","20",1,"is-success","enabled-icon"],[1,"margin-left-5px"],["shape","exclamation-triangle","size","20",1,"is-warning"],["ngProjectAs","clr-dg-row-detail",5,["clr-dg-row-detail"],3,"uid"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0)(1,"div")(2,"h4",1),e._uU(3),e.ALo(4,"translate"),e.TgZ(5,"clr-signpost"),e.YNc(6,se,4,4,"clr-signpost-content",2),e.qZA()(),e.TgZ(7,"clr-datagrid",3),e.NdJ("clrDgRefresh",function(g){return t.getScanners(g)})("clrDgSingleSelectedChange",function(g){return t.selectedRow=g}),e.TgZ(8,"clr-dg-action-bar")(9,"div",4)(10,"div",5)(11,"button",6),e.NdJ("click",function(){return t.addNewScanner()}),e._UZ(12,"clr-icon",7),e._uU(13),e.ALo(14,"translate"),e.qZA(),e.TgZ(15,"button",8),e.NdJ("click",function(){return t.setAsDefault()}),e._uU(16),e.ALo(17,"translate"),e.qZA(),e.TgZ(18,"clr-dropdown",9)(19,"span",10),e._uU(20),e.ALo(21,"translate"),e._UZ(22,"clr-icon",11),e.qZA(),e.YNc(23,pe,15,11,"clr-dropdown-menu",2),e.qZA()(),e.TgZ(24,"div",12)(25,"div",13)(26,"span",14),e.NdJ("click",function(){return t.refresh()}),e._UZ(27,"clr-icon",15),e.qZA()()()()(),e.TgZ(28,"clr-dg-column",16),e._uU(29),e.ALo(30,"translate"),e.qZA(),e.TgZ(31,"clr-dg-column",16),e._uU(32),e.ALo(33,"translate"),e.qZA(),e.TgZ(34,"clr-dg-column"),e._uU(35),e.ALo(36,"translate"),e.qZA(),e.TgZ(37,"clr-dg-column"),e._uU(38),e.ALo(39,"translate"),e.qZA(),e.TgZ(40,"clr-dg-column"),e._uU(41),e.ALo(42,"translate"),e.qZA(),e.TgZ(43,"clr-dg-placeholder"),e._uU(44),e.ALo(45,"translate"),e.qZA(),e.YNc(46,Ce,17,9,"clr-dg-row",17),e.TgZ(47,"clr-dg-footer")(48,"clr-dg-pagination",18,19),e.NdJ("clrDgPageChange",function(g){return t.page=g}),e.TgZ(50,"clr-dg-page-size",20),e._uU(51),e.ALo(52,"translate"),e.qZA(),e.YNc(53,Ae,3,5,"span",21),e._uU(54),e.ALo(55,"translate"),e.qZA()()()(),e.TgZ(56,"new-scanner-modal",22),e.NdJ("notify",function(){return t.addSuccess()}),e.qZA()()),2&n&&(e.xp6(3),e.hij(" ",e.lcZ(4,26,"SCANNER.IMAGE_SCANNERS")," "),e.xp6(4),e.Q6J("clrDgLoading",t.onGoing)("clrDgSingleSelected",t.selectedRow),e.xp6(6),e.hij(" ",e.lcZ(14,28,"SCANNER.NEW_SCANNER")," "),e.xp6(2),e.Q6J("disabled",!(t.selectedRow&&!t.selectedRow.is_default&&!t.selectedRow.disabled)),e.xp6(1),e.hij(" ",e.lcZ(17,30,"SCANNER.SET_AS_DEFAULT")," "),e.xp6(2),e.Q6J("clrCloseMenuOnItemClick",!1),e.xp6(2),e.Oqu(e.lcZ(21,32,"MEMBER.ACTION")),e.xp6(7),e.Q6J("hidden",t.onGoing),e.xp6(1),e.Q6J("clrDgField","name"),e.xp6(1),e.Oqu(e.lcZ(30,34,"SCANNER.NAME")),e.xp6(2),e.Q6J("clrDgField","url"),e.xp6(1),e.Oqu(e.lcZ(33,36,"SCANNER.ENDPOINT")),e.xp6(3),e.Oqu(e.lcZ(36,38,"SCANNER.HEALTH")),e.xp6(3),e.Oqu(e.lcZ(39,40,"SCANNER.ENABLED")),e.xp6(3),e.Oqu(e.lcZ(42,42,"SCANNER.AUTH")),e.xp6(3),e.hij(" ",e.lcZ(45,44,"SCANNER.NO_SCANNER")," "),e.xp6(2),e.Q6J("ngForOf",t.scanners),e.xp6(2),e.Q6J("clrDgPageSize",t.pageSize)("clrDgPage",t.page)("clrDgTotalItems",t.total),e.xp6(2),e.Q6J("clrPageSizeOptions",e.DdM(50,Ne)),e.xp6(1),e.Oqu(e.lcZ(52,46,"PAGINATION.PAGE_SIZE")),e.xp6(2),e.Q6J("ngIf",t.total),e.xp6(1),e.AsE(" ",t.total," ",e.lcZ(55,48,"DESTINATION.ITEMS")," "))},dependencies:[o.C9t,o.Gwl,o.m4W,o.Z4N,o.Nz$,o.fv_,o.dRQ,o.Ltv,o.YYR,o.F7K,o.PDs,o.KHL,o.Gcc,o.jND,o.Nh1,o.dml,o.K8c,o.qvL,o.nqY,o.DbV,o.f_W,o.zwp,o.ZUS,o.lU3,o.EuU,o.hQ,p.sg,p.O5,I,oe,C.X$],styles:[".action-head-pos[_ngcontent-%COMP%]{padding-right:18px;height:24px;display:flex;justify-content:flex-end}.refresh-btn[_ngcontent-%COMP%]{cursor:pointer;margin-top:7px}.margin-left-5[_ngcontent-%COMP%]{margin-left:5px}.width-240[_ngcontent-%COMP%]{min-width:240px!important}.margin-top-0[_ngcontent-%COMP%]{margin-top:0}.margin-top-2[_ngcontent-%COMP%]{margin-top:2px}.margin-left-10[_ngcontent-%COMP%]{margin-left:10px}.doc[_ngcontent-%COMP%]{font-size:.7rem}",".config-title[_ngcontent-%COMP%]{display:inline-block}.tooltip-position[_ngcontent-%COMP%]{top:-7px}.clr-form-control-disabled[_ngcontent-%COMP%]{opacity:1}.v-mid[_ngcontent-%COMP%]{vertical-align:middle}"]}),i})();var U=s(7138),we=s(1296),Te=s(5832),N=s(2843),E=s(262),R=s(529);class x{}let Ze=(()=>{class i extends x{constructor(n){super(),this.http=n}postSchedule(n){return this.http.post(`${u.S$}/system/scanAll/schedule`,n).pipe((0,E.K)(t=>(0,N._)(t)))}putSchedule(n){return this.http.put(`${u.S$}/system/scanAll/schedule`,n).pipe((0,E.K)(t=>(0,N._)(t)))}getSchedule(){return this.http.get(`${u.S$}/system/scanAll/schedule`).pipe((0,E.K)(n=>(0,N._)(n)))}}return i.\u0275fac=function(n){return new(n||i)(e.LFG(R.eN))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac}),i})(),F=(()=>{class i{constructor(n,t){this.http=n,this.scanApiRepository=t}manualScan(){return this.scanApiRepository.postSchedule({schedule:{type:"Manual"}})}getSchedule(){return this.scanApiRepository.getSchedule()}postSchedule(n,t){return this.scanApiRepository.postSchedule({schedule:{type:n,cron:t}})}putSchedule(n,t){return this.scanApiRepository.putSchedule({schedule:{type:n,cron:t}})}getMetrics(){return this.http.get(u.S$+"/scans/all/metrics").pipe((0,E.K)(n=>(0,N._)(n))).pipe((0,w.U)(n=>n))}getScanners(){return this.http.get(u.S$+"/scanners").pipe((0,E.K)(n=>(0,N._)(n)))}getScannerMetadata(n){return this.http.get(`${u.S$}/scanners/${n}/metadata`).pipe((0,E.K)(t=>(0,N._)(t)))}}return i.\u0275fac=function(n){return new(n||i)(e.LFG(R.eN),e.LFG(x))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac}),i})();var ve=s(622),be=s(668);function xe(i,a){1&i&&e._UZ(0,"span",2)}function Oe(i,a){if(1&i&&(e.TgZ(0,"div",13)(1,"label",14),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"span"),e._uU(5),e.qZA()()),2&i){const n=e.oxw(2);e.xp6(2),e.Oqu(e.lcZ(3,2,"CONFIG.SCANNING.DB_REFRESH_TIME")),e.xp6(3),e.hij("",n.updatedTimeStr," ")}}function Me(i,a){1&i&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"CONFIG.SCANNING.SCAN_NOW")))}function ye(i,a){1&i&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"VULNERABILITY.STOP_NOW")))}function Ie(i,a){1&i&&(e.TgZ(0,"span",26),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"CONFIG.SCANNING.MANUAL")))}function Ue(i,a){1&i&&(e.TgZ(0,"span",26),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"CONFIG.SCANNING.SCHEDULED")))}const Re=function(i,a,n,t){return{error:i,finished:a,"in-progress":n,abort:t}};function Fe(i,a){if(1&i&&(e.TgZ(0,"div",27)(1,"div",28)(2,"span",29),e._uU(3),e.qZA()(),e.TgZ(4,"div",30),e._uU(5),e.ALo(6,"translate"),e.qZA()()),2&i){const n=a.$implicit,t=e.oxw(3);e.xp6(2),e.Q6J("ngClass",e.l5B(5,Re,t.isError(null==n?null:n.key),t.isFinished(null==n?null:n.key),t.isInProgress(null==n?null:n.key),t.isAborted(null==n?null:n.key))),e.xp6(1),e.Oqu(null==n?null:n.value),e.xp6(2),e.hij(" ",e.lcZ(6,3,t.getI18nKey(null==n?null:n.key))," ")}}function Le(i,a){if(1&i&&(e.TgZ(0,"div",15)(1,"div",16),e.YNc(2,Ie,3,3,"span",17),e.YNc(3,Ue,3,3,"span",17),e.TgZ(4,"span"),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"span",18),e._uU(8),e.qZA()(),e.TgZ(9,"div",19),e._UZ(10,"div",20)(11,"div",21)(12,"div",22)(13,"div",23),e.qZA(),e.TgZ(14,"div",24),e.YNc(15,Fe,7,10,"div",25),e.ALo(16,"keyvalue"),e.qZA()()),2&i){const n=e.oxw(2);e.xp6(1),e.Udp("width",n.totalWidth+"px"),e.xp6(1),e.Q6J("ngIf",n.isManual()),e.xp6(1),e.Q6J("ngIf",n.isSchedule()),e.xp6(2),e.Oqu(e.lcZ(6,19,"SCANNER.TOTAL")),e.xp6(3),e.Oqu(null==n.scanningMetrics?null:n.scanningMetrics.total),e.xp6(1),e.Udp("width",n.totalWidth+"px"),e.xp6(1),e.Udp("width",n.errorWidth()),e.xp6(1),e.Udp("width",n.finishedWidth()),e.xp6(1),e.Udp("width",n.runningWidth()),e.xp6(1),e.Udp("width",n.abortWidth()),e.xp6(1),e.Udp("width",n.totalWidth+"px"),e.xp6(1),e.Q6J("ngForOf",e.lcZ(16,21,null==n.scanningMetrics?null:n.scanningMetrics.metrics))}}function qe(i,a){if(1&i){const n=e.EpF();e.ynx(0),e.TgZ(1,"section",3),e.YNc(2,Oe,6,4,"div",4),e.TgZ(3,"div",5)(4,"cron-selection",6),e.NdJ("inputvalue",function(r){e.CHM(n);const g=e.oxw();return e.KtG(g.saveSchedule(r))}),e.qZA()()(),e.TgZ(5,"div",7)(6,"div",8)(7,"div",9)(8,"button",10),e.NdJ("click",function(){e.CHM(n);const r=e.oxw();return e.KtG(r.scanOrStop())}),e.YNc(9,Me,3,3,"span",1),e.YNc(10,ye,3,3,"span",1),e.qZA(),e._UZ(11,"span",11),e.qZA()(),e.YNc(12,Le,17,23,"div",12),e.qZA(),e.BQk()}if(2&i){const n=e.oxw();e.xp6(2),e.Q6J("ngIf",n.updatedTimeStr),e.xp6(2),e.Q6J("disabled",!n.hasDefaultScanner)("labelCurrent",n.getLabelCurrent)("labelEdit",n.getLabelCurrent)("originCron",n.originCron),e.xp6(4),e.Q6J("disabled",n.onSubmitting||!n.hasDefaultScanner),e.xp6(1),e.Q6J("ngIf",!n.isOnScanning()),e.xp6(1),e.Q6J("ngIf",n.isOnScanning()),e.xp6(1),e.Q6J("hidden",!n.isOnScanning()),e.xp6(1),e.Q6J("ngIf",n.scanningMetrics&&n.scanningMetrics.total)}}const L="None",De=[{path:"",component:(()=>{class i{constructor(){}}return i.\u0275fac=function(n){return new(n||i)},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-interrogation-services"]],decls:14,vars:9,consts:[["sub-header-title","",1,"custom-h2"],[1,"mt-1"],[1,"nav"],[1,"nav-item"],["routerLink","scanners","routerLinkActive","active",1,"nav-link"],["routerLink","vulnerability","routerLinkActive","active",1,"nav-link"]],template:function(n,t){1&n&&(e.TgZ(0,"h2",0),e._uU(1),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"nav",1)(4,"ul",2)(5,"li",3)(6,"a",4),e._uU(7),e.ALo(8,"translate"),e.qZA()(),e.TgZ(9,"li",3)(10,"a",5),e._uU(11),e.ALo(12,"translate"),e.qZA()()()(),e._UZ(13,"router-outlet")),2&n&&(e.xp6(1),e.hij(" ",e.lcZ(2,3,"SIDE_NAV.SYSTEM_MGMT.INTERROGATION_SERVICES"),"\n"),e.xp6(6),e.Oqu(e.lcZ(8,5,"SCANNER.SCANNERS")),e.xp6(4),e.Oqu(e.lcZ(12,7,"CONFIG.VULNERABILITY")))},dependencies:[A.lC,A.yS,A.Od,C.X$],styles:[".sub-header-title[_ngcontent-%COMP%]{margin-top:12px;margin-bottom:12px}.subnav[_ngcontent-%COMP%]   .nav[_ngcontent-%COMP%]{padding-left:0}.role-label[_ngcontent-%COMP%]{color:#ccc;font-size:14px;font-style:italic;letter-spacing:.01em}.backStyle[_ngcontent-%COMP%]{color:#007cbb;font-size:12px;cursor:pointer}"]}),i})(),children:[{path:"scanners",component:Ee},{path:"vulnerability",component:(()=>{class i{constructor(n,t,r,g){this.scanningService=n,this.newScanAllService=t,this.errorHandlerEntity=r,this.translate=g,this.onSubmitting=!1,this.openState=!1,this.totalWidth=200,this.i18nKeyMap={Pending:"CONFIG.SCANNING.STATUS.PENDING",Running:"CONFIG.SCANNING.STATUS.RUNNING",Stopped:"CONFIG.SCANNING.STATUS.STOPPED",Error:"CONFIG.SCANNING.STATUS.ERROR",Success:"CONFIG.SCANNING.STATUS.SUCCESS",Scheduled:"CONFIG.SCANNING.STATUS.SCHEDULED"},this.hasDefaultScanner=!1}get scanningMetrics(){return this._scanningMetrics}set scanningMetrics(n){this._scanningMetrics=n}get scanAvailable(){return!this.onSubmitting&&!this.gettingMetrics&&!this.isOnScanning()&&this.hasDefaultScanner}getScanText(){this.translate.get("CONFIG.SCANNING.SCHEDULE_TO_SCAN_ALL").subscribe(n=>{this.getLabelCurrent=n})}getSchedule(){this.onGoing=!0,this.scanningService.getSchedule().pipe((0,l.x)(()=>{this.onGoing=!1})).subscribe(n=>{this.initSchedule(n)},n=>{this.errorHandlerEntity.error(n)})}getScanners(){this.onGettingUpdatedTimeStr=!0,this.scanningService.getScanners().subscribe(n=>{let t=!1;n&&n.length&&n.forEach(r=>{r.is_default&&(t=!0,this.getMetrics(),this.getSchedule(),this.getScannerMetadata(r.uuid))}),t&&(this.hasDefaultScanner=!0),t||(this.onGettingUpdatedTimeStr=!1,this.translate.get("SCANNER.NO_DEFAULT_SCANNER").subscribe(r=>{this.errorHandlerEntity.warning(r)}))},n=>{this.onGettingUpdatedTimeStr=!1})}getScannerMetadata(n){this.scanningService.getScannerMetadata(n).pipe((0,l.x)(()=>this.onGettingUpdatedTimeStr=!1)).subscribe(t=>{if(t&&t.properties)for(let r in t.properties)r===u.XZ&&t.properties[r]&&(this.updatedTimeStr=new p.uU("en-us").transform(t.properties[r],"short"))})}initSchedule(n){n&&null!==n.schedule?(this.schedule=n,this.originCron=this.schedule.schedule):this.originCron={type:L,cron:""}}ngOnInit(){this.getScanText(),this.getScanners()}ngOnDestroy(){this._timeout&&(clearTimeout(this._timeout),this._timeout=null)}isOnScanning(){return this.scanningMetrics&&this.scanningMetrics.ongoing}getMetrics(){this.gettingMetrics=!0,this.scanningService.getMetrics().pipe((0,l.x)(()=>this.gettingMetrics=!1)).subscribe(n=>{n&&(n.ongoing&&(this._timeout&&(clearTimeout(this._timeout),this._timeout=null),this._timeout||(this._timeout=setTimeout(()=>{this.getMetrics()},5e3))),this.scanningMetrics=n)})}getI18nKey(n){return n&&this.i18nKeyMap[n]?this.i18nKeyMap[n]:n}errorWidth(){return this.scanningMetrics&&this.scanningMetrics.metrics&&this.scanningMetrics.total&&this.scanningMetrics.metrics[u.Iy.ERROR]?this.scanningMetrics.metrics[u.Iy.ERROR]/this.scanningMetrics.total*this.totalWidth+"px":"0"}finishedWidth(){return this.scanningMetrics&&this.scanningMetrics.metrics&&this.scanningMetrics.total&&this.scanningMetrics.metrics[u.Iy.SUCCESS]?this.scanningMetrics.metrics[u.Iy.SUCCESS]/this.scanningMetrics.total*this.totalWidth+"px":"0"}runningWidth(){return this.scanningMetrics&&this.scanningMetrics.metrics&&this.scanningMetrics.total&&this.scanningMetrics.metrics[u.Iy.RUNNING]?this.scanningMetrics.metrics[u.Iy.RUNNING]/this.scanningMetrics.total*this.totalWidth+"px":"0"}abortWidth(){return this.scanningMetrics&&this.scanningMetrics.metrics&&this.scanningMetrics.total&&this.scanningMetrics.metrics[u.Iy.STOPPED]?this.scanningMetrics.metrics[u.Iy.STOPPED]/this.scanningMetrics.total*this.totalWidth+"px":"0"}scanNow(){this.onSubmitting||!this.scanAvailable||(this.onSubmitting=!0,this.scanningService.manualScan().pipe((0,l.x)(()=>this.onSubmitting=!1)).subscribe(()=>{this.translate.get("CONFIG.SCANNING.TRIGGER_SCAN_ALL_SUCCESS").subscribe(n=>{this.errorHandlerEntity.info(n)}),this.scanningMetrics=null,this.getMetrics()},n=>{n&&n.status&&412===n.status?this.translate.get("CONFIG.SCANNING.TRIGGER_SCAN_ALL_FAIL",{error:""+(0,Te.Po)(n)}).subscribe(t=>{this.errorHandlerEntity.error(t)}):this.errorHandlerEntity.error(n)}))}reset(n){this.schedule={schedule:{type:this.CronScheduleComponent.scheduleType,cron:n}}}saveSchedule(n){let t=this.schedule;t&&t.schedule&&t.schedule.type!==L?this.scanningService.putSchedule(this.CronScheduleComponent.scheduleType,n).subscribe(r=>{this.translate.get("CONFIG.SAVE_SUCCESS").subscribe(g=>{this.errorHandlerEntity.info(g),this.CronScheduleComponent.resetSchedule()}),this.reset(n)},r=>{this.errorHandlerEntity.error(r)}):this.scanningService.postSchedule(this.CronScheduleComponent.scheduleType,n).subscribe(r=>{this.translate.get("CONFIG.SAVE_SUCCESS").subscribe(g=>{this.errorHandlerEntity.info(g),this.CronScheduleComponent.resetSchedule()}),this.reset(n)},r=>{this.errorHandlerEntity.error(r)})}isError(n){return n===u.Iy.ERROR}isFinished(n){return n===u.Iy.SUCCESS}isInProgress(n){return n===u.Iy.RUNNING}isAborted(n){return n===u.Iy.STOPPED}isManual(){return this.scanningMetrics&&this.scanningMetrics.trigger===U.K2.MANUAL}isSchedule(){return this.scanningMetrics&&this.scanningMetrics.trigger===U.K2.SCHEDULE}scanOrStop(){this.isOnScanning()?this.stopNow():this.scanNow()}stopNow(){this.onSubmitting=!0,this.newScanAllService.stopScanAll().pipe((0,l.x)(()=>this.onSubmitting=!1)).subscribe(n=>{this.errorHandlerEntity.info("CONFIG.SCANNING.STOP_SCAN_ALL_SUCCESS")},n=>{this.errorHandlerEntity.error(n)})}}return i.\u0275fac=function(n){return new(n||i)(e.Y36(F),e.Y36(ve.M),e.Y36(b.q),e.Y36(C.sK))},i.\u0275cmp=e.Xpm({type:i,selectors:[["vulnerability-config"]],viewQuery:function(n,t){if(1&n&&e.Gf(we.xp,5),2&n){let r;e.iGM(r=e.CRH())&&(t.CronScheduleComponent=r.first)}},decls:2,vars:2,consts:[["class","mt-1 ml-1 spinner spinner-inline",4,"ngIf"],[4,"ngIf"],[1,"mt-1","ml-1","spinner","spinner-inline"],[1,"form-block"],["class","mt-1 display-flex",4,"ngIf"],[1,"button-group"],[1,"w-100",3,"disabled","labelCurrent","labelEdit","originCron","inputvalue"],[1,"clr-row"],[1,"clr-col-2","flex-200"],[1,"btn-scan-right","btn-scan","margin-top-16px"],["id","scan",1,"btn","btn-primary","btn-scan",3,"disabled","click"],[1,"spinner","spinner-inline","margin-left-5","v-mid",3,"hidden"],["class","clr-col",4,"ngIf"],[1,"mt-1","display-flex"],[1,"update-time"],[1,"clr-col"],[1,"total"],["class","float-left",4,"ngIf"],[1,"margin-left-5"],["id","scan-result-container",1,"container"],[1,"error","h-100"],[1,"finished","h-100"],[1,"in-progress","h-100"],[1,"abort","h-100"],[1,"state-container"],["class","clr-row m-0",4,"ngFor","ngForOf"],[1,"float-left"],[1,"clr-row","m-0"],[1,"state"],[1,"badge",3,"ngClass"],[1,"value"]],template:function(n,t){1&n&&(e.YNc(0,xe,1,0,"span",0),e.YNc(1,qe,13,10,"ng-container",1)),2&n&&(e.Q6J("ngIf",t.onGettingUpdatedTimeStr||t.onGoing),e.xp6(1),e.Q6J("ngIf",!(t.onGettingUpdatedTimeStr||t.onGoing)))},dependencies:[o.MgK,p.mk,p.sg,p.O5,be.x,C.X$,p.Nd],styles:[".form-group-override[_ngcontent-%COMP%]{padding-left:0!important}.vertical-center[_ngcontent-%COMP%]{display:flex;align-items:center}.normal-wrapper[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]:not(:first-child){margin-right:18px}.section-title[_ngcontent-%COMP%]{font-size:14px!important;font-weight:600!important}.btn-font[_ngcontent-%COMP%]{font-size:12px!important}.clr-dropdown-override[_ngcontent-%COMP%]{margin-top:-8px}.clr-dropdown-override[_ngcontent-%COMP%]   .dropdown-namespace[_ngcontent-%COMP%]{min-width:300px}.clr-dropdown-override[_ngcontent-%COMP%]   .dropdown-namespace[_ngcontent-%COMP%]   .namespace[_ngcontent-%COMP%]{margin-left:24px}.button-group[_ngcontent-%COMP%]{display:flex;align-items:center}.button-group[_ngcontent-%COMP%]   .btn-scan-right[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:160px;margin-bottom:0;margin-top:41px}.update-time[_ngcontent-%COMP%]{font-size:.5417rem;width:200px;padding-right:1rem}.font-style[_ngcontent-%COMP%]{color:#000}.margin-left-5[_ngcontent-%COMP%]{margin-left:5px}.margin-top-16px[_ngcontent-%COMP%]{margin-top:16px}.v-mid[_ngcontent-%COMP%]{vertical-align:middle}.flex-200[_ngcontent-%COMP%]{flex:0 0 200px}.total[_ngcontent-%COMP%]{text-align:right;line-height:15px;height:15px;font-size:10px;margin-top:7px;margin-bottom:3px}.info[_ngcontent-%COMP%]{height:18px;line-height:18px;font-size:14px}.container[_ngcontent-%COMP%]{height:18px;display:flex;background-color:#eee}.state[_ngcontent-%COMP%]{flex:1;padding-left:3px}.value[_ngcontent-%COMP%]{flex:3}.float-left[_ngcontent-%COMP%]{float:left}.display-flex[_ngcontent-%COMP%]{display:flex}.error[_ngcontent-%COMP%]{background-color:#e62700}.finished[_ngcontent-%COMP%]{background-color:#62a420}.in-progress[_ngcontent-%COMP%]{background-color:#0079b8}.abort[_ngcontent-%COMP%]{background-color:#cccc15}.badge[_ngcontent-%COMP%]{min-width:30px}.info-tips-icon[_ngcontent-%COMP%]{color:gray}.info-tips-icon[_ngcontent-%COMP%]:hover{color:#007cbb}.replication-config[_ngcontent-%COMP%]{margin-top:0;margin-bottom:0}.replication-text[_ngcontent-%COMP%]{font-size:14px;font-weight:600}.replication-tooltip[_ngcontent-%COMP%]{top:-8px}.margin-top-3px[_ngcontent-%COMP%]{margin-top:3px}"]}),i})()},{path:"",redirectTo:"scanners",pathMatch:"full"}]}];let ke=(()=>{class i{}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({providers:[F,{provide:x,useClass:Ze}],imports:[m.m,A.Bz.forChild(De)]}),i})()}}]);