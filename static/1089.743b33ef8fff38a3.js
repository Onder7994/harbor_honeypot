"use strict";(self.webpackChunkharbor_portal=self.webpackChunkharbor_portal||[]).push([[1089],{1089:(yi,Ce,_)=>{_.r(Ce),_.d(Ce,{ArtifactModule:()=>jc});var Z=_(858),S=_(6296),e=_(4650),s=_(9375),I=_(268),R=_(2443);let ce=(()=>{class t{constructor(i,n,o){this.scanningService=i,this.userPermissionService=n,this.errorHandlerService=o,this._hasEnabledScanner=!1,this._hasAddLabelImagePermission=!1,this._hasRetagImagePermission=!1,this._hasDeleteImagePermission=!1,this._hasScanImagePermission=!1}getScanBtnState(){return this._scanBtnState}hasEnabledScanner(){return this._hasEnabledScanner}hasAddLabelImagePermission(){return this._hasAddLabelImagePermission}hasRetagImagePermission(){return this._hasRetagImagePermission}hasDeleteImagePermission(){return this._hasDeleteImagePermission}hasScanImagePermission(){return this._hasScanImagePermission}init(i){this._getProjectScanner(i),this._getPermissionRule(i)}_getProjectScanner(i){this._hasEnabledScanner=!1,this._scanBtnState=s.xp5.LOADING,this.scanningService.getProjectScanner(i).subscribe(n=>{n&&"{}"!==JSON.stringify(n)&&!n.disabled&&"healthy"===n.health?(this._scanBtnState=s.xp5.SUCCESS,this._hasEnabledScanner=!0):this._scanBtnState=s.xp5.ERROR},n=>{this._scanBtnState=s.xp5.ERROR})}_getPermissionRule(i){this.userPermissionService.hasProjectPermissions(i,[{resource:I._W.REPOSITORY_ARTIFACT_LABEL.KEY,action:I._W.REPOSITORY_ARTIFACT_LABEL.VALUE.CREATE},{resource:I._W.REPOSITORY.KEY,action:I._W.REPOSITORY.VALUE.PULL},{resource:I._W.ARTIFACT.KEY,action:I._W.ARTIFACT.VALUE.DELETE},{resource:I._W.REPOSITORY_TAG_SCAN_JOB.KEY,action:I._W.REPOSITORY_TAG_SCAN_JOB.VALUE.CREATE}]).subscribe(o=>{this._hasAddLabelImagePermission=o[0],this._hasRetagImagePermission=o[1],this._hasDeleteImagePermission=o[2],this._hasScanImagePermission=o[3]},o=>this.errorHandlerService.error(o))}}return t.\u0275fac=function(i){return new(i||t)(e.LFG(I.pg),e.LFG(I.Hx),e.LFG(R.q))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac}),t})();var A=_(6895),b=_(2466);function V(t,r){if(1&t){const i=e.EpF();e.TgZ(0,"span"),e._uU(1,"<"),e.TgZ(2,"a",2),e.NdJ("click",function(){e.CHM(i);const o=e.oxw();return e.KtG(o.backInitRepo())}),e._uU(3),e.qZA()()}if(2&t){const i=e.oxw();e.xp6(3),e.Oqu(i.repoName)}}function q(t,r){if(1&t){const i=e.EpF();e.TgZ(0,"span"),e._uU(1," <"),e.TgZ(2,"a",2),e.NdJ("click",function(){const a=e.CHM(i).index,l=e.oxw(2);return e.KtG(l.jumpDigest(a))}),e._uU(3),e.ALo(4,"slice"),e.qZA()()}if(2&t){const i=r.$implicit;e.xp6(3),e.Oqu(e.Dn7(4,1,i,0,15))}}function M(t,r){if(1&t&&(e.TgZ(0,"span"),e.YNc(1,q,5,5,"span",14),e.qZA()),2&t){const i=e.oxw();e.xp6(1),e.Q6J("ngForOf",i.referArtifactNameArray)}}function Si(t,r){if(1&t&&(e.TgZ(0,"h2",15),e._uU(1),e.qZA()),2&t){const i=e.oxw();e.xp6(1),e.hij(" ",i.repoName," ")}}function Oi(t,r){if(1&t&&(e.TgZ(0,"h2",15),e._uU(1),e.ALo(2,"slice"),e.qZA()),2&t){const i=e.oxw();e.xp6(1),e.hij(" ",e.Dn7(2,1,i.artifactDigest,0,15)," ")}}function Li(t,r){1&t&&(e.TgZ(0,"li",12)(1,"button",16),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&t&&(e.xp6(2),e.hij(" ",e.lcZ(3,1,"REPOSITORY.INFO")," "))}let ot=(()=>{class t{constructor(i,n,o){this.route=i,this.router=n,this.artifactListPageService=o,this.referArtifactNameArray=[],this.routeParamsSub||(this.routeParamsSub=this.route.params.subscribe(a=>{if(this.depth=this.route.snapshot.firstChild.params.depth,this.depth){const l=this.depth.split("-");this.referArtifactNameArray=l.slice(0,l.length-1),this.artifactDigest=this.depth.split("-")[l.length-1]}else this.referArtifactNameArray=[],this.artifactDigest=null;this.init()}))}ngOnDestroy(){this.routeParamsSub&&(this.routeParamsSub.unsubscribe(),this.routeParamsSub=null)}init(){this.projectId=this.route.snapshot.parent.params.id;let i=this.route.snapshot.parent.data;i&&(this.projectName=i.projectResolver.name),this.repoName=this.route.snapshot.params.repo,this.artifactListPageService.init(+this.projectId)}watchGoBackEvt(i){this.router.navigate(["harbor","projects",i,"repositories"])}goProBack(){this.router.navigate(["harbor","projects"])}backInitRepo(){this.router.navigate(["harbor","projects",this.projectId,"repositories",this.repoName])}jumpDigest(i){const n=this.referArtifactNameArray.slice(0,i+1);this.router.navigate(n&&n.length?["harbor","projects",this.projectId,"repositories",this.repoName,"artifacts-tab","depth",n.join("-")]:["harbor","projects",this.projectId,"repositories",this.repoName])}}return t.\u0275fac=function(i){return new(i||t)(e.Y36(Z.gz),e.Y36(Z.F0),e.Y36(ce))},t.\u0275cmp=e.Xpm({type:t,selectors:[["artifact-list-page"]],decls:27,vars:12,consts:[[1,"breadcrumb"],[1,"back-icon"],[3,"click"],[4,"ngIf"],[1,"overview-section"],[1,"title-wrapper"],[1,"title-block"],["sub-header-title","","class","custom-h2",4,"ngIf"],[1,"detail-section"],[1,"col-lg-12","col-md-12","col-sm-12","col-xs-12"],["id","configTabs","role","tablist",1,"nav"],["role","presentation","class","nav-item",4,"ngIf"],["role","presentation",1,"nav-item"],["id","repo-image","aria-controls","image","type","button","routerLinkActive","active","routerLink","./artifacts-tab",1,"btn","btn-link","nav-link"],[4,"ngFor","ngForOf"],["sub-header-title","",1,"custom-h2"],["id","repo-info","aria-controls","info","type","button","routerLinkActive","active","routerLink","./info-tab",1,"btn","btn-link","nav-link"]],template:function(i,n){1&i&&(e.TgZ(0,"div")(1,"div",0)(2,"span",1),e._uU(3,"<"),e.qZA(),e.TgZ(4,"a",2),e.NdJ("click",function(){return n.goProBack()}),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"span",1),e._uU(8,"<"),e.qZA(),e.TgZ(9,"a",2),e.NdJ("click",function(){return n.watchGoBackEvt(n.projectId)}),e._uU(10),e.qZA(),e.YNc(11,V,4,1,"span",3),e.YNc(12,M,2,1,"span",3),e.qZA(),e.TgZ(13,"section",4)(14,"div",5)(15,"div",6),e.YNc(16,Si,2,1,"h2",7),e.YNc(17,Oi,3,5,"h2",7),e.qZA()()(),e.TgZ(18,"section",8)(19,"div",9)(20,"ul",10),e.YNc(21,Li,4,3,"li",11),e.TgZ(22,"li",12)(23,"button",13),e._uU(24),e.ALo(25,"translate"),e.qZA()()(),e._UZ(26,"router-outlet"),e.qZA()()()),2&i&&(e.xp6(5),e.Oqu(e.lcZ(6,8,"SIDE_NAV.PROJECTS")),e.xp6(5),e.Oqu(n.projectName),e.xp6(1),e.Q6J("ngIf",n.depth),e.xp6(1),e.Q6J("ngIf",(null==n.referArtifactNameArray?null:n.referArtifactNameArray.length)>=1),e.xp6(4),e.Q6J("ngIf",!n.artifactDigest),e.xp6(1),e.Q6J("ngIf",n.artifactDigest),e.xp6(4),e.Q6J("ngIf",!n.artifactDigest),e.xp6(3),e.hij(" ",e.lcZ(25,10,"REPOSITORY.ARTIFACTS")," "))},dependencies:[Z.lC,Z.rH,Z.Od,A.sg,A.O5,b.X$,A.OU],styles:[".breadcrumb[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none;cursor:pointer;color:#007cbb;font-size:16px;padding:5px;border-radius:2px;margin-right:5px}.back-icon[_ngcontent-%COMP%]{color:#007cbb;font-size:16px}"]}),t})();var G=_(4128),ve=_(9646),L=_(8746),se=_(4004),Me=_(262),u=_(3526),w=_(3819);const at=[{filterBy:"type",filterByShowText:"Type",listItem:[{filterText:"IMAGE",showItem:"ARTIFACT.IMAGE"},{filterText:"CHART",showItem:"ARTIFACT.CHART"},{filterText:"CNAB",showItem:"ARTIFACT.CNAB"},{filterText:"WASM",showItem:"ARTIFACT.WASM"}]},{filterBy:"tags",filterByShowText:"Tags",listItem:[{filterText:"*",showItem:"ARTIFACT.TAGGED"},{filterText:"nil",showItem:"ARTIFACT.UNTAGGED"},{filterText:"",showItem:"ARTIFACT.ALL"}]},{filterBy:"labels",filterByShowText:"Label",listItem:[]}];var W=(()=>{return(t=W||(W={})).COSIGN="signature.cosign",t.NYDUS="accelerator.nydus",W;var t})(),F=(()=>{return(t=F||(F={})).IMAGE="IMAGE",t.CHART="CHART",t.CNAB="CNAB",t.OPENPOLICYAGENT="OPENPOLICYAGENT",F;var t})();const ke="images/artifact-default.svg";var X=(()=>((X||(X={})).ACCESSORY_TYPE="accessoryType",X))();function lt(t,r,i){let n="";return t&&r&&i&&(t===F.IMAGE&&(n=`docker pull ${r}:${i}`),t===F.CNAB&&(n=`cnab-to-oci pull ${r}:${i}`),t===F.CHART&&(n=`helm pull oci://${r} --version ${i}`)),n}class Ni{}var D=(()=>{return(t=D||(D={})).VULNERABILITIES="vulnerabilities",t.BUILD_HISTORY="build_history",t.SUMMARY="readme.md",t.VALUES="values.yaml",t.DEPENDENCIES="dependencies",D;var t})(),De=_(5832),Ie=_(8726),j=_(7863),B=_(38),ee=_(1219),te=_(7579),Zi=_(3099),Ei=_(9296),Pi=_(1481);class pe{constructor(){this.triggerUploadArtifact=new te.x}}let Ri=(()=>{class t extends pe{constructor(i,n){super(),this.iconService=i,this.domSanitizer=n,this.triggerUploadArtifact=new te.x,this._iconMap={},this._sharedIconObservableMap={}}getIcon(i){return this._iconMap[i]}setIcon(i,n){this._iconMap[i]||(this._iconMap[i]=n)}getIconsFromBackEnd(i){i&&i.length&&i.forEach(n=>{n.icon&&!this.getIcon(n.icon)&&(this._sharedIconObservableMap[n.icon]||(this._sharedIconObservableMap[n.icon]=this.iconService.getIcon({digest:n.icon}).pipe((0,Zi.B)())),this._sharedIconObservableMap[n.icon].subscribe(o=>{this.setIcon(n.icon,this.domSanitizer.bypassSecurityTrustUrl(`data:${o["content-type"]};charset=utf-8;base64,${o.content}`))}))})}}return t.\u0275fac=function(i){return new(i||t)(e.LFG(Ei.C),e.LFG(Pi.H7))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac}),t})();var ue=_(3046);const Mi=["datagrid"];function ki(t,r){if(1&t&&e._UZ(0,"hr",13),2&t){const i=e.oxw(2);e.Udp("height",i.dashLineHeight,"px")}}function Di(t,r){if(1&t){const i=e.EpF();e.TgZ(0,"img",14),e.NdJ("error",function(o){e.CHM(i);const a=e.oxw(2);return e.KtG(a.showDefaultIcon(o))}),e.qZA()}if(2&t){const i=e.oxw().$implicit,n=e.oxw();e.Q6J("title",i.type)("src",n.getIcon(i.icon),e.LSH)}}function Ui(t,r){if(1&t){const i=e.EpF();e.TgZ(0,"clr-dg-row",4)(1,"clr-dg-action-overflow")(2,"button",5),e.NdJ("click",function(){const a=e.CHM(i).$implicit,l=e.oxw();return e.KtG(l.delete(a))}),e._uU(3),e.ALo(4,"translate"),e.qZA()(),e.TgZ(5,"clr-dg-cell",6),e.YNc(6,ki,1,2,"hr",7),e._UZ(7,"hr",8),e.TgZ(8,"div",9)(9,"div",10),e.YNc(10,Di,1,2,"img",11),e.qZA(),e.TgZ(11,"a",12),e.NdJ("click",function(){const a=e.CHM(i).$implicit,l=e.oxw();return e.KtG(l.goIntoArtifactSummaryPage(a))}),e._uU(12),e.qZA()()(),e.TgZ(13,"clr-dg-cell")(14,"div",9),e._uU(15),e.qZA()(),e.TgZ(16,"clr-dg-cell")(17,"div",9),e._uU(18),e.qZA()(),e.TgZ(19,"clr-dg-cell")(20,"div",9),e._uU(21),e.ALo(22,"harborDatetime"),e.qZA()()()}if(2&t){const i=r.$implicit,n=r.index,o=e.oxw();e.Q6J("clrDgItem",i),e.xp6(3),e.hij(" ",e.lcZ(4,9,"REPOSITORY.DELETE")," "),e.xp6(3),e.Q6J("ngIf",n===(null==o.displayedAccessories?null:o.displayedAccessories.length)-1&&o.viewInit),e.xp6(3),e.s9C("title",null==i?null:i.digest),e.xp6(1),e.Q6J("ngIf",o.getIcon(i.icon)),e.xp6(2),e.Oqu(null==i||null==i.digest?null:i.digest.slice(0,15)),e.xp6(3),e.hij(" ",i.type," "),e.xp6(3),e.hij(" ",o.size(i.size)," "),e.xp6(3),e.hij(" ",e.xi3(22,11,i.creation_time,"short")," ")}}function Yi(t,r){if(1&t&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t){e.oxw();const i=e.MAs(2);e.xp6(1),e.lnq("",i.firstItem+1," - ",i.lastItem+1," ",e.lcZ(2,3,"ROBOT_ACCOUNT.OF")," ")}}function qi(t,r){if(1&t){const i=e.EpF();e.TgZ(0,"clr-dg-footer")(1,"clr-dg-pagination",15,16),e.NdJ("clrDgPageChange",function(o){e.CHM(i);const a=e.oxw();return e.KtG(a.currentPage=o)}),e.YNc(3,Yi,3,5,"span",3),e._uU(4),e.ALo(5,"translate"),e.qZA()()}if(2&t){const i=e.oxw();e.xp6(1),e.Q6J("clrDgPageSize",i.pageSize)("clrDgPage",i.currentPage)("clrDgTotalItems",i.total),e.xp6(2),e.Q6J("ngIf",i.total),e.xp6(1),e.AsE(" ",i.total," ",e.lcZ(5,6,"ROBOT_ACCOUNT.ITEMS")," ")}}let Fi=(()=>{class t{constructor(i,n,o,a,l){this.activatedRoute=i,this.router=n,this.newArtifactService=o,this.artifactService=a,this.errorHandlerService=l,this.accessories=[],this.deleteAccessory=new e.vpe,this.currentPage=1,this.total=0,this.pageSize=5,this.page=1,this.displayedAccessories=[],this.loading=!1,this.viewInit=!1}ngOnInit(){this.displayedAccessories=(0,u.d9)(this.accessories),setTimeout(()=>{this.viewInit=!0})}size(i){return(0,u.BU)(i.toString())}getIcon(i){return this.artifactService.getIcon(i)}showDefaultIcon(i){i&&i.target&&(i.target.src=ke)}goIntoArtifactSummaryPage(i){this.router.navigate(["artifacts",i.digest],this.activatedRoute.snapshot.queryParams[j.jv]===j.gT?{relativeTo:this.activatedRoute,queryParams:{[j.jv]:j.gT,[X.ACCESSORY_TYPE]:i.type}}:{relativeTo:this.activatedRoute,queryParams:{[X.ACCESSORY_TYPE]:i.type}})}delete(i){this.deleteAccessory.emit(i)}clrLoad(){if(1===this.currentPage)return this.displayedAccessories=(0,u.d9)(this.accessories),void this.getIconFromBackend();this.loading=!0;const i={projectName:this.projectName,repositoryName:(0,u.gI)(this.repositoryName),reference:this.artifactDigest,page:this.currentPage,pageSize:5};this.newArtifactService.listAccessories(i).pipe((0,L.x)(()=>this.loading=!1)).subscribe(n=>{this.displayedAccessories=n,this.getIconFromBackend()},n=>{this.errorHandlerService.error(n)})}getIconFromBackend(){this.displayedAccessories?.length&&this.artifactService.getIconsFromBackEnd(this.displayedAccessories)}get dashLineHeight(){return this.datagrid&&this.datagrid.el&&this.datagrid.el?.nativeElement?.offsetHeight?this.datagrid.el.nativeElement?.offsetHeight:0}}return t.\u0275fac=function(i){return new(i||t)(e.Y36(Z.gz),e.Y36(Z.F0),e.Y36(ee.b),e.Y36(pe),e.Y36(R.q))},t.\u0275cmp=e.Xpm({type:t,selectors:[["sub-accessories"]],viewQuery:function(i,n){if(1&i&&e.Gf(Mi,5),2&i){let o;e.iGM(o=e.CRH())&&(n.datagrid=o.first)}},inputs:{projectName:"projectName",repositoryName:"repositoryName",artifactDigest:"artifactDigest",accessories:"accessories",total:"total"},outputs:{deleteAccessory:"deleteAccessory"},decls:16,vars:15,consts:[[1,"ml-8",3,"clrDgLoading","clrDgRefresh"],["datagrid",""],[3,"clrDgItem",4,"ngFor","ngForOf"],[4,"ngIf"],[3,"clrDgItem"],[1,"action-item",3,"click"],[1,"relative"],["class","y-dash-line",3,"height",4,"ngIf"],[1,"x-dash-line"],[1,"cell"],[1,"artifact-icon-div","clr-display-inline-block",3,"title"],["class","artifact-icon",3,"title","src","error",4,"ngIf"],["href","javascript:void(0)",1,"margin-left-5",3,"click"],[1,"y-dash-line"],[1,"artifact-icon",3,"title","src","error"],[3,"clrDgPageSize","clrDgPage","clrDgTotalItems","clrDgPageChange"],["pagination",""]],template:function(i,n){1&i&&(e.TgZ(0,"clr-datagrid",0,1),e.NdJ("clrDgRefresh",function(){return n.clrLoad()}),e.TgZ(2,"clr-dg-column"),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"clr-dg-column"),e._uU(6),e.ALo(7,"translate"),e.qZA(),e.TgZ(8,"clr-dg-column"),e._uU(9),e.ALo(10,"translate"),e.qZA(),e.TgZ(11,"clr-dg-column"),e._uU(12),e.ALo(13,"translate"),e.qZA(),e.YNc(14,Ui,23,14,"clr-dg-row",2),e.YNc(15,qi,6,8,"clr-dg-footer",3),e.qZA()),2&i&&(e.Q6J("clrDgLoading",n.loading),e.xp6(3),e.Oqu(e.lcZ(4,7,"ACCESSORY.ACCESSORY")),e.xp6(3),e.Oqu(e.lcZ(7,9,"PROJECT.TYPE")),e.xp6(3),e.Oqu(e.lcZ(10,11,"REPOSITORY.SIZE")),e.xp6(3),e.Oqu(e.lcZ(13,13,"ROBOT_ACCOUNT.CREATETION")),e.xp6(2),e.Q6J("ngForOf",n.displayedAccessories),e.xp6(1),e.Q6J("ngIf",n.total>n.pageSize))},dependencies:[s.C9t,s.o_2,s.m4W,s.Z4N,s.fv_,s.dRQ,s.Ltv,s.PDs,s.KHL,s.Gcc,s.jND,s.Nh1,s.dml,s.K8c,A.sg,A.O5,b.X$,ue.Z],styles:[".artifact-icon-div[_ngcontent-%COMP%]{text-align:center;width:2.5rem;height:.8rem}.artifact-icon[_ngcontent-%COMP%]{height:.8rem}.cell[_ngcontent-%COMP%]{display:flex;align-items:center;width:100%;height:100%}.margin-left-5[_ngcontent-%COMP%]{margin-left:5px}.ml-8[_ngcontent-%COMP%]{margin-left:8rem}.x-dash-line[_ngcontent-%COMP%]{position:absolute;width:80px;left:-80px;border:0;border-top:2px dotted #a2a9b6}.y-dash-line[_ngcontent-%COMP%]{position:absolute;border:0;border-left:2px dotted #a2a9b6;left:-4.2rem;bottom:0}"]}),t})();var Se=_(8372),Ue=_(3900),x=_(4006),ji=_(5266);function Bi(t,r){if(1&t){const i=e.EpF();e.TgZ(0,"li",12),e.NdJ("click",function(){const a=e.CHM(i).$implicit,l=e.oxw();return e.KtG(l.selectedProjectName(null==a?null:a.name))}),e._uU(1),e.qZA()}if(2&t){const i=r.$implicit;e.xp6(1),e.hij(" ",null==i?null:i.name," ")}}function Ji(t,r){1&t&&(e.ynx(0),e._uU(1),e.ALo(2,"translate"),e.BQk()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"PROJECT.NAME_TOOLTIP")," "))}function Hi(t,r){1&t&&(e.ynx(0),e._uU(1),e.ALo(2,"translate"),e.BQk()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"REPLICATION.NO_PROJECT_INFO")," "))}function Qi(t,r){if(1&t&&(e.TgZ(0,"clr-control-error",13),e.YNc(1,Ji,3,3,"ng-container",14),e.YNc(2,Hi,3,3,"ng-container",14),e.qZA()),2&t){const i=e.oxw();e.xp6(1),e.Q6J("ngIf",i.projectName.invalid),e.xp6(1),e.Q6J("ngIf",i.notExist)}}function Vi(t,r){1&t&&(e.TgZ(0,"clr-control-error",13),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"RETAG.TIP_REPO")," "))}let Gi=(()=>{class t{constructor(i,n,o){this.fb=i,this.errorHandler=n,this.proService=o,this.selectedProjectList=[],this.proNameChecker=new te.x,this.notExist=!1,this.checkingName=!1,this.imageNameForm=this.fb.group({projectName:["",x.kI.compose([x.kI.minLength(2),x.kI.required,x.kI.pattern("^[a-z0-9]+(?:[._-][a-z0-9]+)*$")])],repoName:["",x.kI.compose([x.kI.required,x.kI.maxLength(256),x.kI.pattern("^[a-z0-9]+(?:[._-][a-z0-9]+)*(/[a-z0-9]+(?:[._-][a-z0-9]+)*)*")])]})}ngOnInit(){this.proNameChecker.pipe((0,Se.b)(200)).pipe((0,Ue.w)(i=>(this.notExist=!1,this.checkingName=!0,this.selectedProjectList=[],this.proService.listProjects({name:i,page:1,pageSize:10}).pipe((0,L.x)(()=>this.checkingName=!1))))).subscribe(i=>{if(i){this.selectedProjectList=i;let n=i.find(o=>o.name===this.imageNameForm.controls.projectName.value);this.notExist=!n}else this.notExist=!0},i=>{this.errorHandler.error(i),this.notExist=!0})}validateProjectName(){let i=this.imageNameForm.controls.projectName;i&&i.valid&&this.proNameChecker.next(i.value)}get form(){return this.imageNameForm}get projectName(){return this.imageNameForm.get("projectName")}get repoName(){return this.imageNameForm.get("repoName")}ngOnDestroy(){this.proNameChecker&&this.proNameChecker.unsubscribe()}leaveProjectInput(){this.selectedProjectList=[]}selectedProjectName(i){this.imageNameForm.controls.projectName.setValue(i),this.selectedProjectList=[],this.notExist=!1}}return t.\u0275fac=function(i){return new(i||t)(e.Y36(x.QS),e.Y36(R.q),e.Y36(ji.Y))},t.\u0275cmp=e.Xpm({type:t,selectors:[["hbr-image-name-input"]],decls:23,vars:17,consts:[[1,"clr-form","clr-form-horizontal",3,"formGroup","mouseleave"],[1,"clr-form-control"],[1,"required","clr-control-label"],[1,"clr-control-container"],[1,"clr-input-wrapper"],["type","text","id","project-name","formControlName","projectName","autocomplete","off",1,"clr-input","w-90",3,"keyup"],["shape","exclamation-circle",1,"clr-validate-icon"],[1,"spinner","spinner-inline",3,"hidden"],[1,"selectBox"],[3,"click",4,"ngFor","ngForOf"],["class","tooltip-content",4,"ngIf"],["type","text","id","repo-name","formControlName","repoName","autocomplete","off",1,"clr-input","w-90"],[3,"click"],[1,"tooltip-content"],[4,"ngIf"]],template:function(i,n){1&i&&(e.TgZ(0,"form",0),e.NdJ("mouseleave",function(){return n.leaveProjectInput()}),e.TgZ(1,"div",1)(2,"label",2),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"div",3)(6,"div",4)(7,"input",5),e.NdJ("keyup",function(){return n.validateProjectName()}),e.qZA(),e._UZ(8,"clr-icon",6)(9,"span",7),e.TgZ(10,"div",8)(11,"ul"),e.YNc(12,Bi,2,1,"li",9),e.qZA()()(),e.YNc(13,Qi,3,2,"clr-control-error",10),e.qZA()(),e.TgZ(14,"div",1)(15,"label",2),e._uU(16),e.ALo(17,"translate"),e.qZA(),e.TgZ(18,"div",3)(19,"div",4),e._UZ(20,"input",11)(21,"clr-icon",6),e.qZA(),e.YNc(22,Vi,3,3,"clr-control-error",10),e.qZA()()()),2&i&&(e.Q6J("formGroup",n.imageNameForm),e.xp6(3),e.Oqu(e.lcZ(4,13,"PROJECT.NAME")),e.xp6(2),e.ekj("clr-error",n.projectName.invalid&&(n.projectName.dirty||n.projectName.touched)||n.notExist),e.xp6(4),e.Q6J("hidden",!n.checkingName),e.xp6(1),e.Udp("display",n.selectedProjectList.length?"block":"none"),e.xp6(2),e.Q6J("ngForOf",n.selectedProjectList),e.xp6(1),e.Q6J("ngIf",n.projectName.invalid&&(n.projectName.dirty||n.projectName.touched)||n.notExist),e.xp6(3),e.Oqu(e.lcZ(17,15,"REPOSITORY.REPO_NAME")),e.xp6(2),e.ekj("clr-error",n.repoName.invalid&&(n.repoName.dirty||n.repoName.touched)),e.xp6(4),e.Q6J("ngIf",n.repoName.invalid&&(n.repoName.dirty||n.repoName.touched)))},dependencies:[x._Y,x.Fj,x.JJ,x.JL,A.sg,A.O5,s.qvL,s.MgK,s.VqA,x.sg,x.u,b.X$],styles:[".selectBox[_ngcontent-%COMP%]{position:absolute;width:278px;height:auto;background-color:#fff;border:1px solid rgba(0,0,0,.15);border-right-width:2px;border-bottom-width:2px;border-radius:6px;box-shadow:0 5px 10px #0003;z-index:100}.selectBox[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{list-style:none;padding:3px 20px;cursor:pointer}.selectBox[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{color:#262626;background-image:linear-gradient(180deg,#f5f5f5 0,#e8e8e8);background-repeat:repeat-x}.clr-input-wrapper[_ngcontent-%COMP%]{width:100%}.wrap-label[_ngcontent-%COMP%]{display:block}.wrap-label[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%}.clr-control-container[_ngcontent-%COMP%]{width:60%}.w-90[_ngcontent-%COMP%]{width:278px}"]}),t})();const zi=["imageNameInput"];let ct=(()=>{class t{constructor(i,n,o,a){this.activatedRoute=i,this.artifactService=n,this.errorHandlerService=o,this.translateService=a,this.retagDialogOpened=!1}ngOnInit(){const i=this.activatedRoute.snapshot?.parent?.parent?.data;i&&(this.projectName=i.projectResolver.name),this.repoName=this.activatedRoute.snapshot?.parent?.params.repo}onRetag(){let i={projectName:this.imageNameInput.projectName.value,repositoryName:(0,u.gI)(this.imageNameInput.repoName.value),from:`${this.projectName}/${this.repoName}@${this.digest}`};this.artifactService.CopyArtifact(i).pipe((0,L.x)(()=>{this.imageNameInput.form.reset(),this.retagDialogOpened=!1})).subscribe({next:n=>{this.translateService.get("RETAG.MSG_SUCCESS").subscribe(o=>{this.errorHandlerService.info(o)})},error:n=>{this.errorHandlerService.error(n)}})}retag(i){this.retagDialogOpened=!0,this.imageNameInput.imageNameForm.reset({repoName:this.repoName,projectName:null}),this.digest=i,this.imageNameInput.notExist=!1}}return t.\u0275fac=function(i){return new(i||t)(e.Y36(Z.gz),e.Y36(ee.b),e.Y36(R.q),e.Y36(b.sK))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-copy-artifact"]],viewQuery:function(i,n){if(1&i&&e.Gf(zi,5),2&i){let o;e.iGM(o=e.CRH())&&(n.imageNameInput=o.first)}},decls:12,vars:9,consts:[[1,"hidden-tag",3,"clrModalOpen","clrModalStaticBackdrop","clrModalOpenChange"],[1,"modal-title"],[1,"modal-body","retag-modal-body"],[1,"row","col-md-12"],["imageNameInput",""],[1,"modal-footer"],["type","button",1,"btn","btn-primary",3,"disabled","click"]],template:function(i,n){if(1&i&&(e.TgZ(0,"clr-modal",0),e.NdJ("clrModalOpenChange",function(a){return n.retagDialogOpened=a}),e.TgZ(1,"h3",1),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",2)(5,"div",3),e._UZ(6,"hbr-image-name-input",null,4),e.qZA()(),e.TgZ(8,"div",5)(9,"button",6),e.NdJ("click",function(){return n.onRetag()}),e._uU(10),e.ALo(11,"translate"),e.qZA()()()),2&i){const o=e.MAs(7);e.Q6J("clrModalOpen",n.retagDialogOpened)("clrModalStaticBackdrop",!0),e.xp6(2),e.Oqu(e.lcZ(3,5,"REPOSITORY.RETAG")),e.xp6(7),e.Q6J("disabled",o.projectName.invalid||o.repoName.invalid||o.notExist||o.checkingName),e.xp6(1),e.hij(" ",e.lcZ(11,7,"BUTTON.CONFIRM")," ")}},dependencies:[s.qAN,s.VLi,Gi,b.X$]}),t})();var $i=_(5016);const Ki=["digestTarget"];let st=(()=>{class t{constructor(){this.showTagManifestOpened=!1,this.copyFailed=!1}onSuccess(i){this.copyFailed=!1,this.showTagManifestOpened=!1}onError(i){this.copyFailed=!0,this.textInput&&this.textInput.nativeElement.select()}showDigestId(i){this.digestId=i,this.showTagManifestOpened=!0,this.copyFailed=!1}}return t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-copy-digest"]],viewQuery:function(i,n){if(1&i&&e.Gf(Ki,5),2&i){let o;e.iGM(o=e.CRH())&&(n.textInput=o.first)}},decls:16,vars:15,consts:[[1,"hidden-tag",3,"clrModalOpen","clrModalStaticBackdrop","clrModalClosable","clrModalOpenChange"],[1,"modal-title"],[1,"modal-body"],[1,"row","col-md-12"],["rows","2",1,"clr-textarea","w-100"],["digestTarget",""],[1,"modal-footer"],[1,"copy-failed",3,"hidden"],["type","button",1,"btn","btn-primary",3,"ngxClipboard","cbOnSuccess","cbOnError"]],template:function(i,n){if(1&i&&(e.TgZ(0,"clr-modal",0),e.NdJ("clrModalOpenChange",function(a){return n.showTagManifestOpened=a}),e.TgZ(1,"h3",1),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",2)(5,"div",3)(6,"textarea",4,5),e._uU(8),e.qZA()()(),e.TgZ(9,"div",6)(10,"span",7),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.TgZ(13,"button",8),e.NdJ("cbOnSuccess",function(a){return n.onSuccess(a)})("cbOnError",function(a){return n.onError(a)}),e._uU(14),e.ALo(15,"translate"),e.qZA()()()),2&i){const o=e.MAs(7);e.Q6J("clrModalOpen",n.showTagManifestOpened)("clrModalStaticBackdrop",!0)("clrModalClosable",!1),e.xp6(2),e.Oqu(e.lcZ(3,9,"REPOSITORY.COPY_DIGEST_ID")),e.xp6(6),e.Oqu(n.digestId),e.xp6(2),e.Q6J("hidden",!n.copyFailed),e.xp6(1),e.Oqu(e.lcZ(12,11,"TAG.COPY_ERROR")),e.xp6(2),e.Q6J("ngxClipboard",o),e.xp6(1),e.hij(" ",e.lcZ(15,13,"BUTTON.COPY")," ")}},dependencies:[s.qAN,s.VLi,$i.y,b.X$]}),t})();var pt=_(312),Ye=_(8025),qe=_(4241),ut=_(7632),Fe=_(6082),gt=_(1884),Wi=_(9300),Xi=_(5884);function en(t,r){if(1&t){const i=e.EpF();e.TgZ(0,"button",8),e.NdJ("click",function(){const a=e.CHM(i).$implicit,l=e.oxw();return e.KtG(l.selectLabel(a))}),e._UZ(1,"clr-icon",9)(2,"hbr-label-piece",10),e.qZA()}if(2&t){const i=r.$implicit,n=e.oxw();e.xp6(1),e.Udp("visibility",n.isSelect(i)?"visible":"hidden"),e.xp6(1),e.Q6J("label",i)("labelWidth",130)}}let ft=(()=>{class t{constructor(i,n){this.labelService=i,this.router=n,this.ownedLabels=[],this.width=180,this.scope="g",this.candidateLabels=[],this.loading=!1,this.clickLabel=new e.vpe,this._searchSubject=new te.x,this._subSearch||(this._subSearch=this._searchSubject.pipe((0,Se.b)(500),(0,gt.x)(),(0,Wi.h)(o=>(o||this.initCandidateLabel(),!!o)),(0,Ue.w)(o=>this.getLabelObservable(o))).subscribe(o=>{this.candidateLabels=o}))}ngOnInit(){this.checkProjectId(),this.initCandidateLabel()}initCandidateLabel(){const i=[];if(this.ownedLabels?.length){const n=[],o=[];this.ownedLabels?.forEach(a=>{"p"===a.scope&&n.push(a.id),"g"===a.scope&&o.push(a.id)}),n?.length&&i.push(this.labelService.ListLabels({page:1,pageSize:50,scope:"p",projectId:this.projectId,q:encodeURIComponent(`id={${n.join(" ")}}`)})),o?.length&&i.push(this.labelService.ListLabels({page:1,pageSize:50,scope:"g",q:encodeURIComponent(`id={${o.join(" ")}}`)}))}i.push(this.getLabelObservable("")),(0,G.D)(i).pipe((0,se.U)(n=>[].concat.apply([],n)),(0,se.U)(n=>n.filter((o,a,l)=>l.findIndex(c=>c.id===o.id)===a))).subscribe(n=>{this.candidateLabels=n})}ngOnChanges(i){this.checkProjectId()}ngOnDestroy(){this._subSearch&&(this._subSearch.unsubscribe(),this._subSearch=null)}checkProjectId(){if("p"===this.scope&&!this.projectId)throw new Error("Attribute [projectId] is required")}search(){this._searchSubject.next(this.searchValue)}selectLabel(i){this.clickLabel.emit({label:i,isAdd:!this.isSelect(i)})}isSelect(i){return!!this.ownedLabels?.length&&this.ownedLabels.some(n=>n.id===i.id)}goToLabelPage(){this.router.navigate("p"===this.scope?["harbor","projects",this.projectId,"labels"]:["harbor","labels"])}getLabelObservable(i){return this.loading=!0,"p"===this.scope?(0,G.D)([this.labelService.ListLabels({page:1,pageSize:50,scope:"p",projectId:this.projectId,q:i?encodeURIComponent(`name=~${i}`):null}),this.labelService.ListLabels({page:1,pageSize:50,scope:"g",q:i?encodeURIComponent(`name=~${i}`):null})]).pipe((0,se.U)(n=>[].concat.apply([],n)),(0,L.x)(()=>this.loading=!1)):this.labelService.ListLabels({page:1,pageSize:50,scope:"g",q:i?encodeURIComponent(`name=~${i}`):null}).pipe((0,L.x)(()=>this.loading=!1))}}return t.\u0275fac=function(i){return new(i||t)(e.Y36(Xi.Q),e.Y36(Z.F0))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-label-selector"]],inputs:{ownedLabels:"ownedLabels",width:"width",scope:"scope",projectId:"projectId"},outputs:{clickLabel:"clickLabel"},features:[e.TTD],decls:12,vars:14,consts:[[1,"clr-input-wrapper","filter-label-input"],["type","text","autocomplete","off",1,"clr-input",3,"placeholder","ngModel","ngModelChange","keyup"],[1,"no-labels",3,"hidden"],[1,"spinner","spinner-inline"],[3,"hidden"],[1,"no-labels",3,"hidden","click"],[1,"has-label",3,"hidden"],["type","button","class","dropdown-item",3,"click",4,"ngFor","ngForOf"],["type","button",1,"dropdown-item",3,"click"],["shape","check",1,"check-icon"],[3,"label","labelWidth"]],template:function(i,n){1&i&&(e.TgZ(0,"div")(1,"div",0)(2,"input",1),e.NdJ("ngModelChange",function(a){return n.searchValue=a})("keyup",function(){return n.search()}),e.ALo(3,"translate"),e.qZA()(),e.TgZ(4,"div",2),e._UZ(5,"span",3),e.qZA(),e.TgZ(6,"div",4)(7,"div",5),e.NdJ("click",function(){return n.goToLabelPage()}),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"div",6),e.YNc(11,en,3,4,"button",7),e.qZA()()()),2&i&&(e.Udp("width",n.width,"px"),e.xp6(2),e.s9C("placeholder",e.lcZ(3,10,"LABEL.FILTER_LABEL_PLACEHOLDER")),e.Q6J("ngModel",n.searchValue),e.xp6(2),e.Q6J("hidden",!n.loading),e.xp6(2),e.Q6J("hidden",n.loading),e.xp6(1),e.Q6J("hidden",n.candidateLabels.length),e.xp6(1),e.hij(" ",e.lcZ(9,12,"LABEL.NO_LABELS")," "),e.xp6(2),e.Q6J("hidden",!n.candidateLabels.length),e.xp6(1),e.Q6J("ngForOf",n.candidateLabels))},dependencies:[x.Fj,x.JJ,x.On,A.sg,s.qvL,Fe.q,b.X$],styles:[".has-label[_ngcontent-%COMP%]{max-height:300px;overflow-y:auto;margin-top:10px}.filter-label-input[_ngcontent-%COMP%]{display:flex;justify-content:center}.no-labels[_ngcontent-%COMP%]{height:4rem;display:flex;align-items:center;justify-content:center}.dropdown-item[_ngcontent-%COMP%]{padding:3px;display:flex;align-items:center}.check-icon[_ngcontent-%COMP%]{margin-left:5px;margin-right:5px;margin-top:3px}.clr-form-control[_ngcontent-%COMP%]{margin-top:0!important}"]}),t})();var je=_(5963),tn=_(2866),ht=_(9739);const nn=["barChart"];let rn=(()=>{class t{constructor(i){this.translate=i,this.metadata=[],this.translatedTextArr=[],this.isWhiteBackground=!1,this.hasViewInit=!1}ngOnInit(){this.translateText()}ngAfterViewInit(){this.hasViewInit=!0,this.initChart()}ngDoCheck(){this.hasViewInit&&this.initChart()}translateText(){if(this.metadata&&this.metadata.length>0){let i=[];this.metadata.forEach(n=>{i.push(this.translate.get(n.text))}),(0,G.D)(i).subscribe(n=>{this.translatedTextArr=n,this.hasViewInit&&this.initChart()})}}initChart(){this.barChart&&this.metadata&&this.metadata.length>0&&(this.barChart.nativeElement.width="240",this.barChart.nativeElement.height=25+20*this.metadata.length+"",this.context=this.barChart.nativeElement.getContext("2d"),this.getMax(),this.context.fillStyle=this.isWhiteBackground?"#000":"#fff",this.drawLine(50,0,50,5+20*this.metadata.length),this.drawLine(50,5+20*this.metadata.length,250,5+20*this.metadata.length),this.drawLine(90,5+20*this.metadata.length,90,2+20*this.metadata.length),this.drawLine(130,5+20*this.metadata.length,130,2+20*this.metadata.length),this.drawLine(170,5+20*this.metadata.length,170,2+20*this.metadata.length),this.drawLine(210,5+20*this.metadata.length,210,2+20*this.metadata.length),this.context.font="12px",this.context.textAlign="center",this.context.fillText(this.scale.toString(),90,20*this.metadata.length+18,50),this.context.fillText((2*this.scale).toString(),130,20*this.metadata.length+18,50),this.context.fillText((3*this.scale).toString(),170,20*this.metadata.length+18,50),this.context.fillText((4*this.scale).toString(),210,20*this.metadata.length+18,50),this.metadata.forEach((i,n)=>{this.drawBar(n,i.color,i.value)}))}drawBar(i,n,o){this.context.textBaseline="middle",this.context.textAlign="left",this.context.fillStyle=n,this.context.fillRect(50,5+20*i,o/this.scale*40,15),this.context.fillText(o.toString(),o/this.scale*40+53,12+20*i,37),this.context.textAlign="right";let a="";a=this.translatedTextArr&&this.translatedTextArr.length>0?this.translatedTextArr[i]:this.metadata[i].text,this.context.fillText(a,47,12+20*i,47)}drawLine(i,n,o,a){this.context.beginPath(),this.context.moveTo(i,n),this.context.lineTo(o,a),this.context.strokeStyle=this.isWhiteBackground?"#000":"#fff",this.context.stroke(),this.context.closePath()}getMax(){let i=1;this.metadata&&this.metadata.length>0&&this.metadata.forEach(n=>{n.value>i&&(i=n.value)}),this.max=i,this.scale=10*Math.ceil(i/40)}}return t.\u0275fac=function(i){return new(i||t)(e.Y36(b.sK))},t.\u0275cmp=e.Xpm({type:t,selectors:[["histogram-chart"]],viewQuery:function(i,n){if(1&i&&e.Gf(nn,5),2&i){let o;e.iGM(o=e.CRH())&&(n.barChart=o.first)}},inputs:{metadata:"metadata",isWhiteBackground:"isWhiteBackground"},decls:3,vars:0,consts:[[1,"canvas"],["barChart",""]],template:function(i,n){1&i&&(e.TgZ(0,"canvas",0,1),e._uU(2," HTML5 canvas not supported "),e.qZA())},changeDetection:0}),t})();function on(t,r){if(1&t&&(e.TgZ(0,"clr-tooltip-content",11)(1,"span",12),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"span",13),e._uU(5),e.qZA()()),2&t){const i=e.oxw(2);e.Q6J("clrPosition","left")("clrSize","md"),e.xp6(2),e.Oqu(e.lcZ(3,4,"SCANNER.VULNERABILITY_SEVERITY")),e.xp6(3),e.Oqu(i.tipTitle)}}function an(t,r){if(1&t&&(e.TgZ(0,"clr-tooltip")(1,"div",7)(2,"div",8)(3,"div",9),e._uU(4),e.ALo(5,"slice"),e.qZA()()(),e.YNc(6,on,6,6,"clr-tooltip-content",10),e.qZA()),2&t){const i=e.oxw();e.xp6(2),e.Q6J("className",i.getClass()),e.xp6(2),e.hij(" ",e.Dn7(5,2,null==i.vulnerabilitySummary?null:i.vulnerabilitySummary.severity,0,1)," ")}}function ln(t,r){if(1&t&&(e.TgZ(0,"div",14),e._UZ(1,"div",15),e.TgZ(2,"span",16),e._uU(3),e.qZA(),e.TgZ(4,"span",17),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"div",15),e._uU(8,"-"),e.qZA(),e.TgZ(9,"span",18),e._uU(10),e.qZA(),e.TgZ(11,"span",19),e._uU(12),e.ALo(13,"translate"),e.qZA()()),2&t){const i=e.oxw();e.xp6(3),e.Oqu(i.total),e.xp6(2),e.Oqu(e.lcZ(6,4,"SCANNER.TOTAL")),e.xp6(5),e.Oqu(i.fixableCount),e.xp6(2),e.Oqu(e.lcZ(13,6,"SCANNER.FIXABLE"))}}function cn(t,r){1&t&&(e.TgZ(0,"div",20),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"VULNERABILITY.NO_VULNERABILITY")," "))}const sn=function(t,r){return{"is-white":t,"is-dark":r}};function pn(t,r){if(1&t&&(e.TgZ(0,"div",27)(1,"div",8)(2,"div",28),e._uU(3),e.ALo(4,"slice"),e.qZA()()()),2&t){const i=e.oxw(2);e.xp6(1),e.Q6J("className",i.getClass()),e.xp6(1),e.Q6J("ngClass",e.WLB(7,sn,!i.isThemeLight(),i.isThemeLight())),e.xp6(1),e.hij(" ",e.Dn7(4,3,null==i.vulnerabilitySummary?null:i.vulnerabilitySummary.severity,0,1)," ")}}function un(t,r){1&t&&(e.ynx(0),e.TgZ(1,"span"),e._uU(2),e.ALo(3,"translate"),e.TgZ(4,"span",12),e._uU(5),e.ALo(6,"titlecase"),e.ALo(7,"translate"),e.qZA()(),e.BQk()),2&t&&(e.xp6(2),e.hij("",e.lcZ(3,2,"VULNERABILITY.OVERALL_SEVERITY")," "),e.xp6(3),e.Oqu(e.lcZ(6,4,e.lcZ(7,6,"VULNERABILITY.SEVERITY.CRITICAL"))))}function gn(t,r){1&t&&(e.ynx(0),e.TgZ(1,"span"),e._uU(2),e.ALo(3,"translate"),e.TgZ(4,"span",12),e._uU(5),e.ALo(6,"titlecase"),e.ALo(7,"translate"),e.qZA()(),e.BQk()),2&t&&(e.xp6(2),e.hij("",e.lcZ(3,2,"VULNERABILITY.OVERALL_SEVERITY")," "),e.xp6(3),e.Oqu(e.lcZ(6,4,e.lcZ(7,6,"VULNERABILITY.SEVERITY.HIGH"))))}function fn(t,r){1&t&&(e.ynx(0),e.TgZ(1,"span"),e._uU(2),e.ALo(3,"translate"),e.TgZ(4,"span",12),e._uU(5),e.ALo(6,"titlecase"),e.ALo(7,"translate"),e.qZA()(),e.BQk()),2&t&&(e.xp6(2),e.hij("",e.lcZ(3,2,"VULNERABILITY.OVERALL_SEVERITY")," "),e.xp6(3),e.Oqu(e.lcZ(6,4,e.lcZ(7,6,"VULNERABILITY.SEVERITY.MEDIUM"))))}function hn(t,r){1&t&&(e.ynx(0),e.TgZ(1,"span"),e._uU(2),e.ALo(3,"translate"),e.TgZ(4,"span",12),e._uU(5),e.ALo(6,"titlecase"),e.ALo(7,"translate"),e.qZA()(),e.BQk()),2&t&&(e.xp6(2),e.hij("",e.lcZ(3,2,"VULNERABILITY.OVERALL_SEVERITY")," "),e.xp6(3),e.Oqu(e.lcZ(6,4,e.lcZ(7,6,"VULNERABILITY.SEVERITY.LOW"))))}function dn(t,r){1&t&&(e.ynx(0),e.TgZ(1,"span"),e._uU(2),e.ALo(3,"translate"),e.TgZ(4,"span",12),e._uU(5),e.ALo(6,"titlecase"),e.ALo(7,"translate"),e.qZA()(),e.BQk()),2&t&&(e.xp6(2),e.hij("",e.lcZ(3,2,"VULNERABILITY.OVERALL_SEVERITY")," "),e.xp6(3),e.Oqu(e.lcZ(6,4,e.lcZ(7,6,"VULNERABILITY.SEVERITY.NONE"))))}function mn(t,r){1&t&&(e.ynx(0),e._UZ(1,"clr-icon",29),e.TgZ(2,"span"),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.BQk()),2&t&&(e.xp6(3),e.Oqu(e.lcZ(4,1,"VULNERABILITY.NO_VULNERABILITY")))}function _n(t,r){if(1&t&&(e.TgZ(0,"div",30),e._UZ(1,"histogram-chart",31),e.qZA()),2&t){const i=e.oxw(2);e.xp6(1),e.Q6J("isWhiteBackground",!i.isThemeLight())("metadata",i.passMetadataToChart())}}function An(t,r){if(1&t&&(e.TgZ(0,"div")(1,"span",25),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"span",26),e._uU(5),e.qZA()()),2&t){const i=e.oxw(2);e.xp6(2),e.Oqu(e.lcZ(3,2,"SCANNER.SCANNED_BY")),e.xp6(3),e.Oqu(i.getScannerInfo())}}function Tn(t,r){if(1&t&&(e.TgZ(0,"clr-tooltip-content",21)(1,"div",22),e.YNc(2,pn,5,10,"div",23),e.YNc(3,un,8,8,"ng-container",1),e.YNc(4,gn,8,8,"ng-container",1),e.YNc(5,fn,8,8,"ng-container",1),e.YNc(6,hn,8,8,"ng-container",1),e.YNc(7,dn,8,8,"ng-container",1),e.YNc(8,mn,5,3,"ng-container",1),e.qZA(),e._UZ(9,"hr"),e.YNc(10,_n,2,2,"div",24),e.YNc(11,An,6,4,"div",1),e.TgZ(12,"div")(13,"span",25),e._uU(14),e.ALo(15,"translate"),e.qZA(),e.TgZ(16,"span",26),e._uU(17),e.qZA()(),e.TgZ(18,"div")(19,"span",25),e._uU(20),e.ALo(21,"translate"),e.qZA(),e.TgZ(22,"span"),e._uU(23),e.ALo(24,"harborDatetime"),e.qZA()()()),2&t){const i=e.oxw();e.Q6J("clrPosition","right")("clrSize","lg"),e.xp6(2),e.Q6J("ngIf",!i.noVulnerability),e.xp6(1),e.Q6J("ngIf",i.isCritical),e.xp6(1),e.Q6J("ngIf",i.isHigh),e.xp6(1),e.Q6J("ngIf",i.isMedium),e.xp6(1),e.Q6J("ngIf",i.isLow),e.xp6(1),e.Q6J("ngIf",i.isNone),e.xp6(1),e.Q6J("ngIf",i.noVulnerability),e.xp6(2),e.Q6J("ngIf",!i.noVulnerability),e.xp6(1),e.Q6J("ngIf",i.scanner),e.xp6(3),e.Oqu(e.lcZ(15,15,"SCANNER.DURATION")),e.xp6(3),e.Oqu(i.duration()),e.xp6(3),e.hij("",e.lcZ(21,17,"VULNERABILITY.CHART.SCANNING_TIME")," "),e.xp6(3),e.Oqu(e.xi3(24,19,i.completeTimestamp,"short"))}}function bn(t,r){if(1&t&&(e.TgZ(0,"clr-tooltip-content",35)(1,"div",12)(2,"span",25),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"span"),e._uU(6),e.qZA()(),e.TgZ(7,"div")(8,"span"),e._uU(9),e.ALo(10,"translate"),e.qZA()()()),2&t){const i=e.oxw(2);e.Q6J("clrSize","lg"),e.xp6(3),e.hij("",e.lcZ(4,4,"VULNERABILITY.CHART.SCANNING_PERCENT")," "),e.xp6(3),e.Oqu(i.completePercent),e.xp6(3),e.Oqu(e.lcZ(10,6,"VULNERABILITY.CHART.SCANNING_PERCENT_EXPLAIN"))}}function xn(t,r){1&t&&(e.TgZ(0,"clr-tooltip",26)(1,"div",32),e._UZ(2,"clr-icon",33),e.qZA(),e.YNc(3,bn,11,8,"clr-tooltip-content",34),e.qZA())}let yn=(()=>{class t{constructor(i){this.translate=i,this._tipTitle="",this.vulnerabilitySummary={scan_status:u.Iy.NOT_SCANNED,severity:""}}ngOnInit(){let i="VULNERABILITY.SEVERITY.NONE";switch(this.vulnerabilitySummary.severity){case u.AT.CRITICAL:i="VULNERABILITY.SEVERITY.CRITICAL";break;case u.AT.HIGH:i="VULNERABILITY.SEVERITY.HIGH";break;case u.AT.MEDIUM:i="VULNERABILITY.SEVERITY.MEDIUM";break;case u.AT.LOW:i="VULNERABILITY.SEVERITY.LOW"}this.translate.get(i).subscribe(n=>{this._tipTitle=n})}get tipTitle(){return this._tipTitle}get total(){return this.vulnerabilitySummary&&this.vulnerabilitySummary.summary&&this.vulnerabilitySummary.summary.total?this.vulnerabilitySummary.summary.total:0}get fixableCount(){return this.vulnerabilitySummary&&this.vulnerabilitySummary.summary&&this.vulnerabilitySummary.summary.fixable?this.vulnerabilitySummary.summary.fixable:0}get sevSummary(){return this.vulnerabilitySummary&&this.vulnerabilitySummary.summary?this.vulnerabilitySummary.summary.summary:null}get criticalCount(){return this.sevSummary?this.sevSummary[u.AT.CRITICAL]:0}duration(){if(this.vulnerabilitySummary&&this.vulnerabilitySummary.duration){let i="";const n=Math.floor(this.vulnerabilitySummary.duration/60);n&&(i+=n+" min ");const o=this.vulnerabilitySummary.duration%60;return o&&(i+=o+" sec"),i}return"0"}get highCount(){return this.sevSummary?this.sevSummary[u.AT.HIGH]:0}get mediumCount(){return this.sevSummary?this.sevSummary[u.AT.MEDIUM]:0}get lowCount(){return this.sevSummary?this.sevSummary[u.AT.LOW]:0}get noneCount(){return this.vulnerabilitySummary&&this.vulnerabilitySummary.summary&&this.vulnerabilitySummary.summary.summary?this.vulnerabilitySummary.summary.summary[u.AT.NONE]:0}get completePercent(){return this.vulnerabilitySummary?`${this.vulnerabilitySummary.complete_percent}%`:"0%"}isLimitedSuccess(){return this.vulnerabilitySummary&&this.vulnerabilitySummary.complete_percent<100}get completeTimestamp(){return this.vulnerabilitySummary&&this.vulnerabilitySummary.end_time?this.vulnerabilitySummary.end_time:new Date}get isCritical(){return this.vulnerabilitySummary&&u.AT.CRITICAL===this.vulnerabilitySummary.severity}get isHigh(){return this.vulnerabilitySummary&&u.AT.HIGH===this.vulnerabilitySummary.severity}get isMedium(){return this.vulnerabilitySummary&&u.AT.MEDIUM===this.vulnerabilitySummary.severity}get isLow(){return this.vulnerabilitySummary&&u.AT.LOW===this.vulnerabilitySummary.severity}get isNone(){return this.vulnerabilitySummary&&u.AT.NONE===this.vulnerabilitySummary.severity&&this.total>0}get noVulnerability(){return 0===this.total}getClass(){if(this.vulnerabilitySummary&&this.vulnerabilitySummary.severity){if(this.isCritical)return"level-critical";if(this.isHigh)return"level-high";if(this.isMedium)return"level-medium";if(this.isLow)return"level-low";if(this.isNone)return"level-none"}return null}passMetadataToChart(){return[{text:"VULNERABILITY.SEVERITY.CRITICAL",value:this.criticalCount?this.criticalCount:0,color:"red"},{text:"VULNERABILITY.SEVERITY.HIGH",value:this.highCount?this.highCount:0,color:"#e64524"},{text:"VULNERABILITY.SEVERITY.MEDIUM",value:this.mediumCount?this.mediumCount:0,color:"orange"},{text:"VULNERABILITY.SEVERITY.LOW",value:this.lowCount?this.lowCount:0,color:"#007CBB"},{text:"VULNERABILITY.SEVERITY.NONE",value:this.noneCount?this.noneCount:0,color:"grey"}]}isThemeLight(){return localStorage.getItem(ht.BJ)===ht.XO.LIGHT}getScannerInfo(){if(this.scanner){if(this.scanner.name&&this.scanner.version)return`${this.scanner.name}@${this.scanner.version}`;if(this.scanner.name&&!this.scanner.version)return`${this.scanner.name}`}return""}}return t.\u0275fac=function(i){return new(i||t)(e.Y36(b.sK))},t.\u0275cmp=e.Xpm({type:t,selectors:[["hbr-result-tip-histogram"]],inputs:{scanner:"scanner",vulnerabilitySummary:"vulnerabilitySummary"},decls:8,vars:4,consts:[[1,"tip-wrapper","width-215"],[4,"ngIf"],["clrTooltipTrigger","",1,"tip-block"],["class","circle-block",4,"ngIf"],["class","pl-1 margin-left-5 tip-wrapper bar-block-none shadow-none width-150",4,"ngIf"],["class","w-800",3,"clrPosition","clrSize",4,"clrIfOpen"],["class","margin-left-5",4,"ngIf"],["clrTooltipTrigger","",1,"level-border"],[3,"className"],[1,"inner"],[3,"clrPosition","clrSize",4,"clrIfOpen"],[3,"clrPosition","clrSize"],[1,"font-weight-600"],[1,"font-weight-600","margin-left-5"],[1,"circle-block"],[1,"black-point-container","margin-left-10"],[1,"margin-left-10","font-weight-800","font-size-14"],[1,"margin-left-5","font-size-14"],[1,"margin-left-10","font-weight-800","font-size-12"],[1,"margin-left-5","font-size-12"],[1,"pl-1","margin-left-5","tip-wrapper","bar-block-none","shadow-none","width-150"],[1,"w-800",3,"clrPosition","clrSize"],[1,"bar-tooltip-font-larger"],["class","level-border clr-display-inline-block margin-right-5",4,"ngIf"],["class","bar-summary bar-tooltip-fon",4,"ngIf"],[1,"bar-scanning-time"],[1,"margin-left-5"],[1,"level-border","clr-display-inline-block","margin-right-5"],[1,"inner",3,"ngClass"],["shape","check-circle","size","32",1,"is-success"],[1,"bar-summary","bar-tooltip-fon"],[3,"isWhiteBackground","metadata"],["clrTooltipTrigger",""],["shape","exclamation-triangle","size","20",1,"is-warning"],[3,"clrSize",4,"clrIfOpen"],[3,"clrSize"]],template:function(i,n){1&i&&(e.TgZ(0,"div",0),e.YNc(1,an,7,6,"clr-tooltip",1),e.TgZ(2,"clr-tooltip")(3,"div",2),e.YNc(4,ln,14,8,"div",3),e.YNc(5,cn,3,3,"div",4),e.qZA(),e.YNc(6,Tn,25,22,"clr-tooltip-content",5),e.qZA(),e.YNc(7,xn,4,0,"clr-tooltip",6),e.qZA()),2&i&&(e.xp6(1),e.Q6J("ngIf",!n.noVulnerability),e.xp6(3),e.Q6J("ngIf",!n.noVulnerability),e.xp6(1),e.Q6J("ngIf",n.noVulnerability),e.xp6(2),e.Q6J("ngIf",n.isLimitedSuccess()))},dependencies:[s.qvL,s.nqY,s.Jmj,s.bMv,s.zDF,A.mk,A.O5,rn,b.X$,A.OU,A.rS,ue.Z],styles:[".bar-wrapper[_ngcontent-%COMP%]{width:144px;height:12px}.bar-state[_ngcontent-%COMP%]{text-align:center}.bar-state[_ngcontent-%COMP%]   .unknow-text[_ngcontent-%COMP%]{margin-left:-5px}.bar-state-chart[_ngcontent-%COMP%]{margin-top:2px}.bar-state-chart[_ngcontent-%COMP%]   .loop-height[_ngcontent-%COMP%]{height:2px}.bar-state-error[_ngcontent-%COMP%]{position:relative;top:-4px}.error-text[_ngcontent-%COMP%]{position:relative;top:1px;margin-left:-5px;cursor:pointer}.scanning-button[_ngcontent-%COMP%]{height:24px;margin-top:0;margin-bottom:0;vertical-align:middle;top:-12px;position:relative}.tip-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;color:#fff;text-align:center;font-size:10px;height:15px;line-height:15px}.bar-block-critical[_ngcontent-%COMP%]{background-color:red}.bar-block-high[_ngcontent-%COMP%]{background-color:#e64524}.bar-block-medium[_ngcontent-%COMP%]{background-color:orange}.bar-block-low[_ngcontent-%COMP%]{background-color:#007cbb}.bar-block-none[_ngcontent-%COMP%]{background-color:green}.bar-block-unknown[_ngcontent-%COMP%]{background-color:gray}.bar-tooltip-font[_ngcontent-%COMP%]{font-size:13px;color:#fff}.bar-tooltip-font-title[_ngcontent-%COMP%]{font-weight:600}.bar-summary[_ngcontent-%COMP%]{margin-top:12px;text-align:left}.bar-scanning-time[_ngcontent-%COMP%]{margin-top:12px}.bar-summary-item[_ngcontent-%COMP%]{margin-top:3px;margin-bottom:3px}.bar-summary-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(1){width:26px;text-align:center;display:inline-block}.bar-summary-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(2){width:28px;display:inline-block}.option-right[_ngcontent-%COMP%]{padding-right:16px}.refresh-btn[_ngcontent-%COMP%]{cursor:pointer}.refresh-btn[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:hover{color:#007cbb}.label.label-medium[_ngcontent-%COMP%]{background-color:#ffe4a9;border:1px solid orange;color:orange}.tip-icon-medium[_ngcontent-%COMP%]{color:orange}.label.label-low[_ngcontent-%COMP%]{background:rgba(251,255,0,.38);color:#c5c50b;border:1px solid #e6e63f}.tip-icon-low[_ngcontent-%COMP%]{color:#007cbb}.font-color-green[_ngcontent-%COMP%]{color:green}.bar-tooltip-font-larger[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:16px;vertical-align:middle}hr[_ngcontent-%COMP%]{border-bottom:0;border-color:#aaa;margin:6px -10px}.font-weight-600[_ngcontent-%COMP%]{font-weight:600}.result-row[_ngcontent-%COMP%]{position:relative}.help-icon[_ngcontent-%COMP%], .ml-3px[_ngcontent-%COMP%]{margin-left:3px}.shadow-critical[_ngcontent-%COMP%]{box-shadow:1px -1px 1px red}.shadow-high[_ngcontent-%COMP%]{box-shadow:1px -1px 1px #e64524}.shadow-medium[_ngcontent-%COMP%]{box-shadow:1px -1px 1px orange}.shadow-low[_ngcontent-%COMP%]{box-shadow:1px -1px 1px #007cbb}.shadow-none[_ngcontent-%COMP%]{box-shadow:1px -1px 1px green}.shadow-unknown[_ngcontent-%COMP%]{box-shadow:1px -1px 1px gray}.w-360[_ngcontent-%COMP%]{width:360px!important}.margin-left-5[_ngcontent-%COMP%]{margin-left:5px}.margin-left-10[_ngcontent-%COMP%]{margin-left:10px}.width-30[_ngcontent-%COMP%]{width:26px}.width-215[_ngcontent-%COMP%]{width:215px}.width-150[_ngcontent-%COMP%]{width:150px}.level-border[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-items:center;border-radius:50%;height:26px;width:26px;line-height:26px}.inner[_ngcontent-%COMP%]{margin:auto;height:18px;width:18px;line-height:18px;font-size:12px;font-weight:600;border-radius:50%;text-align:center}.level-critical[_ngcontent-%COMP%]{background:red;color:red}.level-high[_ngcontent-%COMP%]{background:#e64524;color:#e64524}.level-medium[_ngcontent-%COMP%]{background-color:orange;color:orange}.level-low[_ngcontent-%COMP%]{background:#007CBB;color:#007cbb}.level-none[_ngcontent-%COMP%]{background-color:gray;color:gray}.black-point-container[_ngcontent-%COMP%]{display:inline-block;position:relative;height:6px}.black-point[_ngcontent-%COMP%]{position:absolute;width:4px;height:4px;border-radius:50%}.font-weight-800[_ngcontent-%COMP%]{font-weight:800}.color-green[_ngcontent-%COMP%]{color:green}.tip-block[_ngcontent-%COMP%]{position:relative}.font-size-14[_ngcontent-%COMP%]{font-size:14px}.font-size-12[_ngcontent-%COMP%]{font-size:12px}.margin-right-5[_ngcontent-%COMP%]{margin-right:5px}.is-white[_ngcontent-%COMP%]{background-color:#fff}.is-dark[_ngcontent-%COMP%]{background-color:#000}"]}),t})();function Sn(t,r){1&t&&(e.TgZ(0,"div",4)(1,"span",5),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&t&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"VULNERABILITY.STATE.QUEUED")))}function On(t,r){if(1&t&&(e.TgZ(0,"div",6)(1,"a",7),e._UZ(2,"clr-icon",8),e._uU(3),e.ALo(4,"translate"),e.qZA()()),2&t){const i=e.oxw();e.xp6(1),e.Q6J("href",i.viewLog(),e.LSH),e.xp6(2),e.hij(" ",e.lcZ(4,2,"VULNERABILITY.STATE.ERROR")," ")}}function Ln(t,r){1&t&&(e.TgZ(0,"div",9)(1,"div"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",10),e._UZ(5,"progress"),e.qZA()()),2&t&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"VULNERABILITY.STATE.SCANNING")))}function wn(t,r){if(1&t&&(e.TgZ(0,"div",9),e._UZ(1,"hbr-result-tip-histogram",11),e.qZA()),2&t){const i=e.oxw();e.xp6(1),e.Q6J("scanner",i.getScanner())("vulnerabilitySummary",i.summary)}}function Nn(t,r){1&t&&(e.TgZ(0,"div",4)(1,"span",12),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&t&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"VULNERABILITY.STATE.STOPPED")))}function Zn(t,r){1&t&&(e.TgZ(0,"div",4)(1,"span",13),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&t&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"VULNERABILITY.STATE.OTHER_STATUS")))}const de=3e3;let Be=(()=>{class t{constructor(i,n,o,a){this.artifactService=i,this.scanService=n,this.errorHandler=o,this.eventService=a,this.repoName="",this.projectName="",this.artifactDigest="",this.onSubmitting=!1,this.onStopping=!1,this.retryCounter=0,this.submitFinish=new e.vpe,this.submitStopFinish=new e.vpe,this.scanFinished=new e.vpe}ngOnInit(){(this.status===u.Iy.RUNNING||this.status===u.Iy.PENDING)&&!this.stateCheckTimer&&(this.stateCheckTimer=(0,je.H)(0,de).subscribe(()=>{this.getSummary()})),this.scanSubscription||(this.scanSubscription=this.eventService.subscribe(B.n.START_SCAN_ARTIFACT,i=>{this.repoName+"/"+this.artifactDigest===i&&this.scanNow()})),this.stopSubscription||(this.stopSubscription=this.eventService.subscribe(B.n.STOP_SCAN_ARTIFACT,i=>{this.repoName+"/"+this.artifactDigest===i&&this.stopScan()}))}ngOnDestroy(){this.stateCheckTimer&&(this.stateCheckTimer.unsubscribe(),this.stateCheckTimer=null),this.scanSubscription&&(this.scanSubscription.unsubscribe(),this.scanSubscription=null),this.stopSubscription||(this.stopSubscription.unsubscribe(),this.stopSubscription=null)}get status(){return this.summary&&this.summary.scan_status?this.summary.scan_status:u.Iy.NOT_SCANNED}get completed(){return this.status===u.Iy.SUCCESS}get error(){return this.status===u.Iy.ERROR}get queued(){return this.status===u.Iy.PENDING}get scanning(){return this.status===u.Iy.RUNNING}get stopped(){return this.status===u.Iy.STOPPED}get otherStatus(){return!(this.completed||this.error||this.queued||this.scanning||this.stopped)}scanNow(){this.onSubmitting?console.error("duplicated submit"):this.repoName&&this.artifactDigest?(this.onSubmitting=!0,this.scanService.scanArtifact({projectName:this.projectName,reference:this.artifactDigest,repositoryName:(0,u.gI)(this.repoName)}).pipe((0,L.x)(()=>this.submitFinish.emit(!1))).subscribe(()=>{this.onSubmitting=!1,this.summary={scan_status:u.Iy.PENDING},this.stateCheckTimer||(this.stateCheckTimer=(0,je.H)(de,de).subscribe(()=>{this.getSummary()}))},i=>{this.onSubmitting=!1,i&&i.error&&409===i.error.code?console.error(i.error.message):this.errorHandler.error(i)})):console.error("bad repository or tag")}getSummary(){!this.repoName||!this.artifactDigest||this.artifactService.getArtifact({projectName:this.projectName,repositoryName:(0,u.gI)(this.repoName),reference:this.artifactDigest,withScanOverview:!0,XAcceptVulnerabilities:u.eB}).subscribe(i=>{i.scan_overview&&this.copyValue(Object.values(i.scan_overview)[0]),!this.queued&&!this.scanning&&(this.stateCheckTimer&&(this.stateCheckTimer.unsubscribe(),this.stateCheckTimer=null),this.scanFinished.emit(i)),this.eventService.publish(B.n.UPDATE_VULNERABILITY_INFO,i)},i=>{this.errorHandler.error(i),this.retryCounter++,this.retryCounter>=3&&(this.stateCheckTimer&&(this.stateCheckTimer.unsubscribe(),this.stateCheckTimer=null),this.retryCounter=0)})}copyValue(i){!this.summary||!i||!i.scan_status||(this.summary=(0,u.d9)(i))}viewLog(){return`${u.S$}/projects/${this.projectName}/repositories/${(0,u.gI)(this.repoName)}/artifacts/${this.artifactDigest}/scan/${this.summary.report_id}/log`}getScanner(){return this.summary&&this.summary.scanner?this.summary.scanner:this.inputScanner}stopScan(){this.onStopping?console.error("duplicated stopping command"):this.repoName&&this.artifactDigest?(this.onStopping=!0,this.scanService.stopScanArtifact({projectName:this.projectName,reference:this.artifactDigest,repositoryName:(0,u.gI)(this.repoName)}).pipe((0,L.x)(()=>{this.submitStopFinish.emit(!1),this.onStopping=!1})).subscribe(()=>{this.stateCheckTimer||(this.stateCheckTimer=(0,je.H)(de,de).subscribe(()=>{this.getSummary()})),this.errorHandler.info("VULNERABILITY.TRIGGER_STOP_SUCCESS")},i=>{this.errorHandler.error(i)})):console.error("bad repository or artifact")}}return t.\u0275fac=function(i){return new(i||t)(e.Y36(ee.b),e.Y36(tn.I),e.Y36(R.q),e.Y36(B.P))},t.\u0275cmp=e.Xpm({type:t,selectors:[["hbr-vulnerability-bar"]],inputs:{inputScanner:"inputScanner",repoName:"repoName",projectName:"projectName",artifactDigest:"artifactDigest",summary:"summary"},outputs:{submitFinish:"submitFinish",submitStopFinish:"submitStopFinish",scanFinished:"scanFinished"},decls:7,vars:6,consts:[[1,"bar-wrapper"],["class","bar-state",4,"ngIf"],["class","bar-state bar-state-error",4,"ngIf"],["class","bar-state bar-state-chart",4,"ngIf"],[1,"bar-state"],[1,"label","label-orange"],[1,"bar-state","bar-state-error"],["rel","noopener noreferrer","target","_blank",1,"error-text",3,"href"],["shape","error","size","24",1,"is-error"],[1,"bar-state","bar-state-chart"],[1,"progress","loop","loop-height"],[3,"scanner","vulnerabilitySummary"],[1,"label","stopped"],[1,"label","not-scan"]],template:function(i,n){1&i&&(e.TgZ(0,"div",0),e.YNc(1,Sn,4,3,"div",1),e.YNc(2,On,5,4,"div",2),e.YNc(3,Ln,6,3,"div",3),e.YNc(4,wn,2,2,"div",3),e.YNc(5,Nn,4,3,"div",1),e.YNc(6,Zn,4,3,"div",1),e.qZA()),2&i&&(e.xp6(1),e.Q6J("ngIf",n.queued),e.xp6(1),e.Q6J("ngIf",n.error),e.xp6(1),e.Q6J("ngIf",n.scanning),e.xp6(1),e.Q6J("ngIf",n.completed),e.xp6(1),e.Q6J("ngIf",n.stopped),e.xp6(1),e.Q6J("ngIf",n.otherStatus))},dependencies:[s.qvL,A.O5,yn,b.X$],styles:[".bar-wrapper[_ngcontent-%COMP%]{width:210px}.bar-state[_ngcontent-%COMP%]   .unknow-text[_ngcontent-%COMP%]{margin-left:-5px}.bar-state[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{width:90%}.bar-state-chart[_ngcontent-%COMP%]   .loop-height[_ngcontent-%COMP%]{height:2px}.bar-state-error[_ngcontent-%COMP%]{position:relative}.error-text[_ngcontent-%COMP%]{position:relative;top:1px;margin-left:-5px;cursor:pointer}.scanning-button[_ngcontent-%COMP%]{height:24px;margin-top:0;margin-bottom:0;vertical-align:middle;top:-12px;position:relative}.tip-wrapper[_ngcontent-%COMP%]{display:inline-block;height:10px;max-width:120px}.bar-block-high[_ngcontent-%COMP%]{background-color:#e64524}.bar-block-medium[_ngcontent-%COMP%]{background-color:orange}.bar-block-low[_ngcontent-%COMP%]{background-color:#ff0}.bar-block-none[_ngcontent-%COMP%]{background-color:green}.bar-block-unknown[_ngcontent-%COMP%]{background-color:gray}.bar-tooltip-font[_ngcontent-%COMP%]{font-size:13px;color:#fff}.bar-tooltip-font-title[_ngcontent-%COMP%]{font-weight:600}.bar-summary[_ngcontent-%COMP%]{margin-top:12px;text-align:left}.bar-scanning-time[_ngcontent-%COMP%]{margin-top:12px}.bar-summary-item[_ngcontent-%COMP%]{margin-top:3px;margin-bottom:3px}.bar-summary-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(1){width:30px;text-align:center;display:inline-block}.bar-summary-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(2){width:28px;display:inline-block}.option-right[_ngcontent-%COMP%]{padding-right:16px}.refresh-btn[_ngcontent-%COMP%]{cursor:pointer}.refresh-btn[_ngcontent-%COMP%]:hover{color:#007cbb}.tip-icon-medium[_ngcontent-%COMP%]{color:orange}.tip-icon-low[_ngcontent-%COMP%]{color:#ff0}.font-color-green[_ngcontent-%COMP%]{color:green}.bar-tooltip-font-larger[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:16px;vertical-align:middle}hr[_ngcontent-%COMP%]{border-bottom:0;border-color:#aaa;margin:6px -10px}.font-weight-600[_ngcontent-%COMP%]{font-weight:600}.rightPos[_ngcontent-%COMP%]{position:absolute;z-index:100;right:35px;margin-top:4px}.result-row[_ngcontent-%COMP%]{position:relative}.help-icon[_ngcontent-%COMP%]{margin-left:3px}.mt-3px[_ngcontent-%COMP%]{margin-top:5px}.label-critical[_ngcontent-%COMP%]{background:red;color:#621501}.label-danger[_ngcontent-%COMP%]{background:#e64524!important;color:#621501!important}.label-medium[_ngcontent-%COMP%]{background-color:orange;color:#621501}.label-low[_ngcontent-%COMP%]{background:#007CBB;color:#cab6b1}.label-none[_ngcontent-%COMP%]{background-color:gray;color:#bad7ba}.no-border[_ngcontent-%COMP%]{border:none}hbr-vulnerability-bar[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%], hbr-vulnerability-bar[_ngcontent-%COMP%]   .not-scan[_ngcontent-%COMP%]{width:90%}.stopped[_ngcontent-%COMP%]{border-color:#cccc15}"]}),t})();const Pn=["filterArea"];function Rn(t,r){if(1&t){const i=e.EpF();e.TgZ(0,"clr-icon",5),e.NdJ("click",function(){e.CHM(i);const o=e.oxw();return o.opened=!0,e.KtG(o.dropdownOpened=!0)}),e.qZA()}if(2&t){const i=e.oxw();e.s9C("id",i.searchId)}}function Mn(t,r){if(1&t&&(e.TgZ(0,"option",15),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t){const i=r.$implicit;e.s9C("value",i.filterBy),e.xp6(1),e.hij(" ",e.lcZ(2,2,i.filterByShowText)," ")}}function kn(t,r){if(1&t){const i=e.EpF();e.TgZ(0,"div",16)(1,"div",17)(2,"input",18),e.NdJ("ngModelChange",function(o){e.CHM(i);const a=e.oxw(2);return e.KtG(a.inputTag=o)})("keyup",function(){e.CHM(i);const o=e.oxw(2);return e.KtG(o.searchByInputTag())}),e.ALo(3,"translate"),e.qZA()()()}if(2&t){const i=e.oxw(2);e.xp6(2),e.s9C("placeholder",e.lcZ(3,3,"ARTIFACT.FILTER_FOR_ARTIFACTS")),e.Q6J("readonly","tags"!==i.filterByType)("ngModel",i.inputTag)}}function Dn(t,r){if(1&t&&(e.TgZ(0,"span"),e._UZ(1,"hbr-label-piece",19),e.qZA()),2&t){const i=e.oxw(3);e.xp6(1),e.Q6J("label",i.selectedValue)}}function Un(t,r){if(1&t&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&t){const i=e.oxw(3);e.xp6(1),e.Oqu(i.selectedValue)}}function Yn(t,r){if(1&t&&(e.TgZ(0,"span"),e.YNc(1,Dn,2,1,"span",3),e.YNc(2,Un,2,1,"span",3),e.qZA()),2&t){const i=e.oxw(2);e.xp6(1),e.Q6J("ngIf","labels"===i.filterByType),e.xp6(1),e.Q6J("ngIf","labels"!==i.filterByType)}}function qn(t,r){if(1&t){const i=e.EpF();e.TgZ(0,"div",21),e.NdJ("click",function(){const a=e.CHM(i).$implicit,l=e.oxw(3);return e.KtG(l.selectValue(a))}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&t){const i=r.$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,1,i.showItem)," ")}}function Fn(t,r){if(1&t&&(e.ynx(0),e.YNc(1,qn,3,3,"div",20),e.BQk()),2&t){const i=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",i.multipleFilter[0].listItem)}}function jn(t,r){if(1&t){const i=e.EpF();e.TgZ(0,"div",21),e.NdJ("click",function(){const a=e.CHM(i).$implicit,l=e.oxw(3);return e.KtG(l.selectValue(a))}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&t){const i=r.$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,1,i.showItem)," ")}}function Bn(t,r){if(1&t&&(e.ynx(0),e.YNc(1,jn,3,3,"div",20),e.BQk()),2&t){const i=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",i.multipleFilter[1].listItem)}}function Jn(t,r){if(1&t){const i=e.EpF();e.ynx(0),e.TgZ(1,"label",22),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"app-label-selector",23),e.NdJ("clickLabel",function(o){e.CHM(i);const a=e.oxw(2);return e.KtG(a.selectValue(o))}),e.qZA(),e.BQk()}if(2&t){const i=e.oxw(2);e.xp6(2),e.Oqu(e.lcZ(3,5,"REPOSITORY.FILTER_ARTIFACT_BY_LABEL")),e.xp6(2),e.Q6J("scope","p")("projectId",i.projectId)("width",200)("ownedLabels",i.getSelectLabel())}}function Hn(t,r){if(1&t){const i=e.EpF();e.ynx(0),e.TgZ(1,"div",6)(2,"div",7)(3,"select",8),e.NdJ("ngModelChange",function(o){e.CHM(i);const a=e.oxw();return e.KtG(a.filterByType=o)})("change",function(){e.CHM(i);const o=e.oxw();return e.KtG(o.selectFilterType())}),e.YNc(4,Mn,3,4,"option",9),e.qZA()()(),e.TgZ(5,"div",10)(6,"div",11),e.NdJ("click",function(){e.CHM(i);const o=e.oxw();return e.KtG(o.dropdownOpened=!o.dropdownOpened)}),e.TgZ(7,"clr-icon",12),e.NdJ("click",function(){e.CHM(i);const o=e.oxw();return e.KtG(o.opened=!1)}),e.qZA(),e.YNc(8,kn,4,5,"div",13),e.YNc(9,Yn,3,2,"span",3),e.qZA(),e.TgZ(10,"div",14),e.YNc(11,Fn,2,1,"ng-container",3),e.YNc(12,Bn,2,1,"ng-container",3),e.YNc(13,Jn,5,7,"ng-container",3),e.qZA()(),e.BQk()}if(2&t){const i=e.oxw();e.xp6(3),e.s9C("id",i.typeSelectId),e.Q6J("ngModel",i.filterByType),e.xp6(1),e.Q6J("ngForOf",i.multipleFilter),e.xp6(1),e.ekj("open",i.dropdownOpened),e.xp6(3),e.Q6J("ngIf",!i.selectedValue),e.xp6(1),e.Q6J("ngIf",i.selectedValue),e.xp6(2),e.Q6J("ngIf",i.filterByType===i.multipleFilter[0].filterBy),e.xp6(1),e.Q6J("ngIf",i.filterByType===i.multipleFilter[1].filterBy),e.xp6(1),e.Q6J("ngIf",i.filterByType===i.multipleFilter[2].filterBy)}}function Qn(t,r){1&t&&e._UZ(0,"span",24)}let Vn=(()=>{class t{constructor(i){this.renderer=i,this.withDivider=!1,this.opened=!1,this.multipleFilter=at,this.filterByType=at[0].filterBy,this.dropdownOpened=!0,this.filterEvent=new e.vpe,this.searchId="search-btn",this.typeSelectId="type-select",this._keyupEventSubject=new te.x,this.renderer.listen("window","click",n=>{n.target.id===this.searchId||n.target.id===this.typeSelectId||this.filterArea.nativeElement.contains(n.target)||(this.dropdownOpened=!1)})}ngOnInit(){this._keyupEventSubscription||(this._keyupEventSubscription=this._keyupEventSubject.pipe((0,Se.b)(500)).subscribe(i=>{this.filterEvent.emit({type:this.filterByType,isLabel:!1,isInputTag:!0,stringValue:i})}))}ngOnDestroy(){this._keyupEventSubscription&&(this._keyupEventSubscription.unsubscribe(),this._keyupEventSubscription=null)}selectFilterType(){this.selectedValue=null,this.dropdownOpened=!0,this.filterEvent.emit(this.filterByType===this.multipleFilter[2].filterBy?{type:this.filterByType,isLabel:!0}:{type:this.filterByType,isLabel:!1})}selectValue(i){this.filterByType===this.multipleFilter[2].filterBy?(this.selectedValue=i.isAdd?i.label:null,this.filterEvent.emit({type:this.filterByType,isLabel:!0,label:this.selectedValue})):(this.selectedValue=i?.filterText,this.filterEvent.emit({type:this.filterByType,isLabel:!1,stringValue:this.selectedValue}))}getSelectLabel(){return this.filterByType===this.multipleFilter[2].filterBy&&this.selectedValue?[this.selectedValue]:[]}searchByInputTag(){this._keyupEventSubject.next(this.inputTag)}}return t.\u0275fac=function(i){return new(i||t)(e.Y36(e.Qsj))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-artifact-filter"]],viewQuery:function(i,n){if(1&i&&e.Gf(Pn,5),2&i){let o;e.iGM(o=e.CRH())&&(n.filterArea=o.first)}},inputs:{withDivider:"withDivider",projectId:"projectId"},outputs:{filterEvent:"filterEvent"},decls:5,vars:3,consts:[["id","filterArea",1,"clr-row"],["filterArea",""],["shape","search","size","20","class","search-btn",3,"id","click",4,"ngIf"],[4,"ngIf"],["class","filter-divider",4,"ngIf"],["shape","search","size","20",1,"search-btn",3,"id","click"],[1,"clr-control-container","m-r-10px"],[1,"clr-select-wrapper"],[1,"clr-select",3,"id","ngModel","ngModelChange","change"],[3,"value",4,"ngFor","ngForOf"],[1,"dropdown"],[1,"dropdown-toggle","border-bottom-color",3,"click"],["shape","search","size","20",1,"search-dropdown-toggle",3,"click"],["class","clr-control-container",4,"ngIf"],[1,"dropdown-menu"],[3,"value"],[1,"clr-control-container"],[1,"clr-input-wrapper"],[1,"clr-input","no-outline",3,"readonly","placeholder","ngModel","ngModelChange","keyup"],[3,"label"],["class","dropdown-item",3,"click",4,"ngFor","ngForOf"],[1,"dropdown-item",3,"click"],[1,"clr-control-label"],[3,"scope","projectId","width","ownedLabels","clickLabel"],[1,"filter-divider"]],template:function(i,n){1&i&&(e.TgZ(0,"div",0,1),e.YNc(2,Rn,1,1,"clr-icon",2),e.YNc(3,Hn,14,10,"ng-container",3),e.YNc(4,Qn,1,0,"span",4),e.qZA()),2&i&&(e.xp6(2),e.Q6J("ngIf",!n.opened),e.xp6(1),e.Q6J("ngIf",n.opened),e.xp6(1),e.Q6J("ngIf",n.withDivider))},dependencies:[x.YN,x.Kr,x.Fj,x.EJ,x.JJ,x.On,s.qvL,s.MgK,A.sg,A.O5,Fe.q,ft,b.X$],styles:[".search-btn[_ngcontent-%COMP%]{cursor:pointer}.dropdown-toggle[_ngcontent-%COMP%]{height:1.3rem;width:200px;display:flex;justify-content:left;border-bottom:.05rem solid}.clr-control-label[_ngcontent-%COMP%]{margin-bottom:1rem;margin-left:.5rem}.filter-divider[_ngcontent-%COMP%]{display:inline-block;height:24px;width:1px;margin-right:6px;margin-left:6px}.clr-row[_ngcontent-%COMP%]{align-items:center;margin:0}.m-r-10px[_ngcontent-%COMP%]{margin-right:10px}.search-dropdown-toggle[_ngcontent-%COMP%]{margin-right:5px}.no-outline[_ngcontent-%COMP%]:focus{border:none;background:none}"]}),t})();const Gn=["confirmationDialog"];function zn(t,r){if(1&t){const i=e.EpF();e.TgZ(0,"div",39),e.NdJ("click",function(){e.CHM(i);const o=e.oxw(3);return e.KtG(o.deleteArtifact())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&t){const i=e.oxw(3);e.Q6J("clrDisabled",!i.hasDeleteImagePermission||!i.selectedRow.length||i.depth),e.xp6(1),e.hij(" ",e.lcZ(2,2,"REPOSITORY.DELETE")," ")}}function $n(t,r){if(1&t){const i=e.EpF();e.TgZ(0,"clr-dropdown-menu",30)(1,"div",31),e.NdJ("click",function(){e.CHM(i);const o=e.oxw(2);return e.KtG(o.showDigestId())}),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"clr-dropdown")(5,"button",32),e._uU(6),e.ALo(7,"translate"),e.qZA(),e.TgZ(8,"clr-dropdown-menu",33)(9,"div",34)(10,"label",35),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.TgZ(13,"app-label-selector",36),e.NdJ("clickLabel",function(o){e.CHM(i);const a=e.oxw(2);return e.KtG(a.stickLabel(o))}),e.qZA()()()(),e.TgZ(14,"div",37),e.NdJ("click",function(){e.CHM(i);const o=e.oxw(2);return e.KtG(o.retag())}),e._uU(15),e.ALo(16,"translate"),e.qZA(),e.YNc(17,zn,3,4,"div",38),e.qZA()}if(2&t){const i=e.oxw(2);e.xp6(1),e.Q6J("clrDisabled",!(1===i.selectedRow.length&&!i.depth)),e.xp6(1),e.hij(" ",e.lcZ(3,13,"REPOSITORY.COPY_DIGEST_ID")," "),e.xp6(3),e.Q6J("disabled",!i.canAddLabel()||!i.hasAddLabelImagePermission||i.depth||i.inprogress),e.xp6(1),e.hij(" ",e.lcZ(7,15,"REPOSITORY.ADD_LABELS")," "),e.xp6(2),e.Q6J("hidden",!i.selectedRow.length),e.xp6(3),e.Oqu(e.lcZ(12,17,"REPOSITORY.ADD_LABEL_TO_IMAGE")),e.xp6(2),e.Q6J("width",200)("ownedLabels",null==i.selectedRow[0]?null:i.selectedRow[0].labels)("projectId",i.projectId)("scope","p"),e.xp6(1),e.Q6J("clrDisabled",1!==i.selectedRow.length||!i.hasRetagImagePermission||i.depth),e.xp6(1),e.hij(" ",e.lcZ(16,19,"REPOSITORY.RETAG")," "),e.xp6(2),e.Q6J("ngIf",i.hasDeleteImagePermission)}}function Kn(t,r){1&t&&(e.TgZ(0,"clr-dropdown",26)(1,"span",27),e._uU(2),e.ALo(3,"translate"),e._UZ(4,"clr-icon",28),e.qZA(),e.YNc(5,$n,18,21,"clr-dropdown-menu",29),e.qZA()),2&t&&(e.xp6(2),e.hij(" ",e.lcZ(3,1,"BUTTON.ACTIONS")," "))}function Wn(t,r){1&t&&(e.TgZ(0,"clr-dg-column"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"REPOSITORY.PLATFORM")))}function Xn(t,r){if(1&t){const i=e.EpF();e.TgZ(0,"img",61),e.NdJ("error",function(o){e.CHM(i);const a=e.oxw(3);return e.KtG(a.showDefaultIcon(o))}),e.qZA()}if(2&t){const i=e.oxw(2).$implicit,n=e.oxw();e.Q6J("title",i.type)("src",n.getIcon(i.icon),e.LSH)}}function er(t,r){if(1&t&&(e.TgZ(0,"div",59),e.YNc(1,Xn,1,2,"img",60),e.qZA()),2&t){const i=e.oxw().$implicit,n=e.oxw();e.xp6(1),e.Q6J("ngIf",n.getIcon(i.icon))}}function tr(t,r){1&t&&(e.TgZ(0,"clr-tooltip-content",67),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.Q6J("clrPosition","top-right")("clrSize","lg"),e.xp6(1),e.hij(" ",e.lcZ(2,3,"REPOSITORY.ARTIFACT_TOOTIP")," "))}function ir(t,r){if(1&t){const i=e.EpF();e.TgZ(0,"clr-tooltip")(1,"div",62)(2,"div",63)(3,"a",64),e.NdJ("click",function(){e.CHM(i);const o=e.oxw().$implicit,a=e.oxw();return e.KtG(a.goIntoIndexArtifact(o))}),e._UZ(4,"clr-icon",65),e.qZA()()(),e.YNc(5,tr,3,5,"clr-tooltip-content",66),e.qZA()}}function nr(t,r){if(1&t&&e._UZ(0,"hbr-copy-input",68),2&t){const i=e.oxw().$implicit,n=e.oxw();e.Q6J("title",n.getPullCommand(i))("iconMode",!0)("defaultValue",n.getPullCommand(i))}}function rr(t,r){if(1&t&&(e.TgZ(0,"clr-dg-cell")(1,"div",51),e._uU(2),e.qZA()()),2&t){const i=e.oxw().$implicit;e.xp6(2),e.lnq(" ",null==i.platform?null:i.platform.os," /",null==i.platform?null:i.platform.architecture,"",null!=i.platform&&i.platform.variant?"/"+(null==i.platform?null:i.platform.variant):""," ")}}function or(t,r){if(1&t&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&t){const i=e.oxw(2).$implicit;e.xp6(1),e.hij("(",null==i?null:i.tagNumber," )")}}function ar(t,r){1&t&&(e.TgZ(0,"th",79),e._uU(1),e.ALo(2,"uppercase"),e.ALo(3,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,e.lcZ(3,3,"ACCESSORY.NOTARY_SIGNED"))," "))}function lr(t,r){1&t&&e._UZ(0,"clr-icon",90)}function cr(t,r){1&t&&e._UZ(0,"clr-icon",91)}function sr(t,r){1&t&&(e.TgZ(0,"a",92),e._UZ(1,"clr-icon",93),e.TgZ(2,"span",94),e._uU(3),e.ALo(4,"translate"),e.qZA()()),2&t&&(e.xp6(3),e.Oqu(e.lcZ(4,1,"REPOSITORY.NOTARY_IS_UNDETERMINED")))}function pr(t,r){if(1&t&&(e.TgZ(0,"td",86)(1,"div",51),e.YNc(2,lr,1,0,"clr-icon",87),e.YNc(3,cr,1,0,"clr-icon",88),e.YNc(4,sr,5,3,"a",89),e.qZA()()),2&t){const i=e.oxw().$implicit;e.Q6J("ngSwitch",i.signed),e.xp6(2),e.Q6J("ngSwitchCase",!0),e.xp6(1),e.Q6J("ngSwitchCase",!1)}}function ur(t,r){if(1&t&&(e.TgZ(0,"tr",83)(1,"td",84),e._uU(2),e.qZA(),e.YNc(3,pr,5,3,"td",85),e.TgZ(4,"td",84),e._uU(5),e.ALo(6,"harborDatetime"),e.qZA(),e.TgZ(7,"td",84),e._uU(8),e.ALo(9,"harborDatetime"),e.qZA()()),2&t){const i=r.$implicit,n=e.oxw(4);e.xp6(2),e.hij(" ",i.name," "),e.xp6(1),e.Q6J("ngIf",n.withNotary),e.xp6(2),e.hij(" ",i.pull_time===n.availableTime?"":e.xi3(6,4,i.pull_time,"short")," "),e.xp6(3),e.hij(" ",e.xi3(9,7,i.push_time,"short")," ")}}function gr(t,r){1&t&&(e.TgZ(0,"tr"),e._uU(1," ... "),e.qZA())}function fr(t,r){if(1&t&&(e.TgZ(0,"clr-tooltip-content",76)(1,"table",77)(2,"thead",78)(3,"tr")(4,"th",79),e._uU(5),e.ALo(6,"uppercase"),e.ALo(7,"translate"),e.qZA(),e.YNc(8,ar,4,5,"th",80),e.TgZ(9,"th",79),e._uU(10),e.ALo(11,"uppercase"),e.ALo(12,"translate"),e.qZA(),e.TgZ(13,"th",79),e._uU(14),e.ALo(15,"uppercase"),e.ALo(16,"translate"),e.qZA()()(),e.TgZ(17,"tbody",81),e.YNc(18,ur,10,10,"tr",82),e.YNc(19,gr,2,0,"tr",17),e.qZA()()()),2&t){const i=e.oxw(2).$implicit,n=e.oxw();e.Q6J("clrPosition","top-right")("clrSize","lg"),e.xp6(5),e.hij(" ",e.lcZ(6,8,e.lcZ(7,10,"REPOSITORY.TAGS"))," "),e.xp6(3),e.Q6J("ngIf",n.withNotary),e.xp6(2),e.hij(" ",e.lcZ(11,12,e.lcZ(12,14,"REPOSITORY.PULL_TIME"))," "),e.xp6(4),e.hij(" ",e.lcZ(15,16,e.lcZ(16,18,"REPOSITORY.PUSH_TIME"))," "),e.xp6(4),e.Q6J("ngForOf",i.tags),e.xp6(1),e.Q6J("ngIf",(null==i?null:i.tagNumber)>8)}}function hr(t,r){if(1&t&&(e.TgZ(0,"div",69)(1,"clr-tooltip",70)(2,"div",71)(3,"div",72)(4,"span",73,74),e._uU(6),e.qZA(),e.YNc(7,or,2,1,"span",17),e.qZA()(),e.YNc(8,fr,20,20,"clr-tooltip-content",75),e.qZA()()),2&t){const i=e.MAs(5),n=e.oxw().$implicit,o=e.oxw();e.xp6(6),e.Oqu(o.tagsString(null==n?null:n.tags)),e.xp6(1),e.Q6J("ngIf",(null==n||null==n.tags?null:n.tags.length)>1&&o.isEllipsisActive(i))}}function dr(t,r){1&t&&e._UZ(0,"span",95)}function mr(t,r){1&t&&e._UZ(0,"clr-icon",96)}function _r(t,r){1&t&&e._UZ(0,"clr-icon",91)}function Ar(t,r){1&t&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"ARTIFACT.SCAN_UNSUPPORTED")," "))}function Tr(t,r){if(1&t){const i=e.EpF();e.TgZ(0,"hbr-vulnerability-bar",97),e.NdJ("submitStopFinish",function(o){e.CHM(i);const a=e.oxw(2);return e.KtG(a.submitStopFinish(o))})("scanFinished",function(o){e.CHM(i);const a=e.oxw(2);return e.KtG(a.scanFinished(o))})("submitFinish",function(o){e.CHM(i);const a=e.oxw(2);return e.KtG(a.submitFinish(o))}),e.qZA()}if(2&t){const i=e.oxw().$implicit,n=e.oxw();let o;e.Q6J("inputScanner",null==(o=n.handleScanOverview(i.scan_overview))?null:o.scanner)("projectName",n.projectName)("repoName",n.repoName)("artifactDigest",i.digest)("summary",n.handleScanOverview(i.scan_overview))}}function br(t,r){if(1&t&&(e.TgZ(0,"div",98)(1,"span",99),e._uU(2),e.qZA()()),2&t){const i=r.$implicit;e.xp6(2),e.Oqu(i)}}function xr(t,r){if(1&t&&(e.TgZ(0,"clr-signpost-content",101)(1,"div"),e.YNc(2,br,3,1,"div",102),e.qZA()()),2&t){const i=e.oxw(2).$implicit;e.Q6J("clrPosition","left-top"),e.xp6(2),e.Q6J("ngForOf",i.annotationsArray)}}function Cr(t,r){if(1&t&&(e.TgZ(0,"div",51)(1,"div",98)(2,"span",99),e._uU(3),e.qZA()(),e.TgZ(4,"div",55)(5,"div",100)(6,"clr-signpost")(7,"button",56),e._uU(8," ... "),e.qZA(),e.YNc(9,xr,3,2,"clr-signpost-content",57),e.qZA()()()()),2&t){const i=e.oxw().$implicit;e.xp6(3),e.Oqu(i.annotationsArray[0]),e.xp6(1),e.Q6J("hidden",(null==i.annotationsArray?null:i.annotationsArray.length)<=1)}}function vr(t,r){if(1&t&&e._UZ(0,"hbr-label-piece",103),2&t){const i=e.oxw().$implicit;e.Q6J("label",i.labels[0])("labelWidth",90)}}function Ir(t,r){if(1&t&&(e.TgZ(0,"div",105),e._UZ(1,"hbr-label-piece",106),e.qZA()),2&t){const i=r.$implicit;e.xp6(1),e.Q6J("labelWidth",130)("label",i)}}function yr(t,r){if(1&t&&(e.TgZ(0,"clr-signpost-content",101),e.YNc(1,Ir,2,2,"div",104),e.qZA()),2&t){const i=e.oxw().$implicit;e.Q6J("clrPosition","top-middle"),e.xp6(1),e.Q6J("ngForOf",i.labels)}}function Sr(t,r){if(1&t){const i=e.EpF();e.TgZ(0,"sub-accessories",109),e.NdJ("deleteAccessory",function(o){e.CHM(i);const a=e.oxw(3);return e.KtG(a.deleteAccessory(o))}),e.qZA()}if(2&t){const i=e.oxw(2).$implicit,n=e.oxw();e.Q6J("projectName",n.projectName)("repositoryName",n.repoName)("artifactDigest",null==i?null:i.digest)("total",null==i?null:i.accessoryNumber)("accessories",null==i?null:i.accessories)}}function Or(t,r){1&t&&(e.ynx(0,107),e.YNc(1,Sr,1,5,"sub-accessories",108),e.BQk())}function Lr(t,r){if(1&t){const i=e.EpF();e.TgZ(0,"clr-dg-row",40)(1,"clr-dg-cell",41)(2,"div",42),e.YNc(3,er,2,1,"div",43),e.TgZ(4,"a",44),e.NdJ("click",function(){const a=e.CHM(i).$implicit,l=e.oxw();return e.KtG(l.goIntoArtifactSummaryPage(a))}),e._uU(5),e.ALo(6,"slice"),e.qZA(),e.YNc(7,ir,6,0,"clr-tooltip",17),e.qZA()(),e.TgZ(8,"clr-dg-cell"),e.YNc(9,nr,1,3,"hbr-copy-input",45),e.qZA(),e.YNc(10,rr,3,3,"clr-dg-cell",17),e.TgZ(11,"clr-dg-cell",46),e.YNc(12,hr,9,2,"div",47),e.qZA(),e.TgZ(13,"clr-dg-cell"),e.YNc(14,dr,1,0,"span",48),e.YNc(15,mr,1,0,"clr-icon",49),e.YNc(16,_r,1,0,"clr-icon",50),e.qZA(),e.TgZ(17,"clr-dg-cell")(18,"div",51),e._uU(19),e.qZA()(),e.TgZ(20,"clr-dg-cell")(21,"div",51),e.YNc(22,Ar,3,3,"span",17),e.YNc(23,Tr,1,5,"hbr-vulnerability-bar",52),e.qZA()(),e.TgZ(24,"clr-dg-cell"),e.YNc(25,Cr,10,2,"div",53),e.qZA(),e.TgZ(26,"clr-dg-cell")(27,"div",51),e.YNc(28,vr,1,2,"hbr-label-piece",54),e.TgZ(29,"div",55)(30,"clr-signpost")(31,"button",56),e._uU(32," ... "),e.qZA(),e.YNc(33,yr,2,2,"clr-signpost-content",57),e.qZA()()()(),e.TgZ(34,"clr-dg-cell")(35,"div",51),e._uU(36),e.ALo(37,"harborDatetime"),e.qZA()(),e.TgZ(38,"clr-dg-cell")(39,"div",51),e._uU(40),e.ALo(41,"harborDatetime"),e.qZA()(),e.YNc(42,Or,2,0,"ng-container",58),e.qZA()}if(2&t){const i=r.$implicit,n=e.oxw();e.Q6J("clrDgItem",i),e.xp6(3),e.Q6J("ngIf",i.icon),e.xp6(1),e.s9C("title",i.digest),e.xp6(1),e.hij(" ",e.Dn7(6,20,i.digest,0,15),""),e.xp6(2),e.Q6J("ngIf",(null==i?null:i.references)&&(null==i||null==i.references?null:i.references.length)),e.xp6(2),e.Q6J("ngIf",n.getPullCommand(i)),e.xp6(1),e.Q6J("ngIf",n.depth),e.xp6(2),e.Q6J("ngIf",i.tags),e.xp6(2),e.Q6J("ngIf","checking"===i.coSigned),e.xp6(1),e.Q6J("ngIf","true"===i.coSigned),e.xp6(1),e.Q6J("ngIf","false"===i.coSigned),e.xp6(3),e.hij(" ",i.size?n.sizeTransform(i.size+""):""," "),e.xp6(3),e.Q6J("ngIf",!n.hasVul(i)),e.xp6(1),e.Q6J("ngIf",n.hasVul(i)),e.xp6(2),e.Q6J("ngIf",null==i.annotationsArray?null:i.annotationsArray.length),e.xp6(3),e.Q6J("ngIf",null==i.labels?null:i.labels.length),e.xp6(1),e.Q6J("hidden",(null==i.labels?null:i.labels.length)<=1),e.xp6(7),e.hij(" ",e.xi3(37,24,i.push_time,"short")," "),e.xp6(4),e.hij(" ",i.pull_time===n.availableTime?"":e.xi3(41,27,i.pull_time,"short")," "),e.xp6(2),e.Q6J("ngIf",null==i||null==i.accessories?null:i.accessories.length)}}function wr(t,r){if(1&t&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t){e.oxw();const i=e.MAs(63);e.xp6(1),e.lnq("",i.firstItem+1," - ",i.lastItem+1," ",e.lcZ(2,3,"REPOSITORY.OF"),"")}}const Nr=function(){return[15,25,50]},mt="0001-01-01T00:00:00.000Z";let At=(()=>{class t{constructor(i,n,o,a,l,c,p,g,h,f){this.errorHandlerService=i,this.artifactService=n,this.newArtifactService=o,this.translateService=a,this.operationService=l,this.eventService=c,this.activatedRoute=p,this.router=g,this.appConfigService=h,this.artifactListPageService=f,this.artifactList=[],this.availableTime=mt,this.pullComparator=new u.sH("pull_time","date"),this.pushComparator=new u.sH("push_time","date"),this.loading=!0,this.selectedRow=[],this.pageSize=(0,u.tb)(u.V2.ARTIFACT_LIST_TAB_COMPONENT),this.currentPage=1,this.totalCount=0,this.onSendingStopScanCommand=!1,this.onStopScanArtifactsLength=0,this.scanStoppedArtifactLength=0,this.scanFinishedArtifactLength=0,this.onScanArtifactsLength=0,this.stopBtnState=s.xp5.DEFAULT,this.deleteArtifactobservableLists=[]}get hasAddLabelImagePermission(){return this.artifactListPageService.hasAddLabelImagePermission()}get hasRetagImagePermission(){return this.artifactListPageService.hasRetagImagePermission()}get hasDeleteImagePermission(){return this.artifactListPageService.hasDeleteImagePermission()}get hasScanImagePermission(){return this.artifactListPageService.hasScanImagePermission()}get hasEnabledScanner(){return this.artifactListPageService.hasEnabledScanner()}get scanBtnState(){return this.artifactListPageService.getScanBtnState()}initRouterData(){if(this.projectId=this.activatedRoute.snapshot?.parent?.parent?.params.id,!this.projectId)return void this.errorHandlerService.error("Project ID cannot be unset.");const i=this.activatedRoute.snapshot?.parent?.parent?.data;if(i&&(this.projectName=i.projectResolver.name),this.repoName=this.activatedRoute.snapshot?.parent?.params.repo,this.repoName){if(this.depth=this.activatedRoute.snapshot.params.depth,this.depth){const n=this.depth.split("-");this.artifactDigest=this.depth.split("-")[n.length-1]}}else this.errorHandlerService.error("Repo name cannot be unset.")}ngOnInit(){this.registryUrl=this.appConfigService.getConfig().registry_url,this.initRouterData(),this.updateArtifactSub||(this.updateArtifactSub=this.eventService.subscribe(B.n.UPDATE_VULNERABILITY_INFO,i=>{this.artifactList&&this.artifactList.length&&this.artifactList.forEach(n=>{n.digest===i.digest&&(n.scan_overview=i.scan_overview)})}))}ngOnDestroy(){this.updateArtifactSub&&(this.updateArtifactSub.unsubscribe(),this.updateArtifactSub=null)}get withNotary(){return this.appConfigService.getConfig()?.with_notary}clrDgRefresh(i){setTimeout(()=>{this.clrLoad(i)},0)}clrLoad(i){if(this.artifactList=[],this.loading=!0,!i||!i.page)return;this.pageSize=i.page.size,(0,u.Pe)(u.V2.ARTIFACT_LIST_TAB_COMPONENT,this.pageSize),this.selectedRow=[];let n=(0,u.wy)(i);n<=0&&(n=1);let o="";i.sort&&(o=i.sort.by,o=o.fieldName?o.fieldName:o,o=i.sort.reverse?`-${o}`:o),this.currentState=i;let a={};if(n&&this.pageSize&&(a.page=n,a.pageSize=this.pageSize),o&&(a.sort=o),this.filters&&this.filters.length){let l="";this.filters.forEach(c=>{l+=c}),a.q=encodeURIComponent(l)}if(this.artifactDigest){const l={repositoryName:(0,u.gI)(this.repoName),projectName:this.projectName,reference:this.artifactDigest,withImmutableStatus:!0,withLabel:!0,withScanOverview:!0,withTag:!1,XAcceptVulnerabilities:u.eB,withAccessory:!1};this.newArtifactService.getArtifact(l).subscribe(c=>{let p=[],g=[];this.totalCount=c.references.length,c.references.forEach((h,f)=>{if(f>=(n-1)*this.pageSize&&f<n*this.pageSize){let d={repositoryName:(0,u.gI)(this.repoName),projectName:this.projectName,reference:h.child_digest,withImmutableStatus:!0,withLabel:!0,withScanOverview:!0,withTag:!1,XAcceptVulnerabilities:u.eB,withAccessory:!1};g.push({platform:h.platform}),p.push(this.newArtifactService.getArtifact(d))}}),(0,G.D)(p).pipe((0,L.x)(()=>{this.loading=!1})).subscribe(h=>{this.artifactList=h,this.artifactList=(0,u.Pq)(this.artifactList,i),this.artifactList.forEach((f,d)=>{f.platform=(0,u.d9)(g[d].platform)}),this.getArtifactTagsAsync(this.artifactList),this.getAccessoriesAsync(this.artifactList),this.checkCosignAsync(this.artifactList),this.getIconsFromBackEnd()},h=>{this.errorHandlerService.error(h)})},c=>{this.loading=!1})}else{let l={projectName:this.projectName,repositoryName:(0,u.gI)(this.repoName),withLabel:!0,withScanOverview:!0,withTag:!1,sort:(0,u.td)(i),XAcceptVulnerabilities:u.eB,withAccessory:!1};Object.assign(l,a),this.newArtifactService.listArtifactsResponse(l).pipe((0,L.x)(()=>this.loading=!1)).subscribe(c=>{if(c.headers){let p=c.headers.get("X-Total-Count");p&&(this.totalCount=parseInt(p,0))}this.artifactList=c.body,this.getArtifactTagsAsync(this.artifactList),this.getAccessoriesAsync(this.artifactList),this.checkCosignAsync(this.artifactList),this.getIconsFromBackEnd()},c=>{this.errorHandlerService.error(c)})}}refresh(){this.currentPage=1;let i=this.currentState;i||(i={page:{}},i.page.size=this.pageSize,i.page.from=0,i.page.to=this.pageSize-1),this.clrLoad(i)}getPullCommand(i){let n="";return n=i.type===F.CHART&&i.tags&&i.tags[0]?lt(i.type,`${this.registryUrl?this.registryUrl:location.hostname}/${this.projectName}/${this.repoName}`,i.tags[0]?.name):function wi(t,r,i){let n="";return t&&r&&i&&(t===F.IMAGE&&(n=`docker pull ${r}@${i}`),t===F.CNAB&&(n=`cnab-to-oci pull ${r}@${i}`)),n}(i.type,`${this.registryUrl?this.registryUrl:location.hostname}/${this.projectName}/${this.repoName}`,i.digest),n}canAddLabel(){if(this.selectedRow&&1===this.selectedRow.length)return!0;if(this.selectedRow&&this.selectedRow.length>1){for(let i=0;i<this.selectedRow.length;i++)if(this.selectedRow[i].labels&&this.selectedRow[i].labels.length)return!1;return!0}return!1}stickLabel(i){i.isAdd?this.addLabel(i?.label):this.removeLabel(i?.label)}addLabel(i){if(!this.inprogress){const n={projectName:this.projectName,repositoryName:(0,u.gI)(this.repoName),reference:this.selectedRow[0].digest,label:i};this.inprogress=!0,this.newArtifactService.addLabel(n).pipe((0,L.x)(()=>this.inprogress=!1)).subscribe({next:o=>{this.refresh()},error:o=>{this.refresh(),this.errorHandlerService.error(o)}})}}removeLabel(i){if(!this.inprogress){let n={projectName:this.projectName,repositoryName:(0,u.gI)(this.repoName),reference:this.selectedRow[0].digest,labelId:i.id};this.inprogress=!0,this.newArtifactService.removeLabel(n).pipe((0,L.x)(()=>this.inprogress=!1)).subscribe({next:o=>{this.refresh()},error:o=>{this.refresh(),this.errorHandlerService.error(o)}})}}sizeTransform(i){return(0,u.BU)(i)}retag(){this.selectedRow&&this.selectedRow.length&&!this.depth&&this.copyArtifactComponent.retag(this.selectedRow[0].digest)}deleteArtifact(){if(this.selectedRow&&this.selectedRow.length&&!this.depth){let n,o,a,l,i=[];this.selectedRow.forEach(p=>{i.push(p.digest.slice(0,15))}),n="REPOSITORY.DELETION_TITLE_ARTIFACT",o="REPOSITORY.DELETION_SUMMARY_ARTIFACT",l=2,a=i.join(" , ");let c=new Ie.c(n,o,a,this.selectedRow,9,l);this.confirmationDialog.open(c)}}confirmDeletion(i){if(i&&27===i.source&&1===i.state){this.loading=!0;const n=new w.gB;n.name="ACCESSORY.DELETE_ACCESSORY",n.data.id=i.data.id,n.state=w.yb.progressing,n.data.name=i.data.digest.slice(0,15),this.operationService.publishInfo(n);const o={projectName:this.projectName,repositoryName:(0,u.gI)(this.repoName),reference:i.data.digest};this.newArtifactService.deleteArtifact(o).pipe((0,L.x)(()=>this.loading=!1)).subscribe(a=>{this.errorHandlerService.info("ACCESSORY.DELETED_SUCCESS"),(0,w.hm)(n,w.yb.success),this.refresh()},a=>{this.errorHandlerService.error(a),(0,w.hm)(n,w.yb.failure,(0,De.Po)(a))})}if(i&&9===i.source&&1===i.state){let n=i.data;n&&n.length&&(n.forEach(o=>{this.deleteArtifactobservableLists.push(this.delOperate(o))}),this.loading=!0,(0,G.D)(...this.deleteArtifactobservableLists).subscribe(o=>{let a=[],l=[];this.deleteArtifactobservableLists=[],o.forEach(c=>{c?l.push(c):a.push(c)}),this.selectedRow=[],a.length===o.length?this.clrLoad({page:{from:0,to:this.pageSize-1,size:this.pageSize}}):l.length===o.length?(this.loading=!1,this.errorHandlerService.error(o[o.length-1])):(this.errorHandlerService.error(l[l.length-1]),this.clrLoad({page:{from:0,to:this.pageSize-1,size:this.pageSize}}))}))}}delOperate(i){let n=new w.gB;n.name="OPERATION.DELETE_TAG",n.data.id=i.id,n.state=w.yb.progressing,n.data.name=i.digest,this.operationService.publishInfo(n);let o={projectName:this.projectName,repositoryName:(0,u.gI)(this.repoName),reference:i.digest};return this.newArtifactService.deleteArtifact(o).pipe((0,se.U)(a=>{this.translateService.get("BATCH.DELETED_SUCCESS").subscribe(l=>{(0,w.hm)(n,w.yb.success)})}),(0,Me.K)(a=>{const l=(0,De.Po)(a);return this.translateService.get(l).subscribe(c=>(0,w.hm)(n,w.yb.failure,c)),(0,ve.of)(a)}))}showDigestId(){this.selectedRow&&1===this.selectedRow.length&&!this.depth&&this.copyDigestComponent.showDigestId(this.selectedRow[0].digest)}goIntoArtifactSummaryPage(i){this.router.navigate(["artifacts",i.digest],this.activatedRoute.snapshot.queryParams[j.jv]===j.gT?{relativeTo:this.activatedRoute,queryParams:{[j.jv]:j.gT}}:{relativeTo:this.activatedRoute})}scanStatus(i){if(i){let n=this.handleScanOverview(i.scan_overview);if(n&&n.scan_status)return n.scan_status}return u.Iy.NOT_SCANNED}canScanNow(){if(!this.hasScanImagePermission||this.onSendingScanCommand)return!1;if(this.selectedRow&&this.selectedRow.length){let i=!0;return this.selectedRow.forEach(n=>{const o=this.scanStatus(n);this.isRunningState(o)&&(i=!1)}),i}return!1}scanNow(){!this.selectedRow.length||(this.scanFinishedArtifactLength=0,this.onScanArtifactsLength=this.selectedRow.length,this.onSendingScanCommand=!0,this.selectedRow.forEach(i=>{this.eventService.publish(B.n.START_SCAN_ARTIFACT,this.repoName+"/"+i.digest)}))}selectedRowHasVul(){return!!(this.selectedRow&&this.selectedRow[0]&&this.selectedRow[0].addition_links&&this.selectedRow[0].addition_links[D.VULNERABILITIES])}hasVul(i){return!!(i&&i.addition_links&&i.addition_links[D.VULNERABILITIES])}submitFinish(i){this.scanFinishedArtifactLength+=1,this.scanFinishedArtifactLength===this.onScanArtifactsLength&&(this.onSendingScanCommand=i)}submitStopFinish(i){this.scanStoppedArtifactLength+=1,this.scanStoppedArtifactLength===this.onStopScanArtifactsLength&&(this.onSendingScanCommand=i)}handleScanOverview(i){return i?Object.values(i)[0]:null}goIntoIndexArtifact(i){let n="";n=this.depth?this.depth+"-"+i.digest:i.digest;const o=["harbor","projects",this.projectId,"repositories",this.repoName,"artifacts-tab","depth",n];this.activatedRoute.snapshot.queryParams[j.jv]===j.gT?this.router.navigate(o,{queryParams:{[j.jv]:j.gT}}):this.router.navigate(o)}filterEvent(i){this.filters=[],i?.isLabel?i?.label?.name&&this.filters.push(`${i.type}=(${i?.label?.id})`):i?.stringValue&&this.filters.push(i?.isInputTag?`${i.type}=~${i?.stringValue}`:`${i.type}=${i?.stringValue}`),this.refresh()}scanFinished(i){if(this.selectedRow&&this.selectedRow.length)for(let n=0;n<this.selectedRow.length;n++)if(i.digest===this.selectedRow[n].digest){this.selectedRow.splice(n,1);break}}getIconsFromBackEnd(){this.artifactList&&this.artifactList.length&&this.artifactService.getIconsFromBackEnd(this.artifactList)}showDefaultIcon(i){i&&i.target&&(i.target.src=ke)}getIcon(i){return this.artifactService.getIcon(i)}getArtifactTagsAsync(i){i&&i.length&&i.forEach(n=>{const o={projectName:this.projectName,repositoryName:(0,u.gI)(this.repoName),reference:n.digest,withSignature:!0,withImmutableStatus:!0,page:1,pageSize:8};this.newArtifactService.listTagsResponse(o).subscribe(a=>{if(a.headers){let l=a.headers.get("x-total-count");l&&(n.tagNumber=Number.parseInt(l,10))}n.tags=a.body})})}getAccessoriesAsync(i){i&&i.length&&i.forEach(n=>{const o={projectName:this.projectName,repositoryName:(0,u.gI)(this.repoName),reference:n.digest,page:1,pageSize:5};this.newArtifactService.listAccessoriesResponse(o).subscribe(a=>{if(a.headers){let l=a.headers.get("x-total-count");l&&(n.accessoryNumber=Number.parseInt(l,10))}n.accessories=a.body})})}checkCosignAsync(i){i&&i.length&&i.forEach(n=>{n.coSigned="checking";const o={projectName:this.projectName,repositoryName:(0,u.gI)(this.repoName),reference:n.digest,q:encodeURIComponent(`type=${W.COSIGN}`),page:1,pageSize:5};this.newArtifactService.listAccessories(o).subscribe(a=>{n.coSigned=a?.length?"true":"false"},a=>{n.coSigned="false"})})}canStopScan(){if(this.onSendingStopScanCommand)return!1;if(this.selectedRow&&this.selectedRow.length){let i=!0;return this.selectedRow.forEach(n=>{const o=this.scanStatus(n);this.isRunningState(o)||(i=!1)}),i}return!1}isRunningState(i){return i===u.Iy.RUNNING||i===u.Iy.PENDING||i===u.Iy.SCHEDULED}stopNow(){this.selectedRow&&this.selectedRow.length&&(this.scanStoppedArtifactLength=0,this.onStopScanArtifactsLength=this.selectedRow.length,this.onSendingStopScanCommand=!0,this.selectedRow.forEach(i=>{this.eventService.publish(B.n.STOP_SCAN_ARTIFACT,this.repoName+"/"+i.digest)}))}tagsString(i){if(i?.length){const n=[];return i.forEach(o=>{n.push(o.name)}),n.join(", ")}return null}deleteAccessory(i){let n,o,a,l;n="ACCESSORY.DELETION_TITLE_ACCESSORY",o="ACCESSORY.DELETION_SUMMARY_ONE_ACCESSORY",l=2,a=i.digest.slice(0,15);let c=new Ie.c("ACCESSORY.DELETION_TITLE_ACCESSORY","ACCESSORY.DELETION_SUMMARY_ONE_ACCESSORY",a,i,27,2);this.confirmationDialog.open(c)}isEllipsisActive(i){return i?.offsetWidth<i?.scrollWidth}}return t.\u0275fac=function(i){return new(i||t)(e.Y36(R.q),e.Y36(pe),e.Y36(ee.b),e.Y36(b.sK),e.Y36(pt.f9),e.Y36(B.P),e.Y36(Z.gz),e.Y36(Z.F0),e.Y36(Ye._),e.Y36(ce))},t.\u0275cmp=e.Xpm({type:t,selectors:[["artifact-list-tab"]],viewQuery:function(i,n){if(1&i&&(e.Gf(Gn,5),e.Gf(ct,5),e.Gf(st,5)),2&i){let o;e.iGM(o=e.CRH())&&(n.confirmationDialog=o.first),e.iGM(o=e.CRH())&&(n.copyArtifactComponent=o.first),e.iGM(o=e.CRH())&&(n.copyDigestComponent=o.first)}},decls:70,vars:67,consts:[[1,"hidden-tag",3,"confirmAction"],["confirmationDialog",""],[1,"row","tag-row"],[1,"col-lg-12","col-md-12","col-sm-12","col-xs-12"],[3,"clrDgLoading","clrDgSelected","clrDgRefresh","clrDgSelectedChange"],[1,"action-bar"],["id","scan-btn","type","button",1,"btn","btn-secondary","scan-btn",3,"clrLoading","disabled","click"],["shape","shield-check","size","16"],["id","stop-scan","type","button",1,"btn","btn-secondary","scan-btn",3,"clrLoading","disabled","click"],["shape","stop","size","16"],["class","btn btn-link",4,"ngIf"],[1,"right-pos"],[3,"withDivider","projectId","filterEvent"],[1,"refresh-btn",3,"click"],["shape","refresh"],[1,"flex-max-width",3,"clrDgSortBy"],[1,"pull-command-column"],[4,"ngIf"],[1,"co-signed-column"],[3,"clrDgSortBy"],[1,"vul-column"],[1,"annotations-column"],[3,"clrDgItem",4,"ngFor","ngForOf"],[3,"clrDgTotalItems","clrDgPage","clrDgPageSize","clrDgPageChange"],["pagination",""],[3,"clrPageSizeOptions"],[1,"btn","btn-link"],["clrDropdownTrigger","","id","artifact-list-action",1,"btn","pl-0"],["shape","caret down"],["class","action-dropdown","clrPosition","bottom-left",4,"clrIfOpen"],["clrPosition","bottom-left",1,"action-dropdown"],["id","artifact-list-copy-digest","aria-label","copy digest","clrDropdownItem","",1,"action-dropdown-item","no-border",3,"clrDisabled","click"],["id","artifact-list-add-labels","clrDropdownTrigger","",1,"action-dropdown-item",3,"disabled"],[3,"hidden"],["clrDropdownItem","",1,"filter-grid"],[1,"dropdown-header"],[3,"width","ownedLabels","projectId","scope","clickLabel"],["id","artifact-list-copy","aria-label","retag","clrDropdownItem","",1,"action-dropdown-item",3,"clrDisabled","click"],["class","action-dropdown-item","clrDropdownItem","","id","artifact-list-delete",3,"clrDisabled","click",4,"ngIf"],["clrDropdownItem","","id","artifact-list-delete",1,"action-dropdown-item",3,"clrDisabled","click"],[3,"clrDgItem"],[1,"flex-max-width","truncated"],[1,"cell","white-normal"],["class","artifact-icon clr-display-inline-block",4,"ngIf"],["href","javascript:void(0)",1,"digest","margin-left-5",3,"title","click"],[3,"title","iconMode","defaultValue",4,"ngIf"],[1,"center"],["class","truncated width-p-100",4,"ngIf"],["class","spinner spinner-inline ml-2",4,"ngIf"],["shape","check-circle","size","20","class","signed",4,"ngIf"],["shape","times-circle","size","16","class","color-red",4,"ngIf"],[1,"cell"],[3,"inputScanner","projectName","repoName","artifactDigest","summary","submitStopFinish","scanFinished","submitFinish",4,"ngIf"],["class","cell",4,"ngIf"],[3,"label","labelWidth",4,"ngIf"],[1,"signpost-item",3,"hidden"],["clrSignpostTrigger","",1,"btn","btn-link"],[3,"clrPosition",4,"clrIfOpen"],["ngProjectAs","clr-dg-row-detail",5,["clr-dg-row-detail"],4,"ngIf"],[1,"artifact-icon","clr-display-inline-block"],["class","artifact-icon",3,"title","src","error",4,"ngIf"],[1,"artifact-icon",3,"title","src","error"],["clrTooltipTrigger","",1,"level-border"],[1,"inner","truncated"],["href","javascript:void(0)",3,"click"],["size","24","shape","folder",1,"icon-folder"],[3,"clrPosition","clrSize",4,"clrIfOpen"],[3,"clrPosition","clrSize"],[3,"title","iconMode","defaultValue"],[1,"truncated","width-p-100"],[1,"width-p-100"],["clrTooltipTrigger","",1,"center"],[1,"center","width-p-100"],[1,"truncated","width-p-75"],["tagsSpan",""],["class","lg",3,"clrPosition","clrSize",4,"clrIfOpen"],[1,"lg",3,"clrPosition","clrSize"],[1,"table","table-noborder","mt-0","table-tag"],[1,"tag-thead"],[1,"left","tag-header-color"],["class","left tag-header-color",4,"ngIf"],[1,"tag-tbody"],["class","tag-tr",4,"ngFor","ngForOf"],[1,"tag-tr"],[1,"left","tag-body-color"],["class","left tag-body-color",3,"ngSwitch",4,"ngIf"],[1,"left","tag-body-color",3,"ngSwitch"],["shape","check-circle","size","20","class","color-green",4,"ngSwitchCase"],["shape","times-circle","size","16","class","color-red",4,"ngSwitchCase"],["href","javascript:void(0)","role","tooltip","aria-haspopup","true","class","tooltip tooltip-top-right",4,"ngSwitchDefault"],["shape","check-circle","size","20",1,"color-green"],["shape","times-circle","size","16",1,"color-red"],["href","javascript:void(0)","role","tooltip","aria-haspopup","true",1,"tooltip","tooltip-top-right"],["shape","help","size","16",1,"color-gray"],[1,"tooltip-content"],[1,"spinner","spinner-inline","ml-2"],["shape","check-circle","size","20",1,"signed"],[3,"inputScanner","projectName","repoName","artifactDigest","summary","submitStopFinish","scanFinished","submitFinish"],[1,"bar-state"],[1,"label","not-scan"],[1,"trigger-item"],[3,"clrPosition"],["class","bar-state",4,"ngFor","ngForOf"],[3,"label","labelWidth"],["class","margin-5px",4,"ngFor","ngForOf"],[1,"margin-5px"],[3,"labelWidth","label"],["ngProjectAs","clr-dg-row-detail",5,["clr-dg-row-detail"]],[3,"projectName","repositoryName","artifactDigest","total","accessories","deleteAccessory",4,"clrIfExpanded"],[3,"projectName","repositoryName","artifactDigest","total","accessories","deleteAccessory"]],template:function(i,n){1&i&&(e.TgZ(0,"confirmation-dialog",0,1),e.NdJ("confirmAction",function(a){return n.confirmDeletion(a)}),e.qZA(),e._UZ(2,"app-copy-artifact")(3,"app-copy-digest"),e.TgZ(4,"div",2)(5,"div",3)(6,"clr-datagrid",4),e.NdJ("clrDgRefresh",function(a){return n.clrDgRefresh(a)})("clrDgSelectedChange",function(a){return n.selectedRow=a}),e.TgZ(7,"clr-dg-action-bar",5)(8,"div")(9,"button",6),e.NdJ("click",function(){return n.scanNow()}),e._UZ(10,"clr-icon",7),e._uU(11,"\xa0 "),e.TgZ(12,"span"),e._uU(13),e.ALo(14,"translate"),e.qZA()(),e.TgZ(15,"button",8),e.NdJ("click",function(){return n.stopNow()}),e._UZ(16,"clr-icon",9),e._uU(17,"\xa0 "),e.TgZ(18,"span"),e._uU(19),e.ALo(20,"translate"),e.qZA()(),e.YNc(21,Kn,6,3,"clr-dropdown",10),e.qZA(),e.TgZ(22,"div",11)(23,"app-artifact-filter",12),e.NdJ("filterEvent",function(a){return n.filterEvent(a)}),e.qZA(),e.TgZ(24,"span",13),e.NdJ("click",function(){return n.refresh()}),e._UZ(25,"clr-icon",14),e.qZA()()(),e.TgZ(26,"clr-dg-column",15),e._uU(27),e.ALo(28,"translate"),e.qZA(),e.TgZ(29,"clr-dg-column",16),e._uU(30),e.ALo(31,"translate"),e.qZA(),e.YNc(32,Wn,3,3,"clr-dg-column",17),e.TgZ(33,"clr-dg-column"),e._uU(34),e.ALo(35,"translate"),e.qZA(),e.TgZ(36,"clr-dg-column",18),e._uU(37),e.ALo(38,"translate"),e.qZA(),e.TgZ(39,"clr-dg-column",19),e._uU(40),e.ALo(41,"translate"),e.qZA(),e.TgZ(42,"clr-dg-column",20),e._uU(43),e.ALo(44,"translate"),e.qZA(),e.TgZ(45,"clr-dg-column",21),e._uU(46),e.ALo(47,"translate"),e.qZA(),e.TgZ(48,"clr-dg-column"),e._uU(49),e.ALo(50,"translate"),e.qZA(),e.TgZ(51,"clr-dg-column",19),e._uU(52),e.ALo(53,"translate"),e.qZA(),e.TgZ(54,"clr-dg-column",19),e._uU(55),e.ALo(56,"translate"),e.qZA(),e.TgZ(57,"clr-dg-placeholder"),e._uU(58),e.ALo(59,"translate"),e.qZA(),e.YNc(60,Lr,43,30,"clr-dg-row",22),e.TgZ(61,"clr-dg-footer")(62,"clr-dg-pagination",23,24),e.NdJ("clrDgPageChange",function(a){return n.currentPage=a}),e.TgZ(64,"clr-dg-page-size",25),e._uU(65),e.ALo(66,"translate"),e.qZA(),e.YNc(67,wr,3,5,"span",17),e._uU(68),e.ALo(69,"translate"),e.qZA()()()()()),2&i&&(e.xp6(6),e.Q6J("clrDgLoading",n.loading)("clrDgSelected",n.selectedRow),e.xp6(3),e.Q6J("clrLoading",n.scanBtnState)("disabled",!(n.canScanNow()&&n.selectedRowHasVul()&&n.hasEnabledScanner&&n.hasScanImagePermission)),e.xp6(4),e.Oqu(e.lcZ(14,36,"VULNERABILITY.SCAN_NOW")),e.xp6(2),e.Q6J("clrLoading",n.stopBtnState)("disabled",!(n.canStopScan()&&n.hasScanImagePermission)),e.xp6(4),e.Oqu(e.lcZ(20,38,"VULNERABILITY.STOP_NOW")),e.xp6(2),e.Q6J("ngIf",!n.depth),e.xp6(2),e.Q6J("withDivider",!0)("projectId",n.projectId),e.xp6(3),e.Q6J("clrDgSortBy","digest"),e.xp6(1),e.hij("",e.lcZ(28,40,"REPOSITORY.ARTIFACTS_COUNT")," "),e.xp6(3),e.Oqu(e.lcZ(31,42,"REPOSITORY.PULL_COMMAND")),e.xp6(2),e.Q6J("ngIf",n.depth),e.xp6(2),e.Oqu(e.lcZ(35,44,"REPOSITORY.TAGS")),e.xp6(3),e.Oqu(e.lcZ(38,46,"ACCESSORY.CO_SIGNED")),e.xp6(2),e.Q6J("clrDgSortBy","size"),e.xp6(1),e.Oqu(e.lcZ(41,48,"REPOSITORY.SIZE")),e.xp6(3),e.Oqu(e.lcZ(44,50,"REPOSITORY.VULNERABILITY")),e.xp6(3),e.Oqu(e.lcZ(47,52,"ARTIFACT.ANNOTATION")),e.xp6(3),e.Oqu(e.lcZ(50,54,"REPOSITORY.LABELS")),e.xp6(2),e.Q6J("clrDgSortBy",n.pushComparator),e.xp6(1),e.Oqu(e.lcZ(53,56,"REPOSITORY.PUSH_TIME")),e.xp6(2),e.Q6J("clrDgSortBy",n.pullComparator),e.xp6(1),e.Oqu(e.lcZ(56,58,"REPOSITORY.PULL_TIME")),e.xp6(3),e.Oqu(e.lcZ(59,60,"ARTIFACT.PLACEHOLDER")),e.xp6(2),e.Q6J("ngForOf",n.artifactList),e.xp6(2),e.Q6J("clrDgTotalItems",n.totalCount)("clrDgPage",n.currentPage)("clrDgPageSize",n.pageSize),e.xp6(2),e.Q6J("clrPageSizeOptions",e.DdM(66,Nr)),e.xp6(1),e.Oqu(e.lcZ(66,62,"PAGINATION.PAGE_SIZE")),e.xp6(2),e.Q6J("ngIf",n.totalCount),e.xp6(1),e.AsE(" ",n.totalCount," ",e.lcZ(69,64,"REPOSITORY.ITEMS"),"\xa0\xa0\xa0\xa0 "))},dependencies:[s.C9t,s.Gwl,s.m4W,s.Z4N,s.Nz$,s.fv_,s.dRQ,s.Ltv,s.YYR,s.F7K,s.PDs,s.KHL,s.Gcc,s.jND,s.Nh1,s.dml,s.K8c,s.qvL,s.cCV,s.nqY,s.DbV,s.MPb,s.MgK,s.f_W,s.zwp,s.ZUS,s.lU3,s.EuU,s.hQ,s.QH5,s.Jmj,s.bMv,s.zDF,A.sg,A.O5,A.RF,A.n9,A.ED,qe.z,ut.s,Fe.q,ft,Be,Fi,ct,st,Vn,b.X$,A.gd,A.OU,ue.Z],styles:[".refresh-btn[_ngcontent-%COMP%]{cursor:pointer}.refresh-btn[_ngcontent-%COMP%]:hover{color:#007cbb}.hidden-tag[_ngcontent-%COMP%]{display:block;height:0}.truncated[_ngcontent-%COMP%]{width:100px;line-height:20px;height:20px;display:inline-block;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.right-pos[_ngcontent-%COMP%]{margin-right:35px;display:flex;align-items:center}.tag-row[_ngcontent-%COMP%]{position:relative}.color-green[_ngcontent-%COMP%]{color:#1d5100}.color-red[_ngcontent-%COMP%]{color:#c92100}.color-gray[_ngcontent-%COMP%]{color:#565656}.cell[_ngcontent-%COMP%]{display:flex;align-items:center;width:100%;height:100%}.ml-8[_ngcontent-%COMP%]{margin-left:8px}.white-normal[_ngcontent-%COMP%]{white-space:normal}.digest[_ngcontent-%COMP%]{width:128px;flex-grow:0;flex-shrink:0}.artifact-icon[_ngcontent-%COMP%]{width:.8rem;height:.8rem;vertical-align:top}.width-p-100[_ngcontent-%COMP%]{width:100%}.width-p-100[_ngcontent-%COMP%]   .lg[_ngcontent-%COMP%]{width:550px}.tag-header-color[_ngcontent-%COMP%]{color:#fff}.tag-body-color[_ngcontent-%COMP%]{color:#ccc;max-width:120px}.table[_ngcontent-%COMP%]   .tag-tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding-top:8px;padding-bottom:2px}.table[_ngcontent-%COMP%]   .tag-thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding-top:0;padding-bottom:5px;border:none;font-weight:400}.action-dropdown[_ngcontent-%COMP%]   .action-dropdown-item[_ngcontent-%COMP%]{position:static;padding-left:1rem;line-height:inherit;height:auto}.action-dropdown[_ngcontent-%COMP%]   .action-dropdown-item[_ngcontent-%COMP%]:before{margin-top:.5rem}.action-dropdown[_ngcontent-%COMP%]   .dropdown-header[_ngcontent-%COMP%]{text-transform:none}.eslip[_ngcontent-%COMP%]{margin-left:-3px}.execution-select[_ngcontent-%COMP%]{height:24px;display:flex;justify-content:flex-end}.execution-select[_ngcontent-%COMP%]   .filter-tag[_ngcontent-%COMP%]{float:left;margin-top:8px}.execution-select[_ngcontent-%COMP%]   .filter-tag[_ngcontent-%COMP%]   .clr-form-control[_ngcontent-%COMP%]{margin-top:0}.no-border[_ngcontent-%COMP%]:focus{outline:none}.margin-left-5[_ngcontent-%COMP%]{margin-left:5px}.pull-command-column[_ngcontent-%COMP%]{width:6rem!important}.co-signed-column[_ngcontent-%COMP%]{width:7rem!important}.vul-column[_ngcontent-%COMP%]{width:11rem!important}.annotations-column[_ngcontent-%COMP%]{width:5rem!important}.signed[_ngcontent-%COMP%]{color:#00d40f}.mb-05[_ngcontent-%COMP%]{margin-bottom:.5rem}.top-3-px[_ngcontent-%COMP%]{top:3px}.center[_ngcontent-%COMP%]{display:flex;align-items:center}.width-p-75[_ngcontent-%COMP%]{width:75%}.action-bar[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.signpost-item[_ngcontent-%COMP%]{margin-left:-24px;height:10px;display:flex;align-items:center}.margin-5px[_ngcontent-%COMP%]{margin:5px}.flex-max-width[_ngcontent-%COMP%]{max-width:220px;min-width:200px}.filter-grid[_ngcontent-%COMP%]{cursor:unset;padding:0}.filter-grid[_ngcontent-%COMP%]:hover{color:unset;background-color:unset}"]}),t})();const Pr=["newTagForm"],Rr=["confirmationDialog"];function Mr(t,r){if(1&t){const i=e.EpF();e.TgZ(0,"button",26),e.NdJ("click",function(){e.CHM(i);const o=e.oxw();return e.KtG(o.addTag())}),e._UZ(1,"clr-icon",27),e._uU(2),e.ALo(3,"translate"),e.qZA()}if(2&t){const i=e.oxw();e.Q6J("disabled",!i.hasCreateTagPermission),e.xp6(2),e.hij("\xa0",e.lcZ(3,2,"TAG.ADD_TAG")," ")}}function kr(t,r){1&t&&(e.TgZ(0,"clr-control-error",28),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"TAG.NAME_ALREADY_EXISTS")," "))}function Dr(t,r){1&t&&(e.TgZ(0,"clr-control-error",28),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"RETAG.TIP_TAG")," "))}function Ur(t,r){1&t&&(e.TgZ(0,"clr-dg-column"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"REPOSITORY.PULL_COMMAND")))}function Yr(t,r){1&t&&(e.TgZ(0,"clr-dg-column"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"ACCESSORY.NOTARY_SIGNED")))}function qr(t,r){1&t&&(e.TgZ(0,"span",34),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"REPOSITORY.IMMUTABLE")))}function Fr(t,r){if(1&t&&e._UZ(0,"hbr-copy-input",36),2&t){const i=e.oxw(2).$implicit,n=e.oxw();e.Q6J("title",n.getPullCommand(i))("iconMode",!0)("defaultValue",n.getPullCommand(i))}}function jr(t,r){if(1&t&&(e.TgZ(0,"clr-dg-cell"),e.YNc(1,Fr,1,3,"hbr-copy-input",35),e.qZA()),2&t){const i=e.oxw().$implicit,n=e.oxw();e.xp6(1),e.Q6J("ngIf",n.getPullCommand(i))}}function Br(t,r){1&t&&e._UZ(0,"clr-icon",42)}function Jr(t,r){1&t&&e._UZ(0,"clr-icon",43)}function Hr(t,r){1&t&&(e.TgZ(0,"a",44),e._UZ(1,"clr-icon",45),e.TgZ(2,"span",46),e._uU(3),e.ALo(4,"translate"),e.qZA()()),2&t&&(e.xp6(3),e.Oqu(e.lcZ(4,1,"REPOSITORY.NOTARY_IS_UNDETERMINED")))}function Qr(t,r){if(1&t&&(e.TgZ(0,"clr-dg-cell",37)(1,"div",38),e.YNc(2,Br,1,0,"clr-icon",39),e.YNc(3,Jr,1,0,"clr-icon",40),e.YNc(4,Hr,5,3,"a",41),e.qZA()()),2&t){const i=e.oxw().$implicit;e.Q6J("ngSwitch",i.signed),e.xp6(2),e.Q6J("ngSwitchCase",!0),e.xp6(1),e.Q6J("ngSwitchCase",!1)}}function Vr(t,r){if(1&t&&(e.TgZ(0,"clr-dg-row",29)(1,"clr-dg-cell")(2,"div",30)(3,"span",31),e._uU(4),e.qZA(),e.YNc(5,qr,3,3,"span",32),e.qZA()(),e.YNc(6,jr,2,1,"clr-dg-cell",18),e.YNc(7,Qr,5,3,"clr-dg-cell",33),e.TgZ(8,"clr-dg-cell"),e._uU(9),e.ALo(10,"harborDatetime"),e.qZA(),e.TgZ(11,"clr-dg-cell"),e._uU(12),e.ALo(13,"harborDatetime"),e.qZA()()),2&t){const i=r.$implicit,n=e.oxw();e.Q6J("clrDgItem",i),e.xp6(2),e.ekj("immutable",i.immutable),e.xp6(1),e.s9C("title",i.name),e.xp6(1),e.Oqu(i.name),e.xp6(1),e.Q6J("ngIf",i.immutable),e.xp6(1),e.Q6J("ngIf",n.hasPullCommand()),e.xp6(1),e.Q6J("ngIf",n.withNotary),e.xp6(2),e.Oqu(i.pull_time!==n.availableTime?e.xi3(10,10,i.pull_time,"short"):""),e.xp6(3),e.Oqu(e.xi3(13,13,i.push_time,"short"))}}function Gr(t,r){if(1&t&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.ALo(3,"translate"),e.qZA()),2&t){const i=e.oxw(),n=e.MAs(50);e.xp6(1),e.xDo("",n.firstItem+1," - ",n.lastItem+1," ",e.lcZ(2,5,"TAG.OF")," ",i.totalCount," ",e.lcZ(3,7,"TAG.ITEMS"),"")}}const zr=function(){return[15,25,50]};class Je{constructor(){this.name=""}}let Wr=(()=>{class t{constructor(i,n,o,a,l,c,p,g){this.operationService=i,this.artifactService=n,this.translateService=o,this.userPermissionService=a,this.systemInfoService=l,this.appConfigService=c,this.errorHandlerService=p,this.activatedRoute=g,this.isProxyCacheProject=!1,this.newTagName=new Je,this.selectedRow=[],this.isTagNameExist=!1,this.newTagformShow=!1,this.loading=!0,this.openTag=!1,this.availableTime=mt,this.totalCount=0,this.allTags=[],this.currentTags=[],this.pageSize=(0,u.tb)(u.V2.ARTIFACT_TAGS_COMPONENT),this.currentPage=1,this.tagNameChecker=new te.x,this.tagNameCheckOnGoing=!1,this.accessoryType=this.activatedRoute.snapshot.queryParams[X.ACCESSORY_TYPE]}ngOnInit(){this.getImagePermissionRule(this.projectId),this.invalidCreateTag(),this.systemInfoService.getSystemInfo().subscribe(i=>this.systemInfo=i,i=>this.errorHandlerService.error(i))}checkTagName(i){const n={projectName:this.projectName,repositoryName:(0,u.gI)(this.repositoryName),reference:this.artifactDetails.digest,withSignature:!0,withImmutableStatus:!0,q:encodeURIComponent(`name=${i}`)};return this.artifactService.listTags(n).pipe((0,L.x)(()=>this.tagNameCheckOnGoing=!1))}invalidCreateTag(){this.tagNameCheckSub||(this.tagNameCheckSub=this.tagNameChecker.pipe((0,Se.b)(500)).pipe((0,gt.x)()).pipe((0,Ue.w)(i=>(this.tagNameCheckOnGoing=!0,this.isTagNameExist=!1,this.checkTagName(i)))).subscribe(i=>{i&&i.length&&(this.isTagNameExist=!0)},i=>{this.errorHandlerService.error(i)}))}getCurrentArtifactTags(i){if(!i||!i.page)return;this.pageSize=i.page.size,(0,u.Pe)(u.V2.ARTIFACT_TAGS_COMPONENT,this.pageSize);let n=(0,u.wy)(i);n<=0&&(n=1);let o={projectName:this.projectName,repositoryName:(0,u.gI)(this.repositoryName),reference:this.artifactDetails.digest,page:n,withSignature:!0,withImmutableStatus:!0,pageSize:this.pageSize,sort:(0,u.td)(i)};this.loading=!0,this.artifactService.listTagsResponse(o).pipe((0,L.x)(()=>{this.loading=!1})).subscribe(a=>{if(a.headers){let l=a.headers.get("x-total-count");l&&(this.totalCount=Number.parseInt(l,10))}this.currentTags=a.body,this.currentTags=(0,u.Dd)(this.currentTags,i),this.currentTags=(0,u.Pq)(this.currentTags,i)},a=>{this.errorHandlerService.error(a)})}getImagePermissionRule(i){this.userPermissionService.hasProjectPermissions(this.projectId,[{resource:I._W.REPOSITORY_TAG.KEY,action:I._W.REPOSITORY_TAG.VALUE.DELETE},{resource:I._W.REPOSITORY_TAG.KEY,action:I._W.REPOSITORY_TAG.VALUE.CREATE}]).subscribe(o=>{this.hasDeleteTagPermission=o[0],this.hasCreateTagPermission=o[1]},o=>this.errorHandlerService.error(o))}addTag(){this.newTagformShow=!0}cancelAddTag(){this.newTagformShow=!1,this.newTagName=new Je}saveAddTag(){const i={projectName:this.projectName,repositoryName:(0,u.gI)(this.repositoryName),reference:this.artifactDetails.digest,tag:this.newTagName};this.loading=!0,this.artifactService.createTag(i).subscribe(n=>{this.newTagformShow=!1,this.newTagName=new Je,this.refresh()},n=>{this.loading=!1,this.errorHandlerService.error(n)})}removeTag(){if(this.selectedRow&&this.selectedRow.length){let n,o,a,l,i=[];this.selectedRow.forEach(p=>{i.push(p.name)}),n="REPOSITORY.DELETION_TITLE_TAG",o="REPOSITORY.DELETION_SUMMARY_TAG",l=2,a=i.join(" , ");let c=new Ie.c(n,o,a,this.selectedRow,9,l);this.confirmationDialog.open(c)}}confirmDeletion(i){if(i&&9===i.source&&1===i.state){let n=i.data;if(n&&n.length){let o=[];n.forEach(a=>{o.push(this.delOperate(a))}),this.loading=!0,(0,G.D)(...o).subscribe(a=>{let l=[],c=[];a.forEach(p=>{p?c.push(p):l.push(p)}),this.selectedRow=[],l.length===a.length?this.refresh():c.length===a.length?(this.loading=!1,this.errorHandlerService.error(a[a.length-1])):(this.errorHandlerService.error(c[c.length-1]),this.currentPage=1,this.getCurrentArtifactTags({page:{from:0,to:this.pageSize-1,size:this.pageSize}}))})}}}deletePort(i){return i&&-1!==i.indexOf(":")?i.split(":")[0]:i}delOperate(i){let n=new w.gB;if(n.name="OPERATION.DELETE_TAG",n.state=w.yb.progressing,n.data.name=i.name,this.operationService.publishInfo(n),i.signed)return(0,G.D)(this.translateService.get("BATCH.DELETED_FAILURE"),this.translateService.get("REPOSITORY.DELETION_SUMMARY_TAG_DENIED")).subscribe(o=>{const a=o[1]+"notary -s https://"+this.deletePort(this.registryUrl)+":4443 -d ~/.docker/trust remove -p "+this.registryUrl+"/"+this.repositoryName+" "+i.name;(0,w.hm)(n,w.yb.failure,a)}),(0,ve.of)(null);{const o={projectName:this.projectName,repositoryName:(0,u.gI)(this.repositoryName),reference:this.artifactDetails.digest,tagName:i.name};return this.artifactService.deleteTag(o).pipe((0,se.U)(a=>{this.translateService.get("BATCH.DELETED_SUCCESS").subscribe(l=>{(0,w.hm)(n,w.yb.success)})}),(0,Me.K)(a=>{const l=(0,De.Po)(a);return this.translateService.get(l).subscribe(c=>(0,w.hm)(n,w.yb.failure,c)),(0,ve.of)(a)}))}}existValid(i){i?this.tagNameChecker.next(i):this.isTagNameExist=!1}toggleTagListOpenOrClose(){this.openTag=!this.openTag,this.newTagformShow=!1}hasImmutableOnTag(){return this.selectedRow.some(i=>i.immutable)}refresh(){this.loading=!0,this.currentPage=1,this.selectedRow=[],this.getCurrentArtifactTags({page:{from:0,to:this.pageSize-1,size:this.pageSize}})}ngOnDestroy(){this.tagNameCheckSub.unsubscribe()}get withNotary(){return this.appConfigService.getConfig().with_notary}get registryUrl(){return this.systemInfo&&this.systemInfo.registry_url?this.systemInfo.registry_url:location.hostname}hasPullCommand(){return this.artifactDetails&&(this.artifactDetails.type===F.IMAGE||this.artifactDetails.type===F.CHART||this.artifactDetails.type===F.CNAB)&&this.accessoryType!==W.COSIGN&&this.accessoryType!==W.NYDUS}getPullCommand(i){let n="";return i&&i.name&&this.artifactDetails&&(n=lt(this.artifactDetails?.type,`${this.registryUrl}/${this.projectName}/${this.repositoryName}`,i.name)),n}}return t.\u0275fac=function(i){return new(i||t)(e.Y36(pt.f9),e.Y36(ee.b),e.Y36(b.sK),e.Y36(I.Hx),e.Y36(I.Ob),e.Y36(Ye._),e.Y36(R.q),e.Y36(Z.gz))},t.\u0275cmp=e.Xpm({type:t,selectors:[["artifact-tag"]],viewQuery:function(i,n){if(1&i&&(e.Gf(Pr,7),e.Gf(Rr,5)),2&i){let o;e.iGM(o=e.CRH())&&(n.currentForm=o.first),e.iGM(o=e.CRH())&&(n.confirmationDialog=o.first)}},inputs:{artifactDetails:"artifactDetails",projectName:"projectName",isProxyCacheProject:"isProxyCacheProject",projectId:"projectId",repositoryName:"repositoryName"},decls:57,vars:54,consts:[[3,"clrDgLoading","clrDgSelected","clrDgRefresh","clrDgSelectedChange"],["id","new-tag","type","button","class","btn btn-secondary",3,"disabled","click",4,"ngIf"],["id","delete-tag","type","button",1,"btn","btn-secondary",3,"disabled","click"],["shape","trash","size","16"],[1,"refresh-btn",3,"click"],["shape","refresh"],[1,"label-form","stack-block-label",3,"hidden"],["tagForm","ngForm"],["for","name"],[1,"clr-control-container"],["clrInput","","type","text","id","name","name","name","required","","size","20","autocomplete","off","pattern","^[\\w][\\w.-]{0,127}$",3,"ngModel","ngModelChange","keyup"],["name","ngModel"],[1,"spinner","spinner-inline","spinner-tag",3,"hidden"],["class","position-ab white-space-nowrap",4,"ngIf"],[1,"ml-1"],["type","button",1,"btn","btn-sm","btn-outline",3,"click"],["id","add-ok","type","submit",1,"btn","btn-sm","btn-primary",3,"disabled","click"],[3,"clrDgField"],[4,"ngIf"],[3,"clrDgSortBy"],[3,"clrDgItem",4,"ngFor","ngForOf"],[3,"clrDgTotalItems","clrDgPage","clrDgPageSize","clrDgPageChange"],["pagination",""],[3,"clrPageSizeOptions"],[1,"hidden-tag",3,"confirmAction"],["confirmationDialog",""],["id","new-tag","type","button",1,"btn","btn-secondary",3,"disabled","click"],["shape","plus","size","16"],[1,"position-ab","white-space-nowrap"],[3,"clrDgItem"],[1,"cell","white-normal"],["href","javascript:void(0)",1,"max-width-100",3,"title"],["class","label label-info ml-8",4,"ngIf"],[3,"ngSwitch",4,"ngIf"],[1,"label","label-info","ml-8"],[3,"title","iconMode","defaultValue",4,"ngIf"],[3,"title","iconMode","defaultValue"],[3,"ngSwitch"],[1,"cell"],["shape","check-circle","size","20","class","color-green",4,"ngSwitchCase"],["shape","times-circle","size","16","class","color-red",4,"ngSwitchCase"],["href","javascript:void(0)","role","tooltip","aria-haspopup","true","class","tooltip tooltip-top-right",4,"ngSwitchDefault"],["shape","check-circle","size","20",1,"color-green"],["shape","times-circle","size","16",1,"color-red"],["href","javascript:void(0)","role","tooltip","aria-haspopup","true",1,"tooltip","tooltip-top-right"],["shape","help","size","16",1,"color-gray"],[1,"tooltip-content"]],template:function(i,n){if(1&i&&(e.TgZ(0,"h4"),e._uU(1),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"clr-datagrid",0),e.NdJ("clrDgRefresh",function(a){return n.getCurrentArtifactTags(a)})("clrDgSelectedChange",function(a){return n.selectedRow=a}),e.TgZ(4,"clr-dg-action-bar"),e.YNc(5,Mr,4,4,"button",1),e.TgZ(6,"button",2),e.NdJ("click",function(){return n.removeTag()}),e._UZ(7,"clr-icon",3),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"span",4),e.NdJ("click",function(){return n.refresh()}),e._UZ(11,"clr-icon",5),e.qZA(),e.TgZ(12,"form",6,7)(14,"section")(15,"label")(16,"label",8),e._uU(17),e.ALo(18,"translate"),e.qZA(),e.TgZ(19,"label",9)(20,"input",10,11),e.NdJ("ngModelChange",function(a){return n.newTagName.name=a})("keyup",function(){return n.existValid(n.newTagName.name)}),e.qZA(),e._UZ(22,"span",12),e.YNc(23,kr,3,3,"clr-control-error",13),e.YNc(24,Dr,3,3,"clr-control-error",13),e.qZA()(),e.TgZ(25,"label",14)(26,"button",15),e.NdJ("click",function(){return n.cancelAddTag()}),e._uU(27),e.ALo(28,"translate"),e.qZA(),e.TgZ(29,"button",16),e.NdJ("click",function(){return n.saveAddTag()}),e._uU(30),e.ALo(31,"translate"),e.qZA()()()()(),e.TgZ(32,"clr-dg-column",17),e._uU(33),e.ALo(34,"translate"),e.qZA(),e.YNc(35,Ur,3,3,"clr-dg-column",18),e.YNc(36,Yr,3,3,"clr-dg-column",18),e.TgZ(37,"clr-dg-column",19),e._uU(38),e.ALo(39,"translate"),e.qZA(),e.TgZ(40,"clr-dg-column",19),e._uU(41),e.ALo(42,"translate"),e.qZA(),e.TgZ(43,"clr-dg-placeholder")(44,"span"),e._uU(45),e.ALo(46,"translate"),e.qZA()(),e.YNc(47,Vr,14,16,"clr-dg-row",20),e.TgZ(48,"clr-dg-footer")(49,"clr-dg-pagination",21,22),e.NdJ("clrDgPageChange",function(a){return n.currentPage=a}),e.TgZ(51,"clr-dg-page-size",23),e._uU(52),e.ALo(53,"translate"),e.qZA(),e.YNc(54,Gr,4,9,"span",18),e.qZA()()(),e.TgZ(55,"confirmation-dialog",24,25),e.NdJ("confirmAction",function(a){return n.confirmDeletion(a)}),e.qZA()),2&i){const o=e.MAs(13),a=e.MAs(21);e.xp6(1),e.Oqu(e.lcZ(2,33,"REPOSITORY.TAGS")),e.xp6(2),e.Q6J("clrDgLoading",n.loading)("clrDgSelected",n.selectedRow),e.xp6(2),e.Q6J("ngIf",!n.isProxyCacheProject),e.xp6(1),e.Q6J("disabled",!(n.selectedRow.length>=1&&!n.hasImmutableOnTag()&&n.hasDeleteTagPermission)),e.xp6(2),e.hij("\xa0",e.lcZ(9,35,"TAG.REMOVE_TAG")," "),e.xp6(4),e.Q6J("hidden",!n.newTagformShow),e.xp6(5),e.Oqu(e.lcZ(18,37,"TAG.NAME")),e.xp6(2),e.ekj("clr-error",n.isTagNameExist||a.hasError("pattern")),e.xp6(1),e.Q6J("ngModel",n.newTagName.name),e.xp6(2),e.Q6J("hidden",!n.tagNameCheckOnGoing),e.xp6(1),e.Q6J("ngIf",n.isTagNameExist),e.xp6(1),e.Q6J("ngIf",a.hasError("pattern")),e.xp6(3),e.hij(" ",e.lcZ(28,39,"BUTTON.CANCEL")," "),e.xp6(2),e.Q6J("disabled",n.isTagNameExist||n.tagNameCheckOnGoing||!n.newTagName.name||o.invalid),e.xp6(1),e.hij(" ",e.lcZ(31,41,"BUTTON.OK")," "),e.xp6(2),e.Q6J("clrDgField","name"),e.xp6(1),e.Oqu(e.lcZ(34,43,"TAG.NAME")),e.xp6(2),e.Q6J("ngIf",n.hasPullCommand()),e.xp6(1),e.Q6J("ngIf",n.withNotary),e.xp6(1),e.Q6J("clrDgSortBy","pull_time"),e.xp6(1),e.Oqu(e.lcZ(39,45,"TAG.PULL_TIME")),e.xp6(2),e.Q6J("clrDgSortBy","push_time"),e.xp6(1),e.Oqu(e.lcZ(42,47,"TAG.PUSH_TIME")),e.xp6(4),e.Oqu(e.lcZ(46,49,"TAG.PLACEHOLDER")),e.xp6(2),e.Q6J("ngForOf",n.currentTags),e.xp6(2),e.Q6J("clrDgTotalItems",n.totalCount)("clrDgPage",n.currentPage)("clrDgPageSize",n.pageSize),e.xp6(2),e.Q6J("clrPageSizeOptions",e.DdM(53,zr)),e.xp6(1),e.Oqu(e.lcZ(53,51,"PAGINATION.PAGE_SIZE")),e.xp6(2),e.Q6J("ngIf",n.totalCount)}},dependencies:[x._Y,x.Fj,x.JJ,x.JL,x.Q7,x.c5,x.On,x.F,s.C9t,s.Gwl,s.m4W,s.Z4N,s.fv_,s.dRQ,s.Ltv,s.YYR,s.F7K,s.PDs,s.KHL,s.Gcc,s.jND,s.Nh1,s.dml,s.K8c,s.qvL,s.MgK,s.VqA,s.xRP,A.sg,A.O5,A.RF,A.n9,A.ED,qe.z,ut.s,b.X$,ue.Z],styles:[".label-form[_ngcontent-%COMP%]{max-width:100%!important}.clr-control-container[_ngcontent-%COMP%]{margin-bottom:1rem;position:relative}.btn.remove-btn[_ngcontent-%COMP%]{border:none;height:.6rem;line-height:1}.immutable[_ngcontent-%COMP%]{display:flex;align-items:center;position:relative}.immutable[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{position:absolute;right:0;margin-right:0}.datagrid-action-bar[_ngcontent-%COMP%]{margin-top:.5rem}.position-ab[_ngcontent-%COMP%]{position:absolute}.white-space-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.refresh-btn[_ngcontent-%COMP%]{float:right;margin-top:15px;margin-right:20px;cursor:pointer}.spinner-tag[_ngcontent-%COMP%]{position:absolute;right:-.7rem;top:1.2rem}"]}),t})();function Xr(t,r){if(1&t&&(e.TgZ(0,"clr-stack-block")(1,"clr-stack-label"),e._uU(2),e.qZA(),e.TgZ(3,"clr-stack-content"),e._uU(4),e.qZA()()),2&t){const i=r.$implicit;e.xp6(2),e.Oqu(null==i?null:i.key),e.xp6(2),e.Oqu(null==i?null:i.value)}}function eo(t,r){if(1&t&&(e.ynx(0),e.TgZ(1,"h4",1),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"clr-stack-view")(5,"clr-stack-block",2)(6,"clr-stack-label"),e._uU(7),e.ALo(8,"translate"),e.qZA(),e.YNc(9,Xr,5,2,"clr-stack-block",3),e.ALo(10,"keyvalue"),e.qZA()(),e.BQk()),2&t){const i=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,4,"ARTIFACT.OVERVIEW")),e.xp6(3),e.Q6J("clrSbExpanded",!0),e.xp6(2),e.Oqu(e.lcZ(8,6,"ARTIFACT.OVERVIEW")),e.xp6(2),e.Q6J("ngForOf",e.lcZ(10,8,i.commonProperties))}}var Oe=(()=>{return(t=Oe||(Oe={})).CREATED="created",t.TYPE="type",t.MEDIA_TYPE="media_type",t.MANIFEST_MEDIA_TYPE="manifest_media_type",t.DIGEST="digest",t.SIZE="size",t.PUSH_TIME="push_time",t.PULL_TIME="pull_time",Oe;var t})();let to=(()=>{class t{constructor(){this.commonProperties={}}ngOnChanges(i){if(i&&i.artifactDetails&&this.artifactDetails){Object.assign(this.commonProperties,this.artifactDetails.extra_attrs,this.artifactDetails.annotations);for(let n in this.commonProperties)this.commonProperties.hasOwnProperty(n)&&("object"==typeof this.commonProperties[n]&&(this.commonProperties[n]=null===this.commonProperties[n]?"":JSON.stringify(this.commonProperties[n])),n===Oe.CREATED&&(this.commonProperties[n]=new A.uU("en-us").transform(this.commonProperties[n],"short")))}}hasCommonProperties(){return"{}"!==JSON.stringify(this.commonProperties)}}return t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=e.Xpm({type:t,selectors:[["artifact-common-properties"]],inputs:{artifactDetails:"artifactDetails"},features:[e.TTD],decls:1,vars:1,consts:[[4,"ngIf"],[1,"margin-bottom-075"],[3,"clrSbExpanded"],[4,"ngFor","ngForOf"]],template:function(i,n){1&i&&e.YNc(0,eo,11,10,"ng-container",0),2&i&&e.Q6J("ngIf",n.hasCommonProperties())},dependencies:[s.Jyd,s.O1G,s.W3d,s.PtE,A.sg,A.O5,b.X$,A.Nd],styles:[".margin-bottom-075[_ngcontent-%COMP%]{margin-bottom:.75rem}"]}),t})();var E_isObject=function io(t){return"object"==typeof t&&null!==t},E_repeat=function oo(t,r){var n,i="";for(n=0;n<r;n+=1)i+=t;return i},E_isNegativeZero=function ao(t){return 0===t&&Number.NEGATIVE_INFINITY===1/t};function bt(t,r){var i="",n=t.reason||"(unknown reason)";return t.mark?(t.mark.name&&(i+='in "'+t.mark.name+'" '),i+="("+(t.mark.line+1)+":"+(t.mark.column+1)+")",!r&&t.mark.snippet&&(i+="\n\n"+t.mark.snippet),n+" "+i):n}function me(t,r){Error.call(this),this.name="YAMLException",this.reason=t,this.mark=r,this.message=bt(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack||""}(me.prototype=Object.create(Error.prototype)).constructor=me,me.prototype.toString=function(r){return this.name+": "+bt(this,r)};var U=me;function He(t,r,i,n,o){var a="",l="",c=Math.floor(o/2)-1;return n-r>c&&(r=n-c+(a=" ... ").length),i-n>c&&(i=n+c-(l=" ...").length),{str:a+t.slice(r,i).replace(/\t/g,"\u2192")+l,pos:n-r+a.length}}function Qe(t,r){return E_repeat(" ",r-t.length)+t}var mo=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],_o=["scalar","sequence","mapping"],P=function To(t,r){if(r=r||{},Object.keys(r).forEach(function(i){if(-1===mo.indexOf(i))throw new U('Unknown option "'+i+'" is met in definition of "'+t+'" YAML type.')}),this.options=r,this.tag=t,this.kind=r.kind||null,this.resolve=r.resolve||function(){return!0},this.construct=r.construct||function(i){return i},this.instanceOf=r.instanceOf||null,this.predicate=r.predicate||null,this.represent=r.represent||null,this.representName=r.representName||null,this.defaultStyle=r.defaultStyle||null,this.multi=r.multi||!1,this.styleAliases=function Ao(t){var r={};return null!==t&&Object.keys(t).forEach(function(i){t[i].forEach(function(n){r[String(n)]=i})}),r}(r.styleAliases||null),-1===_o.indexOf(this.kind))throw new U('Unknown kind "'+this.kind+'" is specified for "'+t+'" YAML type.')};function xt(t,r){var i=[];return t[r].forEach(function(n){var o=i.length;i.forEach(function(a,l){a.tag===n.tag&&a.kind===n.kind&&a.multi===n.multi&&(o=l)}),i[o]=n}),i}function Ve(t){return this.extend(t)}Ve.prototype.extend=function(r){var i=[],n=[];if(r instanceof P)n.push(r);else if(Array.isArray(r))n=n.concat(r);else{if(!r||!Array.isArray(r.implicit)&&!Array.isArray(r.explicit))throw new U("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");r.implicit&&(i=i.concat(r.implicit)),r.explicit&&(n=n.concat(r.explicit))}i.forEach(function(a){if(!(a instanceof P))throw new U("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(a.loadKind&&"scalar"!==a.loadKind)throw new U("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(a.multi)throw new U("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),n.forEach(function(a){if(!(a instanceof P))throw new U("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var o=Object.create(Ve.prototype);return o.implicit=(this.implicit||[]).concat(i),o.explicit=(this.explicit||[]).concat(n),o.compiledImplicit=xt(o,"implicit"),o.compiledExplicit=xt(o,"explicit"),o.compiledTypeMap=function bo(){var r,i,t={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}};function n(o){o.multi?(t.multi[o.kind].push(o),t.multi.fallback.push(o)):t[o.kind][o.tag]=t.fallback[o.tag]=o}for(r=0,i=arguments.length;r<i;r+=1)arguments[r].forEach(n);return t}(o.compiledImplicit,o.compiledExplicit),o};var St=new Ve({explicit:[new P("tag:yaml.org,2002:str",{kind:"scalar",construct:function(t){return null!==t?t:""}}),new P("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(t){return null!==t?t:[]}}),new P("tag:yaml.org,2002:map",{kind:"mapping",construct:function(t){return null!==t?t:{}}})]}),Ot=new P("tag:yaml.org,2002:null",{kind:"scalar",resolve:function xo(t){if(null===t)return!0;var r=t.length;return 1===r&&"~"===t||4===r&&("null"===t||"Null"===t||"NULL"===t)},construct:function Co(){return null},predicate:function vo(t){return null===t},represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"}),Lt=new P("tag:yaml.org,2002:bool",{kind:"scalar",resolve:function Io(t){if(null===t)return!1;var r=t.length;return 4===r&&("true"===t||"True"===t||"TRUE"===t)||5===r&&("false"===t||"False"===t||"FALSE"===t)},construct:function yo(t){return"true"===t||"True"===t||"TRUE"===t},predicate:function So(t){return"[object Boolean]"===Object.prototype.toString.call(t)},represent:{lowercase:function(t){return t?"true":"false"},uppercase:function(t){return t?"TRUE":"FALSE"},camelcase:function(t){return t?"True":"False"}},defaultStyle:"lowercase"});function Oo(t){return 48<=t&&t<=57||65<=t&&t<=70||97<=t&&t<=102}function Lo(t){return 48<=t&&t<=55}function wo(t){return 48<=t&&t<=57}var wt=new P("tag:yaml.org,2002:int",{kind:"scalar",resolve:function No(t){if(null===t)return!1;var o,r=t.length,i=0,n=!1;if(!r)return!1;if(("-"===(o=t[i])||"+"===o)&&(o=t[++i]),"0"===o){if(i+1===r)return!0;if("b"===(o=t[++i])){for(i++;i<r;i++)if("_"!==(o=t[i])){if("0"!==o&&"1"!==o)return!1;n=!0}return n&&"_"!==o}if("x"===o){for(i++;i<r;i++)if("_"!==(o=t[i])){if(!Oo(t.charCodeAt(i)))return!1;n=!0}return n&&"_"!==o}if("o"===o){for(i++;i<r;i++)if("_"!==(o=t[i])){if(!Lo(t.charCodeAt(i)))return!1;n=!0}return n&&"_"!==o}}if("_"===o)return!1;for(;i<r;i++)if("_"!==(o=t[i])){if(!wo(t.charCodeAt(i)))return!1;n=!0}return!(!n||"_"===o)},construct:function Zo(t){var n,r=t,i=1;if(-1!==r.indexOf("_")&&(r=r.replace(/_/g,"")),("-"===(n=r[0])||"+"===n)&&("-"===n&&(i=-1),n=(r=r.slice(1))[0]),"0"===r)return 0;if("0"===n){if("b"===r[1])return i*parseInt(r.slice(2),2);if("x"===r[1])return i*parseInt(r.slice(2),16);if("o"===r[1])return i*parseInt(r.slice(2),8)}return i*parseInt(r,10)},predicate:function Eo(t){return"[object Number]"===Object.prototype.toString.call(t)&&t%1==0&&!E_isNegativeZero(t)},represent:{binary:function(t){return t>=0?"0b"+t.toString(2):"-0b"+t.toString(2).slice(1)},octal:function(t){return t>=0?"0o"+t.toString(8):"-0o"+t.toString(8).slice(1)},decimal:function(t){return t.toString(10)},hexadecimal:function(t){return t>=0?"0x"+t.toString(16).toUpperCase():"-0x"+t.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),Po=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$"),ko=/^[-+]?[0-9]+e/,Nt=new P("tag:yaml.org,2002:float",{kind:"scalar",resolve:function Ro(t){return!(null===t||!Po.test(t)||"_"===t[t.length-1])},construct:function Mo(t){var r,i;return i="-"===(r=t.replace(/_/g,"").toLowerCase())[0]?-1:1,"+-".indexOf(r[0])>=0&&(r=r.slice(1)),".inf"===r?1===i?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:".nan"===r?NaN:i*parseFloat(r,10)},predicate:function Uo(t){return"[object Number]"===Object.prototype.toString.call(t)&&(t%1!=0||E_isNegativeZero(t))},represent:function Do(t,r){var i;if(isNaN(t))switch(r){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===t)switch(r){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===t)switch(r){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(E_isNegativeZero(t))return"-0.0";return i=t.toString(10),ko.test(i)?i.replace("e",".e"):i},defaultStyle:"lowercase"}),Et=St.extend({implicit:[Ot,Lt,wt,Nt]}),Pt=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),Rt=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$"),Mt=new P("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:function Yo(t){return null!==t&&(null!==Pt.exec(t)||null!==Rt.exec(t))},construct:function qo(t){var r,i,n,o,a,l,c,d,p=0,g=null;if(null===(r=Pt.exec(t))&&(r=Rt.exec(t)),null===r)throw new Error("Date resolve error");if(i=+r[1],n=+r[2]-1,o=+r[3],!r[4])return new Date(Date.UTC(i,n,o));if(a=+r[4],l=+r[5],c=+r[6],r[7]){for(p=r[7].slice(0,3);p.length<3;)p+="0";p=+p}return r[9]&&(g=6e4*(60*+r[10]+ +(r[11]||0)),"-"===r[9]&&(g=-g)),d=new Date(Date.UTC(i,n,o,a,l,c,p)),g&&d.setTime(d.getTime()-g),d},instanceOf:Date,represent:function Fo(t){return t.toISOString()}}),kt=new P("tag:yaml.org,2002:merge",{kind:"scalar",resolve:function jo(t){return"<<"===t||null===t}}),Ge="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\n\r",Dt=new P("tag:yaml.org,2002:binary",{kind:"scalar",resolve:function Bo(t){if(null===t)return!1;var r,i,n=0,o=t.length,a=Ge;for(i=0;i<o;i++)if(!((r=a.indexOf(t.charAt(i)))>64)){if(r<0)return!1;n+=6}return n%8==0},construct:function Jo(t){var r,i,n=t.replace(/[\r\n=]/g,""),o=n.length,a=Ge,l=0,c=[];for(r=0;r<o;r++)r%4==0&&r&&(c.push(l>>16&255),c.push(l>>8&255),c.push(255&l)),l=l<<6|a.indexOf(n.charAt(r));return 0==(i=o%4*6)?(c.push(l>>16&255),c.push(l>>8&255),c.push(255&l)):18===i?(c.push(l>>10&255),c.push(l>>2&255)):12===i&&c.push(l>>4&255),new Uint8Array(c)},predicate:function Qo(t){return"[object Uint8Array]"===Object.prototype.toString.call(t)},represent:function Ho(t){var n,o,r="",i=0,a=t.length,l=Ge;for(n=0;n<a;n++)n%3==0&&n&&(r+=l[i>>18&63],r+=l[i>>12&63],r+=l[i>>6&63],r+=l[63&i]),i=(i<<8)+t[n];return 0==(o=a%3)?(r+=l[i>>18&63],r+=l[i>>12&63],r+=l[i>>6&63],r+=l[63&i]):2===o?(r+=l[i>>10&63],r+=l[i>>4&63],r+=l[i<<2&63],r+=l[64]):1===o&&(r+=l[i>>2&63],r+=l[i<<4&63],r+=l[64],r+=l[64]),r}}),Vo=Object.prototype.hasOwnProperty,Go=Object.prototype.toString,Ut=new P("tag:yaml.org,2002:omap",{kind:"sequence",resolve:function zo(t){if(null===t)return!0;var i,n,o,a,l,r=[],c=t;for(i=0,n=c.length;i<n;i+=1){if(l=!1,"[object Object]"!==Go.call(o=c[i]))return!1;for(a in o)if(Vo.call(o,a)){if(l)return!1;l=!0}if(!l)return!1;if(-1!==r.indexOf(a))return!1;r.push(a)}return!0},construct:function $o(t){return null!==t?t:[]}}),Ko=Object.prototype.toString,Yt=new P("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:function Wo(t){if(null===t)return!0;var r,i,n,o,a,l=t;for(a=new Array(l.length),r=0,i=l.length;r<i;r+=1){if("[object Object]"!==Ko.call(n=l[r])||1!==(o=Object.keys(n)).length)return!1;a[r]=[o[0],n[o[0]]]}return!0},construct:function Xo(t){if(null===t)return[];var r,i,n,o,a,l=t;for(a=new Array(l.length),r=0,i=l.length;r<i;r+=1)n=l[r],o=Object.keys(n),a[r]=[o[0],n[o[0]]];return a}}),ea=Object.prototype.hasOwnProperty,qt=new P("tag:yaml.org,2002:set",{kind:"mapping",resolve:function ta(t){if(null===t)return!0;var r,i=t;for(r in i)if(ea.call(i,r)&&null!==i[r])return!1;return!0},construct:function ia(t){return null!==t?t:{}}}),ze=Et.extend({implicit:[Mt,kt],explicit:[Dt,Ut,Yt,qt]}),z=Object.prototype.hasOwnProperty,ra=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,oa=/[\x85\u2028\u2029]/,aa=/[,\[\]\{\}]/,Jt=/^(?:!|!!|![a-z\-]+!)$/i,Ht=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function Qt(t){return Object.prototype.toString.call(t)}function H(t){return 10===t||13===t}function K(t){return 9===t||32===t}function Y(t){return 9===t||32===t||10===t||13===t}function ne(t){return 44===t||91===t||93===t||123===t||125===t}function la(t){var r;return 48<=t&&t<=57?t-48:97<=(r=32|t)&&r<=102?r-97+10:-1}function ca(t){return 120===t?2:117===t?4:85===t?8:0}function sa(t){return 48<=t&&t<=57?t-48:-1}function Vt(t){return 48===t?"\0":97===t?"\x07":98===t?"\b":116===t||9===t?"\t":110===t?"\n":118===t?"\v":102===t?"\f":114===t?"\r":101===t?"\x1b":32===t?" ":34===t?'"':47===t?"/":92===t?"\\":78===t?"\x85":95===t?"\xa0":76===t?"\u2028":80===t?"\u2029":""}function pa(t){return t<=65535?String.fromCharCode(t):String.fromCharCode(55296+(t-65536>>10),56320+(t-65536&1023))}for(var Gt=new Array(256),zt=new Array(256),re=0;re<256;re++)Gt[re]=Vt(re)?1:0,zt[re]=Vt(re);function ua(t,r){this.input=t,this.filename=r.filename||null,this.schema=r.schema||ze,this.onWarning=r.onWarning||null,this.legacy=r.legacy||!1,this.json=r.json||!1,this.listener=r.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=t.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function $t(t,r){var i={name:t.filename,buffer:t.input.slice(0,-1),position:t.position,line:t.line,column:t.position-t.lineStart};return i.snippet=function fo(t,r){if(r=Object.create(r||null),!t.buffer)return null;r.maxLength||(r.maxLength=79),"number"!=typeof r.indent&&(r.indent=1),"number"!=typeof r.linesBefore&&(r.linesBefore=3),"number"!=typeof r.linesAfter&&(r.linesAfter=2);for(var a,i=/\r?\n|\r|\0/g,n=[0],o=[],l=-1;a=i.exec(t.buffer);)o.push(a.index),n.push(a.index+a[0].length),t.position<=a.index&&l<0&&(l=n.length-2);l<0&&(l=n.length-1);var p,g,c="",h=Math.min(t.line+r.linesAfter,o.length).toString().length,f=r.maxLength-(r.indent+h+3);for(p=1;p<=r.linesBefore&&!(l-p<0);p++)g=He(t.buffer,n[l-p],o[l-p],t.position-(n[l]-n[l-p]),f),c=E_repeat(" ",r.indent)+Qe((t.line-p+1).toString(),h)+" | "+g.str+"\n"+c;for(g=He(t.buffer,n[l],o[l],t.position,f),c+=E_repeat(" ",r.indent)+Qe((t.line+1).toString(),h)+" | "+g.str+"\n",c+=E_repeat("-",r.indent+h+3+g.pos)+"^\n",p=1;p<=r.linesAfter&&!(l+p>=o.length);p++)g=He(t.buffer,n[l+p],o[l+p],t.position-(n[l]-n[l+p]),f),c+=E_repeat(" ",r.indent)+Qe((t.line+p+1).toString(),h)+" | "+g.str+"\n";return c.replace(/\n$/,"")}(i),new U(r,i)}function m(t,r){throw $t(t,r)}function Ne(t,r){t.onWarning&&t.onWarning.call(null,$t(t,r))}var Kt={YAML:function(r,i,n){var o,a,l;null!==r.version&&m(r,"duplication of %YAML directive"),1!==n.length&&m(r,"YAML directive accepts exactly one argument"),null===(o=/^([0-9]+)\.([0-9]+)$/.exec(n[0]))&&m(r,"ill-formed argument of the YAML directive"),a=parseInt(o[1],10),l=parseInt(o[2],10),1!==a&&m(r,"unacceptable YAML version of the document"),r.version=n[0],r.checkLineBreaks=l<2,1!==l&&2!==l&&Ne(r,"unsupported YAML version of the document")},TAG:function(r,i,n){var o,a;2!==n.length&&m(r,"TAG directive accepts exactly two arguments"),a=n[1],Jt.test(o=n[0])||m(r,"ill-formed tag handle (first argument) of the TAG directive"),z.call(r.tagMap,o)&&m(r,'there is a previously declared suffix for "'+o+'" tag handle'),Ht.test(a)||m(r,"ill-formed tag prefix (second argument) of the TAG directive");try{a=decodeURIComponent(a)}catch{m(r,"tag prefix is malformed: "+a)}r.tagMap[o]=a}};function $(t,r,i,n){var o,a,l,c;if(r<i){if(c=t.input.slice(r,i),n)for(o=0,a=c.length;o<a;o+=1)9===(l=c.charCodeAt(o))||32<=l&&l<=1114111||m(t,"expected valid JSON character");else ra.test(c)&&m(t,"the stream contains non-printable characters");t.result+=c}}function Wt(t,r,i,n){var o,a,l,c;for(E_isObject(i)||m(t,"cannot merge mappings; the provided source object is unacceptable"),l=0,c=(o=Object.keys(i)).length;l<c;l+=1)z.call(r,a=o[l])||(r[a]=i[a],n[a]=!0)}function oe(t,r,i,n,o,a,l,c,p){var g,h;if(Array.isArray(o))for(g=0,h=(o=Array.prototype.slice.call(o)).length;g<h;g+=1)Array.isArray(o[g])&&m(t,"nested arrays are not supported inside keys"),"object"==typeof o&&"[object Object]"===Qt(o[g])&&(o[g]="[object Object]");if("object"==typeof o&&"[object Object]"===Qt(o)&&(o="[object Object]"),o=String(o),null===r&&(r={}),"tag:yaml.org,2002:merge"===n)if(Array.isArray(a))for(g=0,h=a.length;g<h;g+=1)Wt(t,r,a[g],i);else Wt(t,r,a,i);else!t.json&&!z.call(i,o)&&z.call(r,o)&&(t.line=l||t.line,t.lineStart=c||t.lineStart,t.position=p||t.position,m(t,"duplicated mapping key")),"__proto__"===o?Object.defineProperty(r,o,{configurable:!0,enumerable:!0,writable:!0,value:a}):r[o]=a,delete i[o];return r}function Ke(t){var r;10===(r=t.input.charCodeAt(t.position))?t.position++:13===r?(t.position++,10===t.input.charCodeAt(t.position)&&t.position++):m(t,"a line break is expected"),t.line+=1,t.lineStart=t.position,t.firstTabInLine=-1}function N(t,r,i){for(var n=0,o=t.input.charCodeAt(t.position);0!==o;){for(;K(o);)9===o&&-1===t.firstTabInLine&&(t.firstTabInLine=t.position),o=t.input.charCodeAt(++t.position);if(r&&35===o)do{o=t.input.charCodeAt(++t.position)}while(10!==o&&13!==o&&0!==o);if(!H(o))break;for(Ke(t),o=t.input.charCodeAt(t.position),n++,t.lineIndent=0;32===o;)t.lineIndent++,o=t.input.charCodeAt(++t.position)}return-1!==i&&0!==n&&t.lineIndent<i&&Ne(t,"deficient indentation"),n}function Ze(t){var i,r=t.position;return!(45!==(i=t.input.charCodeAt(r))&&46!==i||i!==t.input.charCodeAt(r+1)||i!==t.input.charCodeAt(r+2)||(r+=3,i=t.input.charCodeAt(r),0!==i&&!Y(i)))}function We(t,r){1===r?t.result+=" ":r>1&&(t.result+=E_repeat("\n",r-1))}function Xt(t,r){var i,p,n=t.tag,o=t.anchor,a=[],c=!1;if(-1!==t.firstTabInLine)return!1;for(null!==t.anchor&&(t.anchorMap[t.anchor]=a),p=t.input.charCodeAt(t.position);0!==p&&(-1!==t.firstTabInLine&&(t.position=t.firstTabInLine,m(t,"tab characters must not be used in indentation")),45===p&&Y(t.input.charCodeAt(t.position+1)));)if(c=!0,t.position++,N(t,!0,-1)&&t.lineIndent<=r)a.push(null),p=t.input.charCodeAt(t.position);else if(i=t.line,ae(t,r,3,!1,!0),a.push(t.result),N(t,!0,-1),p=t.input.charCodeAt(t.position),(t.line===i||t.lineIndent>r)&&0!==p)m(t,"bad indentation of a sequence entry");else if(t.lineIndent<r)break;return!!c&&(t.tag=n,t.anchor=o,t.kind="sequence",t.result=a,!0)}function Aa(t){var r,o,a,l,i=!1,n=!1;if(33!==(l=t.input.charCodeAt(t.position)))return!1;if(null!==t.tag&&m(t,"duplication of a tag property"),60===(l=t.input.charCodeAt(++t.position))?(i=!0,l=t.input.charCodeAt(++t.position)):33===l?(n=!0,o="!!",l=t.input.charCodeAt(++t.position)):o="!",r=t.position,i){do{l=t.input.charCodeAt(++t.position)}while(0!==l&&62!==l);t.position<t.length?(a=t.input.slice(r,t.position),l=t.input.charCodeAt(++t.position)):m(t,"unexpected end of the stream within a verbatim tag")}else{for(;0!==l&&!Y(l);)33===l&&(n?m(t,"tag suffix cannot contain exclamation marks"):(o=t.input.slice(r-1,t.position+1),Jt.test(o)||m(t,"named tag handle cannot contain such characters"),n=!0,r=t.position+1)),l=t.input.charCodeAt(++t.position);a=t.input.slice(r,t.position),aa.test(a)&&m(t,"tag suffix cannot contain flow indicator characters")}a&&!Ht.test(a)&&m(t,"tag name cannot contain such characters: "+a);try{a=decodeURIComponent(a)}catch{m(t,"tag name is malformed: "+a)}return i?t.tag=a:z.call(t.tagMap,o)?t.tag=t.tagMap[o]+a:"!"===o?t.tag="!"+a:"!!"===o?t.tag="tag:yaml.org,2002:"+a:m(t,'undeclared tag handle "'+o+'"'),!0}function Ta(t){var r,i;if(38!==(i=t.input.charCodeAt(t.position)))return!1;for(null!==t.anchor&&m(t,"duplication of an anchor property"),i=t.input.charCodeAt(++t.position),r=t.position;0!==i&&!Y(i)&&!ne(i);)i=t.input.charCodeAt(++t.position);return t.position===r&&m(t,"name of an anchor node must contain at least one character"),t.anchor=t.input.slice(r,t.position),!0}function ae(t,r,i,n,o){var a,l,c,f,d,T,C,y,O,p=1,g=!1,h=!1;if(null!==t.listener&&t.listener("open",t),t.tag=null,t.anchor=null,t.kind=null,t.result=null,a=l=c=4===i||3===i,n&&N(t,!0,-1)&&(g=!0,t.lineIndent>r?p=1:t.lineIndent===r?p=0:t.lineIndent<r&&(p=-1)),1===p)for(;Aa(t)||Ta(t);)N(t,!0,-1)?(g=!0,c=a,t.lineIndent>r?p=1:t.lineIndent===r?p=0:t.lineIndent<r&&(p=-1)):c=!1;if(c&&(c=g||o),(1===p||4===i)&&(y=1===i||2===i?r:r+1,O=t.position-t.lineStart,1===p?c&&(Xt(t,O)||function _a(t,r,i){var n,o,a,l,c,p,v,g=t.tag,h=t.anchor,f={},d=Object.create(null),T=null,C=null,y=null,O=!1,J=!1;if(-1!==t.firstTabInLine)return!1;for(null!==t.anchor&&(t.anchorMap[t.anchor]=f),v=t.input.charCodeAt(t.position);0!==v;){if(!O&&-1!==t.firstTabInLine&&(t.position=t.firstTabInLine,m(t,"tab characters must not be used in indentation")),n=t.input.charCodeAt(t.position+1),a=t.line,63!==v&&58!==v||!Y(n)){if(l=t.line,c=t.lineStart,p=t.position,!ae(t,i,2,!1,!0))break;if(t.line===a){for(v=t.input.charCodeAt(t.position);K(v);)v=t.input.charCodeAt(++t.position);if(58===v)Y(v=t.input.charCodeAt(++t.position))||m(t,"a whitespace character is expected after the key-value separator within a block mapping"),O&&(oe(t,f,d,T,C,null,l,c,p),T=C=y=null),J=!0,O=!1,o=!1,T=t.tag,C=t.result;else{if(!J)return t.tag=g,t.anchor=h,!0;m(t,"can not read an implicit mapping pair; a colon is missed")}}else{if(!J)return t.tag=g,t.anchor=h,!0;m(t,"can not read a block mapping entry; a multiline key may not be an implicit key")}}else 63===v?(O&&(oe(t,f,d,T,C,null,l,c,p),T=C=y=null),J=!0,O=!0,o=!0):O?(O=!1,o=!0):m(t,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),t.position+=1,v=n;if((t.line===a||t.lineIndent>r)&&(O&&(l=t.line,c=t.lineStart,p=t.position),ae(t,r,4,!0,o)&&(O?C=t.result:y=t.result),O||(oe(t,f,d,T,C,y,l,c,p),T=C=y=null),N(t,!0,-1),v=t.input.charCodeAt(t.position)),(t.line===a||t.lineIndent>r)&&0!==v)m(t,"bad indentation of a mapping entry");else if(t.lineIndent<r)break}return O&&oe(t,f,d,T,C,null,l,c,p),J&&(t.tag=g,t.anchor=h,t.kind="mapping",t.result=f),J}(t,O,y))||function da(t,r){var n,o,a,c,h,f,d,T,y,O,J,v,i=!0,l=t.tag,p=t.anchor,C=Object.create(null);if(91===(v=t.input.charCodeAt(t.position)))h=93,T=!1,c=[];else{if(123!==v)return!1;h=125,T=!0,c={}}for(null!==t.anchor&&(t.anchorMap[t.anchor]=c),v=t.input.charCodeAt(++t.position);0!==v;){if(N(t,!0,r),(v=t.input.charCodeAt(t.position))===h)return t.position++,t.tag=l,t.anchor=p,t.kind=T?"mapping":"sequence",t.result=c,!0;i?44===v&&m(t,"expected the node content, but found ','"):m(t,"missed comma between flow collection entries"),J=null,f=d=!1,63===v&&Y(t.input.charCodeAt(t.position+1))&&(f=d=!0,t.position++,N(t,!0,r)),n=t.line,o=t.lineStart,a=t.position,ae(t,r,1,!1,!0),O=t.tag,y=t.result,N(t,!0,r),v=t.input.charCodeAt(t.position),(d||t.line===n)&&58===v&&(f=!0,v=t.input.charCodeAt(++t.position),N(t,!0,r),ae(t,r,1,!1,!0),J=t.result),T?oe(t,c,C,O,y,J,n,o,a):c.push(f?oe(t,null,C,O,y,J,n,o,a):y),N(t,!0,r),44===(v=t.input.charCodeAt(t.position))?(i=!0,v=t.input.charCodeAt(++t.position)):i=!1}m(t,"unexpected end of the stream within a flow collection")}(t,y)?h=!0:(l&&function ma(t,r){var i,n,h,f,o=1,a=!1,l=!1,c=r,p=0,g=!1;if(124===(f=t.input.charCodeAt(t.position)))n=!1;else{if(62!==f)return!1;n=!0}for(t.kind="scalar",t.result="";0!==f;)if(43===(f=t.input.charCodeAt(++t.position))||45===f)1===o?o=43===f?3:2:m(t,"repeat of a chomping mode identifier");else{if(!((h=sa(f))>=0))break;0===h?m(t,"bad explicit indentation width of a block scalar; it cannot be less than one"):l?m(t,"repeat of an indentation width identifier"):(c=r+h-1,l=!0)}if(K(f)){do{f=t.input.charCodeAt(++t.position)}while(K(f));if(35===f)do{f=t.input.charCodeAt(++t.position)}while(!H(f)&&0!==f)}for(;0!==f;){for(Ke(t),t.lineIndent=0,f=t.input.charCodeAt(t.position);(!l||t.lineIndent<c)&&32===f;)t.lineIndent++,f=t.input.charCodeAt(++t.position);if(!l&&t.lineIndent>c&&(c=t.lineIndent),H(f))p++;else{if(t.lineIndent<c){3===o?t.result+=E_repeat("\n",a?1+p:p):1===o&&a&&(t.result+="\n");break}for(n?K(f)?(g=!0,t.result+=E_repeat("\n",a?1+p:p)):g?(g=!1,t.result+=E_repeat("\n",p+1)):0===p?a&&(t.result+=" "):t.result+=E_repeat("\n",p):t.result+=E_repeat("\n",a?1+p:p),a=!0,l=!0,p=0,i=t.position;!H(f)&&0!==f;)f=t.input.charCodeAt(++t.position);$(t,i,t.position,!1)}}return!0}(t,y)||function fa(t,r){var i,n,o;if(39!==(i=t.input.charCodeAt(t.position)))return!1;for(t.kind="scalar",t.result="",t.position++,n=o=t.position;0!==(i=t.input.charCodeAt(t.position));)if(39===i){if($(t,n,t.position,!0),39!==(i=t.input.charCodeAt(++t.position)))return!0;n=t.position,t.position++,o=t.position}else H(i)?($(t,n,o,!0),We(t,N(t,!1,r)),n=o=t.position):t.position===t.lineStart&&Ze(t)?m(t,"unexpected end of the document within a single quoted scalar"):(t.position++,o=t.position);m(t,"unexpected end of the stream within a single quoted scalar")}(t,y)||function ha(t,r){var i,n,o,a,l,c;if(34!==(c=t.input.charCodeAt(t.position)))return!1;for(t.kind="scalar",t.result="",t.position++,i=n=t.position;0!==(c=t.input.charCodeAt(t.position));){if(34===c)return $(t,i,t.position,!0),t.position++,!0;if(92===c){if($(t,i,t.position,!0),H(c=t.input.charCodeAt(++t.position)))N(t,!1,r);else if(c<256&&Gt[c])t.result+=zt[c],t.position++;else if((l=ca(c))>0){for(o=l,a=0;o>0;o--)(l=la(c=t.input.charCodeAt(++t.position)))>=0?a=(a<<4)+l:m(t,"expected hexadecimal character");t.result+=pa(a),t.position++}else m(t,"unknown escape sequence");i=n=t.position}else H(c)?($(t,i,n,!0),We(t,N(t,!1,r)),i=n=t.position):t.position===t.lineStart&&Ze(t)?m(t,"unexpected end of the document within a double quoted scalar"):(t.position++,n=t.position)}m(t,"unexpected end of the stream within a double quoted scalar")}(t,y)?h=!0:function ba(t){var r,i,n;if(42!==(n=t.input.charCodeAt(t.position)))return!1;for(n=t.input.charCodeAt(++t.position),r=t.position;0!==n&&!Y(n)&&!ne(n);)n=t.input.charCodeAt(++t.position);return t.position===r&&m(t,"name of an alias node must contain at least one character"),i=t.input.slice(r,t.position),z.call(t.anchorMap,i)||m(t,'unidentified alias "'+i+'"'),t.result=t.anchorMap[i],N(t,!0,-1),!0}(t)?(h=!0,(null!==t.tag||null!==t.anchor)&&m(t,"alias node should not have any properties")):function ga(t,r,i){var o,a,l,c,p,g,h,T,f=t.kind,d=t.result;if(Y(T=t.input.charCodeAt(t.position))||ne(T)||35===T||38===T||42===T||33===T||124===T||62===T||39===T||34===T||37===T||64===T||96===T||(63===T||45===T)&&(Y(o=t.input.charCodeAt(t.position+1))||i&&ne(o)))return!1;for(t.kind="scalar",t.result="",a=l=t.position,c=!1;0!==T;){if(58===T){if(Y(o=t.input.charCodeAt(t.position+1))||i&&ne(o))break}else if(35===T){if(Y(t.input.charCodeAt(t.position-1)))break}else{if(t.position===t.lineStart&&Ze(t)||i&&ne(T))break;if(H(T)){if(p=t.line,g=t.lineStart,h=t.lineIndent,N(t,!1,-1),t.lineIndent>=r){c=!0,T=t.input.charCodeAt(t.position);continue}t.position=l,t.line=p,t.lineStart=g,t.lineIndent=h;break}}c&&($(t,a,l,!1),We(t,t.line-p),a=l=t.position,c=!1),K(T)||(l=t.position+1),T=t.input.charCodeAt(++t.position)}return $(t,a,l,!1),!!t.result||(t.kind=f,t.result=d,!1)}(t,y,1===i)&&(h=!0,null===t.tag&&(t.tag="?")),null!==t.anchor&&(t.anchorMap[t.anchor]=t.result)):0===p&&(h=c&&Xt(t,O))),null===t.tag)null!==t.anchor&&(t.anchorMap[t.anchor]=t.result);else if("?"===t.tag){for(null!==t.result&&"scalar"!==t.kind&&m(t,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+t.kind+'"'),f=0,d=t.implicitTypes.length;f<d;f+=1)if((C=t.implicitTypes[f]).resolve(t.result)){t.result=C.construct(t.result),t.tag=C.tag,null!==t.anchor&&(t.anchorMap[t.anchor]=t.result);break}}else if("!"!==t.tag){if(z.call(t.typeMap[t.kind||"fallback"],t.tag))C=t.typeMap[t.kind||"fallback"][t.tag];else for(C=null,f=0,d=(T=t.typeMap.multi[t.kind||"fallback"]).length;f<d;f+=1)if(t.tag.slice(0,T[f].tag.length)===T[f].tag){C=T[f];break}C||m(t,"unknown tag !<"+t.tag+">"),null!==t.result&&C.kind!==t.kind&&m(t,"unacceptable node kind for !<"+t.tag+'> tag; it should be "'+C.kind+'", not "'+t.kind+'"'),C.resolve(t.result,t.tag)?(t.result=C.construct(t.result,t.tag),null!==t.anchor&&(t.anchorMap[t.anchor]=t.result)):m(t,"cannot resolve a node with !<"+t.tag+"> explicit tag")}return null!==t.listener&&t.listener("close",t),null!==t.tag||null!==t.anchor||h}function xa(t){var i,n,o,l,r=t.position,a=!1;for(t.version=null,t.checkLineBreaks=t.legacy,t.tagMap=Object.create(null),t.anchorMap=Object.create(null);0!==(l=t.input.charCodeAt(t.position))&&(N(t,!0,-1),l=t.input.charCodeAt(t.position),!(t.lineIndent>0||37!==l));){for(a=!0,l=t.input.charCodeAt(++t.position),i=t.position;0!==l&&!Y(l);)l=t.input.charCodeAt(++t.position);for(o=[],(n=t.input.slice(i,t.position)).length<1&&m(t,"directive name must not be less than one character in length");0!==l;){for(;K(l);)l=t.input.charCodeAt(++t.position);if(35===l){do{l=t.input.charCodeAt(++t.position)}while(0!==l&&!H(l));break}if(H(l))break;for(i=t.position;0!==l&&!Y(l);)l=t.input.charCodeAt(++t.position);o.push(t.input.slice(i,t.position))}0!==l&&Ke(t),z.call(Kt,n)?Kt[n](t,n,o):Ne(t,'unknown document directive "'+n+'"')}N(t,!0,-1),0===t.lineIndent&&45===t.input.charCodeAt(t.position)&&45===t.input.charCodeAt(t.position+1)&&45===t.input.charCodeAt(t.position+2)?(t.position+=3,N(t,!0,-1)):a&&m(t,"directives end mark is expected"),ae(t,t.lineIndent-1,4,!1,!0),N(t,!0,-1),t.checkLineBreaks&&oa.test(t.input.slice(r,t.position))&&Ne(t,"non-ASCII line breaks are interpreted as content"),t.documents.push(t.result),t.position===t.lineStart&&Ze(t)?46===t.input.charCodeAt(t.position)&&(t.position+=3,N(t,!0,-1)):t.position<t.length-1&&m(t,"end of the stream or a document separator is expected")}function ei(t,r){r=r||{},0!==(t=String(t)).length&&(10!==t.charCodeAt(t.length-1)&&13!==t.charCodeAt(t.length-1)&&(t+="\n"),65279===t.charCodeAt(0)&&(t=t.slice(1)));var i=new ua(t,r),n=t.indexOf("\0");for(-1!==n&&(i.position=n,m(i,"null byte is not allowed in input")),i.input+="\0";32===i.input.charCodeAt(i.position);)i.lineIndent+=1,i.position+=1;for(;i.position<i.length-1;)xa(i);return i.documents}function rt(t,r){return function(){throw new Error("Function yaml."+t+" is removed in js-yaml 4. Use yaml."+r+" instead, which is now safe by default.")}}var xi=function va(t,r){var i=ei(t,r);if(0!==i.length){if(1===i.length)return i[0];throw new U("expected a single document in the stream, but found more")}};rt("safeLoad","load"),rt("safeLoadAll","loadAll"),rt("safeDump","dump");var xl=_(529);let xe=(()=>{class t{constructor(i){this.http=i}getDetailByLink(i,n,o){return o?this.http.get(i,{observe:"body",responseType:"text"}):n?this.http.get(i,{headers:{"X-Accept-Vulnerabilities":u.eB}}):this.http.get(i)}}return t.\u0275fac=function(i){return new(i||t)(e.LFG(xl.eN))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var Re=_(5471);function Cl(t,r){1&t&&(e.TgZ(0,"div",9)(1,"label"),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&t&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"HELM_CHART.SHOW_KV")))}function vl(t,r){1&t&&(e.TgZ(0,"div",9)(1,"label"),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&t&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"HELM_CHART.SHOW_YAML")))}function Il(t,r){if(1&t&&(e.TgZ(0,"tr")(1,"td",15),e._uU(2),e.qZA(),e.TgZ(3,"td",15),e._uU(4),e.qZA()()),2&t){const i=r.$implicit;e.xp6(2),e.Oqu(null==i?null:i.key),e.xp6(2),e.Oqu(null==i?null:i.value)}}function yl(t,r){if(1&t&&(e.TgZ(0,"div",12)(1,"table",13)(2,"tbody"),e.YNc(3,Il,5,2,"tr",14),e.ALo(4,"keyvalue"),e.qZA()()()),2&t){const i=e.oxw(2);e.xp6(3),e.Q6J("ngForOf",e.lcZ(4,1,i.valuesObj))}}function Sl(t,r){if(1&t&&(e.TgZ(0,"div",12),e._UZ(1,"div",16),e.ALo(2,"markdown"),e.ALo(3,"language"),e.qZA()),2&t){const i=e.oxw(2);e.xp6(1),e.Q6J("innerHTML",e.lcZ(2,1,e.xi3(3,3,i.values,"yaml")),e.oJD)}}function Ol(t,r){if(1&t&&(e.TgZ(0,"div",10),e.YNc(1,yl,5,3,"div",11),e.YNc(2,Sl,4,6,"div",11),e.qZA()),2&t){const i=e.oxw();e.xp6(1),e.Q6J("ngIf",i.valueMode),e.xp6(1),e.Q6J("ngIf",!i.valueMode)}}function Ll(t,r){1&t&&(e.TgZ(0,"div",17),e._UZ(1,"span",18),e.qZA())}const Ci=function(t){return{"is-highlight":t}};let wl=(()=>{class t{constructor(i,n){this.errorHandler=i,this.additionsService=n,this.valuesObj={},this.valueMode=!1,this.valueHover=!1,this.yamlHover=!0,this.loading=!1}ngOnInit(){this.valuesLink&&!this.valuesLink.absolute&&this.valuesLink.href&&(this.loading=!0,this.additionsService.getDetailByLink(this.valuesLink.href,!1,!0).pipe((0,L.x)(()=>this.loading=!1)).subscribe(i=>{try{this.format(xi(i)),this.values=i}catch(n){this.errorHandler.error(n)}},i=>{this.errorHandler.error(i)}))}get isValueMode(){return this.valueMode}isHovering(i){return"value"===i?this.valueHover:this.yamlHover}showYamlFile(i){this.valueMode=!i}mouseEnter(i){"value"===i?this.valueHover=!0:this.yamlHover=!0}mouseLeave(i){"value"===i?this.valueHover=!1:this.yamlHover=!1}format(i){for(let n in i)if(i.hasOwnProperty(n))if((0,u.Kn)(i[n])){for(let o in i[n])i[n].hasOwnProperty(o)&&(i[`${n}.${o}`]=i[n][o]);delete i[n],this.format(i)}else this.valuesObj[n]=i[n]}}return t.\u0275fac=function(i){return new(i||t)(e.Y36(R.q),e.Y36(xe))},t.\u0275cmp=e.Xpm({type:t,selectors:[["hbr-artifact-values"]],inputs:{valuesLink:"valuesLink"},decls:10,vars:10,consts:[[1,"row","flex-items-xs-between","values-header"],["class","title-container",4,"ngIf"],[1,"switch-container"],[1,"card-btn",3,"click","mouseenter","mouseleave"],["size","24","shape","view-list","title","list values",3,"ngClass"],[1,"list-btn",3,"click","mouseenter","mouseleave"],["size","24","shape","file","title","yaml file",3,"ngClass"],["class","row value-container",4,"ngIf"],["class","clr-row mt-1 center",4,"ngIf"],[1,"title-container"],[1,"row","value-container"],["class","col-xs-8",4,"ngIf"],[1,"col-xs-8"],[1,"table"],[4,"ngFor","ngForOf"],[1,"left"],[1,"yaml-container",3,"innerHTML"],[1,"clr-row","mt-1","center"],[1,"spinner","spinner-md"]],template:function(i,n){1&i&&(e.TgZ(0,"div",0),e.YNc(1,Cl,4,3,"div",1),e.YNc(2,vl,4,3,"div",1),e.TgZ(3,"div",2)(4,"span",3),e.NdJ("click",function(){return n.showYamlFile(!1)})("mouseenter",function(){return n.mouseEnter("value")})("mouseleave",function(){return n.mouseLeave("value")}),e._UZ(5,"clr-icon",4),e.qZA(),e.TgZ(6,"span",5),e.NdJ("click",function(){return n.showYamlFile(!0)})("mouseenter",function(){return n.mouseEnter("yaml")})("mouseleave",function(){return n.mouseLeave("yaml")}),e._UZ(7,"clr-icon",6),e.qZA()()(),e.YNc(8,Ol,3,2,"div",7),e.YNc(9,Ll,2,0,"div",8)),2&i&&(e.xp6(1),e.Q6J("ngIf",n.valueMode),e.xp6(1),e.Q6J("ngIf",!n.valueMode),e.xp6(3),e.Q6J("ngClass",e.VKq(6,Ci,n.isValueMode||n.isHovering("value"))),e.xp6(2),e.Q6J("ngClass",e.VKq(8,Ci,!n.isValueMode||n.isHovering("yaml"))),e.xp6(1),e.Q6J("ngIf",!n.loading),e.xp6(1),e.Q6J("ngIf",n.loading))},dependencies:[s.qvL,s.MgK,A.mk,A.sg,A.O5,b.X$,A.Nd,Re.Ay,Re.NO],styles:[".value-container[_ngcontent-%COMP%]     pre{min-height:-moz-fit-content;min-height:fit-content;max-height:none!important}.values-header[_ngcontent-%COMP%]{margin-top:12px}pre[_ngcontent-%COMP%]{padding-left:21px}.center[_ngcontent-%COMP%]{justify-content:center;align-items:center}"]}),t})();function Nl(t,r){if(1&t&&(e._UZ(0,"div",6),e.ALo(1,"markdown")),2&t){const i=e.oxw(2);e.Q6J("innerHTML",e.lcZ(1,1,i.readme),e.oJD)}}function Zl(t,r){1&t&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"HELM_CHART.NO_README")))}function El(t,r){if(1&t&&(e.TgZ(0,"div",2)(1,"div",3),e.YNc(2,Nl,2,3,"div",4),e.YNc(3,Zl,3,3,"div",5),e.qZA()()),2&t){const i=e.oxw();e.xp6(2),e.Q6J("ngIf",i.readme),e.xp6(1),e.Q6J("ngIf",!i.readme)}}function Pl(t,r){1&t&&(e.TgZ(0,"div",7),e._UZ(1,"span",8),e.qZA())}let Rl=(()=>{class t{constructor(i,n){this.errorHandler=i,this.additionsService=n,this.loading=!1}ngOnInit(){this.getReadme()}getReadme(){this.summaryLink&&!this.summaryLink.absolute&&this.summaryLink.href&&(this.loading=!0,this.additionsService.getDetailByLink(this.summaryLink.href,!1,!0).pipe((0,L.x)(()=>this.loading=!1)).subscribe(i=>{this.readme=i},i=>{this.errorHandler.error(i)}))}}return t.\u0275fac=function(i){return new(i||t)(e.Y36(R.q),e.Y36(xe))},t.\u0275cmp=e.Xpm({type:t,selectors:[["hbr-artifact-summary"]],inputs:{summaryLink:"summaryLink"},decls:2,vars:2,consts:[["class","row content-wrapper",4,"ngIf"],["class","clr-row mt-3 center",4,"ngIf"],[1,"row","content-wrapper"],[1,"col-md-8","md-container","pl-1"],["class","md-div",3,"innerHTML",4,"ngIf"],[4,"ngIf"],[1,"md-div",3,"innerHTML"],[1,"clr-row","mt-3","center"],[1,"spinner","spinner-md"]],template:function(i,n){1&i&&(e.YNc(0,El,4,2,"div",0),e.YNc(1,Pl,2,0,"div",1)),2&i&&(e.Q6J("ngIf",!n.loading),e.xp6(1),e.Q6J("ngIf",n.loading))},dependencies:[A.O5,b.X$,Re.NO],styles:[".content-wrapper[_ngcontent-%COMP%]{margin-top:20px;padding:0 0 0 15px}.content-wrapper[_ngcontent-%COMP%]   .md-container[_ngcontent-%COMP%]{border:solid 1px #ddd}.center[_ngcontent-%COMP%]{justify-content:center;align-items:center}"]}),t})();function Ml(t,r){if(1&t&&(e.TgZ(0,"clr-dg-row",2)(1,"clr-dg-cell",3),e._uU(2),e.qZA(),e.TgZ(3,"clr-dg-cell",3),e._uU(4),e.qZA(),e.TgZ(5,"clr-dg-cell",3)(6,"a",4),e._uU(7),e.qZA()()()),2&t){const i=r.$implicit;e.Q6J("clrDgItem",i),e.xp6(2),e.Oqu(i.name),e.xp6(2),e.Oqu(i.version),e.xp6(2),e.s9C("href",i.repository,e.LSH),e.xp6(1),e.Oqu(i.repository)}}let kl=(()=>{class t{constructor(i,n){this.errorHandler=i,this.additionsService=n,this.dependencyList=[],this.loading=!1}ngOnInit(){this.getDependencyList()}getDependencyList(){this.dependenciesLink&&!this.dependenciesLink.absolute&&this.dependenciesLink.href&&(this.loading=!0,this.additionsService.getDetailByLink(this.dependenciesLink.href,!1,!1).pipe((0,L.x)(()=>this.loading=!1)).subscribe(i=>{this.dependencyList=i},i=>{this.errorHandler.error(i)}))}}return t.\u0275fac=function(i){return new(i||t)(e.Y36(R.q),e.Y36(xe))},t.\u0275cmp=e.Xpm({type:t,selectors:[["hbr-artifact-dependencies"]],inputs:{dependenciesLink:"dependenciesLink"},decls:11,vars:11,consts:[[3,"clrDgLoading"],["class","history-item",3,"clrDgItem",4,"clrDgItems","clrDgItemsOf"],[1,"history-item",3,"clrDgItem"],[1,"left"],[3,"href"]],template:function(i,n){1&i&&(e.TgZ(0,"clr-datagrid",0)(1,"clr-dg-column"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"clr-dg-column"),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"clr-dg-column"),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.YNc(10,Ml,8,5,"clr-dg-row",1),e.qZA()),2&i&&(e.Q6J("clrDgLoading",n.loading),e.xp6(2),e.Oqu(e.lcZ(3,5,"HELM_CHART.NAME")),e.xp6(3),e.Oqu(e.lcZ(6,7,"HELM_CHART.VERSION")),e.xp6(3),e.Oqu(e.lcZ(9,9,"HELM_CHART.REPO")),e.xp6(2),e.Q6J("clrDgItemsOf",n.dependencyList))},dependencies:[s.C9t,s.m4W,s.f6,s.Z4N,s.fv_,s.PDs,s.KHL,s.Gcc,s.jND,s.Nh1,s.dml,s.K8c,b.X$],styles:[".dep-container[_ngcontent-%COMP%]{margin-top:30px}"]}),t})();function Dl(t,r){if(1&t&&(e.TgZ(0,"clr-dg-row",3)(1,"clr-dg-cell"),e._uU(2),e.ALo(3,"harborDatetime"),e.qZA(),e.TgZ(4,"clr-dg-cell"),e._uU(5),e.qZA()()),2&t){const i=r.$implicit;e.Q6J("clrDgItem",i),e.xp6(2),e.Oqu(e.xi3(3,3,i.created,"short")),e.xp6(3),e.Oqu(i.created_by)}}let Ul=(()=>{class t{constructor(i,n){this.errorHandler=i,this.additionsService=n,this.historyList=[],this.loading=!1}ngOnInit(){this.getBuildHistory()}getBuildHistory(){this.buildHistoryLink&&!this.buildHistoryLink.absolute&&this.buildHistoryLink.href&&(this.loading=!0,this.additionsService.getDetailByLink(this.buildHistoryLink.href,!1,!1).pipe((0,L.x)(()=>this.loading=!1)).subscribe(i=>{i&&i.length&&i.forEach(n=>{const o=new Ni;o.created=n.created,o.created_by=void 0!==n.created_by?n.created_by.replace("/bin/sh -c #(nop)","").trimLeft().replace("/bin/sh -c","RUN"):n.comment,this.historyList.push(o)})},i=>{this.errorHandler.error(i)}))}}return t.\u0275fac=function(i){return new(i||t)(e.Y36(R.q),e.Y36(xe))},t.\u0275cmp=e.Xpm({type:t,selectors:[["hbr-artifact-build-history"]],inputs:{buildHistoryLink:"buildHistoryLink"},decls:10,vars:9,consts:[[3,"clrDgLoading"],[1,"history-time"],["class","history-item",3,"clrDgItem",4,"clrDgItems","clrDgItemsOf"],[1,"history-item",3,"clrDgItem"]],template:function(i,n){1&i&&(e.TgZ(0,"clr-datagrid",0)(1,"clr-dg-column",1),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"clr-dg-column"),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.YNc(7,Dl,6,6,"clr-dg-row",2),e.TgZ(8,"clr-dg-footer"),e._uU(9),e.qZA()()),2&i&&(e.Q6J("clrDgLoading",n.loading),e.xp6(2),e.Oqu(e.lcZ(3,5,"TAG.CREATION")),e.xp6(3),e.Oqu(e.lcZ(6,7,"TAG.COMMAND")),e.xp6(2),e.Q6J("clrDgItemsOf",n.historyList),e.xp6(2),e.hij("",n.historyList.length," commands"))},dependencies:[s.C9t,s.m4W,s.f6,s.Z4N,s.fv_,s.dRQ,s.PDs,s.KHL,s.Gcc,s.jND,s.Nh1,s.dml,s.K8c,b.X$,ue.Z],styles:[".history-time[_ngcontent-%COMP%]{width:160px}"]}),t})();var Yl=_(1992);function ql(t,r){1&t&&e._UZ(0,"clr-icon",25)}function Fl(t,r){1&t&&e._UZ(0,"clr-icon",26)}function jl(t,r){1&t&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"VULNERABILITY.SCAN_NOW")))}function Bl(t,r){1&t&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"VULNERABILITY.STOP_NOW")))}function Jl(t,r){1&t&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"VULNERABILITY.STATE.OTHER_STATUS")))}function Hl(t,r){1&t&&(e._uU(0),e.ALo(1,"translate")),2&t&&e.hij(" ",e.lcZ(1,1,"VULNERABILITY.CHART.TOOLTIPS_TITLE_ZERO")," ")}function Ql(t,r){if(1&t&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&t){const i=e.oxw().$implicit;e.xp6(1),e.Oqu(i.id)}}function Vl(t,r){if(1&t&&(e.TgZ(0,"a",37),e._uU(1),e.qZA()),2&t){const i=e.oxw().$implicit;e.s9C("href",i.links[0],e.LSH),e.xp6(1),e.Oqu(i.id)}}function Gl(t,r){if(1&t&&(e.TgZ(0,"div",40)(1,"a",37),e._uU(2),e.qZA()()),2&t){const i=r.$implicit;e.xp6(1),e.s9C("href",i,e.LSH),e.xp6(1),e.Oqu(i)}}function zl(t,r){if(1&t&&(e.TgZ(0,"clr-signpost-content"),e.YNc(1,Gl,3,2,"div",39),e.qZA()),2&t){const i=e.oxw(2).$implicit;e.xp6(1),e.Q6J("ngForOf",i.links)}}function $l(t,r){if(1&t&&(e.TgZ(0,"span"),e._uU(1),e.TgZ(2,"clr-signpost"),e.YNc(3,zl,2,1,"clr-signpost-content",38),e.qZA()()),2&t){const i=e.oxw().$implicit;e.xp6(1),e.hij(" ",i.id," ")}}function Kl(t,r){if(1&t&&(e.TgZ(0,"span",41),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t){const i=e.oxw().$implicit,n=e.oxw();e.xp6(1),e.Oqu(e.lcZ(2,1,n.severityText(i.severity)))}}function Wl(t,r){if(1&t&&(e.TgZ(0,"span",42),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t){const i=e.oxw().$implicit,n=e.oxw();e.xp6(1),e.Oqu(e.lcZ(2,1,n.severityText(i.severity)))}}function Xl(t,r){if(1&t&&(e.TgZ(0,"span",43),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t){const i=e.oxw().$implicit,n=e.oxw();e.xp6(1),e.Oqu(e.lcZ(2,1,n.severityText(i.severity)))}}function ec(t,r){if(1&t&&(e.TgZ(0,"span",44),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t){const i=e.oxw().$implicit,n=e.oxw();e.xp6(1),e.Oqu(e.lcZ(2,1,n.severityText(i.severity)))}}function tc(t,r){if(1&t&&(e.TgZ(0,"span",45),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t){const i=e.oxw().$implicit,n=e.oxw();e.xp6(1),e.Oqu(e.lcZ(2,1,n.severityText(i.severity)))}}function ic(t,r){if(1&t&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t){const i=e.oxw().$implicit,n=e.oxw();e.xp6(1),e.Oqu(e.lcZ(2,1,n.severityText(i.severity)))}}function nc(t,r){if(1&t&&(e.TgZ(0,"div",46)(1,"div",47),e._uU(2),e.qZA(),e.TgZ(3,"div",47),e._uU(4),e.qZA()()),2&t){const i=r.$implicit;e.xp6(2),e.hij("",null==i?null:i.key,":"),e.xp6(2),e.Oqu(null==i||null==i.value?null:i.value.V3Score)}}function rc(t,r){if(1&t&&(e.TgZ(0,"div"),e._UZ(1,"clr-icon",48),e._uU(2,"\xa0"),e.TgZ(3,"span",49),e._uU(4),e.qZA()()),2&t){const i=e.oxw().$implicit;e.xp6(4),e.Oqu(i.fix_version)}}function oc(t,r){if(1&t&&e._uU(0),2&t){const i=e.oxw().$implicit;e.Oqu(i.fix_version)}}function ac(t,r){if(1&t&&(e.TgZ(0,"clr-dg-row-detail"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t){const i=e.oxw().$implicit;e.xp6(1),e.AsE(" ",e.lcZ(2,2,"VULNERABILITY.GRID.COLUMN_DESCRIPTION"),": ",i.description," ")}}function lc(t,r){if(1&t&&(e.TgZ(0,"clr-dg-row")(1,"clr-dg-cell"),e.YNc(2,Ql,2,1,"span",12),e.YNc(3,Vl,2,2,"a",27),e.YNc(4,$l,4,1,"span",12),e.qZA(),e.TgZ(5,"clr-dg-cell",28),e.YNc(6,Kl,3,3,"span",29),e.YNc(7,Wl,3,3,"span",30),e.YNc(8,Xl,3,3,"span",31),e.YNc(9,ec,3,3,"span",32),e.YNc(10,tc,3,3,"span",33),e.YNc(11,ic,3,3,"span",34),e.qZA(),e.TgZ(12,"clr-dg-cell"),e.YNc(13,nc,5,2,"div",35),e.ALo(14,"keyvalue"),e.qZA(),e.TgZ(15,"clr-dg-cell"),e._uU(16),e.qZA(),e.TgZ(17,"clr-dg-cell"),e._uU(18),e.qZA(),e.TgZ(19,"clr-dg-cell"),e.YNc(20,rc,5,1,"div",18),e.YNc(21,oc,1,1,"ng-template",null,19,e.W1O),e.qZA(),e.TgZ(23,"clr-dg-cell"),e._uU(24),e.ALo(25,"translate"),e.qZA(),e.YNc(26,ac,3,4,"clr-dg-row-detail",36),e.qZA()),2&t){const i=r.$implicit,n=e.MAs(22),o=e.oxw();e.xp6(2),e.Q6J("ngIf",!i.links||0===i.links.length),e.xp6(1),e.Q6J("ngIf",i.links&&1===i.links.length),e.xp6(1),e.Q6J("ngIf",i.links&&i.links.length>1),e.xp6(1),e.Q6J("ngSwitch",i.severity),e.xp6(1),e.Q6J("ngSwitchCase","Critical"),e.xp6(1),e.Q6J("ngSwitchCase","High"),e.xp6(1),e.Q6J("ngSwitchCase","Medium"),e.xp6(1),e.Q6J("ngSwitchCase","Low"),e.xp6(1),e.Q6J("ngSwitchCase","None"),e.xp6(3),e.Q6J("ngForOf",e.lcZ(14,15,null==i||null==i.vendor_attributes?null:i.vendor_attributes.CVSS)),e.xp6(3),e.Oqu(i.package),e.xp6(2),e.Oqu(i.version),e.xp6(2),e.Q6J("ngIf",i.fix_version)("ngIfElse",n),e.xp6(4),e.hij(" ",e.lcZ(25,17,o.isInAllowList(i.id)?"TAG_RETENTION.YES":"TAG_RETENTION.NO")," ")}}const cc=function(t){return{scanner:t}};function sc(t,r){if(1&t&&(e.TgZ(0,"i"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t){const i=e.oxw();e.xp6(1),e.Oqu(e.xi3(2,1,"VULNERABILITY.REPORTED_BY",e.VKq(4,cc,i.getScannerInfo(i.scanner))))}}function pc(t,r){if(1&t&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t){e.oxw();const i=e.MAs(51);e.xp6(1),e.lnq("",i.firstItem+1," - ",i.lastItem+1," ",e.lcZ(2,3,"VULNERABILITY.GRID.FOOT_OF"),"")}}const uc=function(){return[15,25,50]};let gc=(()=>{class t{constructor(i,n,o,a,l,c,p,g){this.errorHandler=i,this.additionsService=n,this.userPermissionService=o,this.scanningService=a,this.eventService=l,this.session=c,this.projectService=p,this.systemInfoService=g,this.scanningResults=[],this.loading=!1,this.hasEnabledScanner=!1,this.scanBtnState=s.xp5.DEFAULT,this.hasScanningPermission=!1,this.onSendingScanCommand=!1,this.onSendingStopCommand=!1,this.hasShowLoading=!1,this.hasViewInitWithDelay=!1,this.currentCVEList=[],this.pageSize=(0,u.tb)(u.V2.ARTIFACT_VUL_COMPONENT,25);const h=this;this.severitySort={compare:(f,d)=>h.getLevel(f)-h.getLevel(d)},this.cvssSort={compare:(f,d)=>f&&f.preferred_cvss&&f.preferred_cvss.score_v3&&d&&d.preferred_cvss&&d.preferred_cvss.score_v3?+f.preferred_cvss.score_v3-+d.preferred_cvss.score_v3:0}}ngOnInit(){this.getVulnerabilities(),this.getScanningPermission(),this.getProjectScanner(),this.sub||(this.sub=this.eventService.subscribe(B.n.UPDATE_VULNERABILITY_INFO,i=>{i?.digest===this.artifact?.digest&&this.getVulnerabilities()})),setTimeout(()=>{this.hasViewInitWithDelay=!0},0),this.getCurrentCVEAllowList()}ngOnDestroy(){this.sub&&(this.sub.unsubscribe(),this.sub=null)}getVulnerabilities(){this.vulnerabilitiesLink&&!this.vulnerabilitiesLink.absolute&&this.vulnerabilitiesLink.href&&(this.hasShowLoading||(this.loading=!0,this.hasShowLoading=!0),this.additionsService.getDetailByLink(this.vulnerabilitiesLink.href,!0,!1).pipe((0,L.x)(()=>{this.loading=!1,this.hasShowLoading=!1})).subscribe(i=>{this.scan_overview=i,this.scan_overview&&Object.values(this.scan_overview)[0]&&(this.scanningResults=Object.values(this.scan_overview)[0].vulnerabilities||[],this.scanningResults&&this.scanningResults.sort((n,o)=>this.getLevel(o)-this.getLevel(n)),this.scanner=Object.values(this.scan_overview)[0].scanner)},i=>{this.errorHandler.error(i)}))}getScanningPermission(){this.userPermissionService.hasProjectPermissions(this.projectId,[{resource:I._W.REPOSITORY_TAG_SCAN_JOB.KEY,action:I._W.REPOSITORY_TAG_SCAN_JOB.VALUE.CREATE}]).subscribe(n=>{this.hasScanningPermission=n[0]},n=>this.errorHandler.error(n))}getProjectScanner(){this.hasEnabledScanner=!1,this.scanBtnState=s.xp5.LOADING,this.scanningService.getProjectScanner(this.projectId).subscribe(i=>{i&&"{}"!==JSON.stringify(i)&&!i.disabled&&"healthy"===i.health?(this.scanBtnState=s.xp5.SUCCESS,this.hasEnabledScanner=!0):this.scanBtnState=s.xp5.ERROR,this.projectScanner=i},i=>{this.scanBtnState=s.xp5.ERROR})}getLevel(i){return i&&i.severity&&u.CQ[i.severity]?u.CQ[i.severity]:0}refresh(){this.getVulnerabilities()}severityText(i){switch(i){case u.AT.CRITICAL:return"VULNERABILITY.SEVERITY.CRITICAL";case u.AT.HIGH:return"VULNERABILITY.SEVERITY.HIGH";case u.AT.MEDIUM:return"VULNERABILITY.SEVERITY.MEDIUM";case u.AT.LOW:return"VULNERABILITY.SEVERITY.LOW";case u.AT.NONE:return"VULNERABILITY.SEVERITY.NONE";default:return"UNKNOWN"}}scanNow(){this.onSendingScanCommand=!0,this.eventService.publish(B.n.START_SCAN_ARTIFACT,this.repoName+"/"+this.digest)}submitFinish(i){this.onSendingScanCommand=i}submitStopFinish(i){this.onSendingStopCommand=i}shouldShowBar(){return this.hasViewInitWithDelay&&this.resultBarChartComponent&&(this.resultBarChartComponent.queued||this.resultBarChartComponent.scanning||this.resultBarChartComponent.error||this.resultBarChartComponent.stopped)}hasScanned(){return this.hasViewInitWithDelay&&this.resultBarChartComponent&&!(this.resultBarChartComponent.completed||this.resultBarChartComponent.error||this.resultBarChartComponent.queued||this.resultBarChartComponent.stopped||this.resultBarChartComponent.scanning)}handleScanOverview(i){return i?Object.values(i)[0]:null}isSystemAdmin(){const i=this.session.getCurrentUser();return i&&i.has_admin_role}getCurrentCVEAllowList(){this.projectService.getProject(this.projectId).subscribe(i=>{i&&i.cve_allowlist&&i.metadata&&"false"===i.metadata.reuse_sys_cve_allowlist?this.currentCVEList=i.cve_allowlist.items:this.systemInfoService.getSystemAllowlist().subscribe(n=>{n&&n.items&&n.items.length&&(this.currentCVEList=n.items)})})}isInAllowList(i){if(this.currentCVEList&&this.currentCVEList.length)for(let n=0;n<this.currentCVEList.length;n++)if(i===this.currentCVEList[n].cve_id)return!0;return!1}getScannerInfo(i){if(i){if(i.name&&i.version)return`${i.name}@${i.version}`;if(i.name&&!i.version)return`${i.name}`}return""}isRunningState(){return this.hasViewInitWithDelay&&this.resultBarChartComponent&&(this.resultBarChartComponent.queued||this.resultBarChartComponent.scanning)}scanOrStop(){this.isRunningState()?this.stopNow():this.scanNow()}stopNow(){this.onSendingStopCommand=!0,this.eventService.publish(B.n.STOP_SCAN_ARTIFACT,this.repoName+"/"+this.digest)}canScan(){return this.hasEnabledScanner&&this.hasScanningPermission&&!this.onSendingScanCommand}load(i){i?.page?.size&&(0,u.Pe)(u.V2.ARTIFACT_VUL_COMPONENT,i.page.size)}}return t.\u0275fac=function(i){return new(i||t)(e.Y36(R.q),e.Y36(xe),e.Y36(I.Hx),e.Y36(I.pg),e.Y36(B.P),e.Y36(Yl.m),e.Y36(I.Y4),e.Y36(I.Ob))},t.\u0275cmp=e.Xpm({type:t,selectors:[["hbr-artifact-vulnerabilities"]],viewQuery:function(i,n){if(1&i&&e.Gf(Be,5),2&i){let o;e.iGM(o=e.CRH())&&(n.resultBarChartComponent=o.first)}},inputs:{vulnerabilitiesLink:"vulnerabilitiesLink",projectName:"projectName",projectId:"projectId",repoName:"repoName",digest:"digest",artifact:"artifact"},decls:58,vars:56,consts:[[1,"row","result-row"],[1,"row","flex-items-xs-right","rightPos"],[1,"flex-xs-middle","option-right"],[1,"refresh-btn",3,"click"],["shape","refresh"],[1,"col-lg-12","col-md-12","col-sm-12","col-xs-12"],[3,"clrDgLoading","clrDgRefresh"],[1,"clr-row","center"],[1,"ml-05"],["id","scan-btn","type","button",1,"btn","btn-secondary",3,"clrLoading","disabled","click"],["shape","shield-check","size","16",4,"ngIf"],["shape","stop","size","16",4,"ngIf"],[4,"ngIf"],[1,"ml-1"],[3,"hidden"],[3,"summary","inputScanner","projectName","repoName","artifactDigest","submitStopFinish","submitFinish"],[3,"clrDgField"],[3,"clrDgSortBy"],[4,"ngIf","ngIfElse"],["elseBlock",""],[4,"clrDgItems","clrDgItemsOf"],[1,"report"],[3,"clrDgPageSize","clrDgTotalItems"],["pagination",""],[3,"clrPageSizeOptions"],["shape","shield-check","size","16"],["shape","stop","size","16"],["rel","noopener noreferrer","target","_blank",3,"href",4,"ngIf"],[3,"ngSwitch"],["class","label label-critical no-border",4,"ngSwitchCase"],["class","label label-danger no-border",4,"ngSwitchCase"],["class","label label-medium no-border",4,"ngSwitchCase"],["class","label label-low no-border",4,"ngSwitchCase"],["class","label label-none no-border",4,"ngSwitchCase"],[4,"ngSwitchDefault"],["class","clr-row mr-1",4,"ngFor","ngForOf"],[4,"clrIfExpanded"],["rel","noopener noreferrer","target","_blank",3,"href"],[4,"clrIfOpen"],["class","mt-5px",4,"ngFor","ngForOf"],[1,"mt-5px"],[1,"label","label-critical","no-border"],[1,"label","label-danger","no-border"],[1,"label","label-medium","no-border"],[1,"label","label-low","no-border"],[1,"label","label-none","no-border"],[1,"clr-row","mr-1"],[1,"clr-col"],["shape","wrench","size","20",1,"is-success"],[1,"font-color-green"]],template:function(i,n){if(1&i&&(e.TgZ(0,"div",0)(1,"div")(2,"div",1)(3,"div",2)(4,"span",3),e.NdJ("click",function(){return n.refresh()}),e._UZ(5,"clr-icon",4),e.qZA()()()(),e.TgZ(6,"div",5)(7,"clr-datagrid",6),e.NdJ("clrDgRefresh",function(a){return n.load(a)}),e.TgZ(8,"clr-dg-action-bar")(9,"div",7)(10,"div",8)(11,"button",9),e.NdJ("click",function(){return n.scanOrStop()}),e.YNc(12,ql,1,0,"clr-icon",10),e._uU(13,"\xa0 "),e.YNc(14,Fl,1,0,"clr-icon",11),e._uU(15,"\xa0 "),e.YNc(16,jl,3,3,"span",12),e.YNc(17,Bl,3,3,"span",12),e.qZA()(),e.TgZ(18,"div",13)(19,"div",14)(20,"hbr-vulnerability-bar",15),e.NdJ("submitStopFinish",function(a){return n.submitStopFinish(a)})("submitFinish",function(a){return n.submitFinish(a)}),e.qZA()()()()(),e.TgZ(21,"clr-dg-column",16),e._uU(22),e.ALo(23,"translate"),e.qZA(),e.TgZ(24,"clr-dg-column",17),e._uU(25),e.ALo(26,"translate"),e.qZA(),e.TgZ(27,"clr-dg-column",17),e._uU(28),e.ALo(29,"translate"),e.qZA(),e.TgZ(30,"clr-dg-column",16),e._uU(31),e.ALo(32,"translate"),e.qZA(),e.TgZ(33,"clr-dg-column",16),e._uU(34),e.ALo(35,"translate"),e.qZA(),e.TgZ(36,"clr-dg-column",16),e._uU(37),e.ALo(38,"translate"),e.qZA(),e.TgZ(39,"clr-dg-column"),e._uU(40),e.ALo(41,"translate"),e.qZA(),e.TgZ(42,"clr-dg-placeholder"),e.YNc(43,Jl,3,3,"span",18),e.YNc(44,Hl,2,3,"ng-template",null,19,e.W1O),e.qZA(),e.YNc(46,lc,27,19,"clr-dg-row",20),e.TgZ(47,"clr-dg-footer")(48,"div",21),e.YNc(49,sc,3,6,"i",12),e.qZA(),e.TgZ(50,"clr-dg-pagination",22,23)(52,"clr-dg-page-size",24),e._uU(53),e.ALo(54,"translate"),e.qZA(),e.YNc(55,pc,3,5,"span",12),e._uU(56),e.ALo(57,"translate"),e.qZA()()()()()),2&i){const o=e.MAs(45);e.xp6(7),e.Q6J("clrDgLoading",n.loading),e.xp6(4),e.Q6J("clrLoading",n.scanBtnState)("disabled",!n.canScan()),e.xp6(1),e.Q6J("ngIf",!n.isRunningState()),e.xp6(2),e.Q6J("ngIf",n.isRunningState()),e.xp6(2),e.Q6J("ngIf",!n.isRunningState()),e.xp6(1),e.Q6J("ngIf",n.isRunningState()),e.xp6(2),e.Q6J("hidden",!n.shouldShowBar()),e.xp6(1),e.Q6J("summary",n.handleScanOverview(null==n.artifact?null:n.artifact.scan_overview))("inputScanner",n.scanner)("projectName",n.projectName)("repoName",n.repoName)("artifactDigest",n.digest),e.xp6(1),e.Q6J("clrDgField","id"),e.xp6(1),e.Oqu(e.lcZ(23,37,"VULNERABILITY.GRID.COLUMN_ID")),e.xp6(2),e.Q6J("clrDgSortBy",n.severitySort),e.xp6(1),e.Oqu(e.lcZ(26,39,"VULNERABILITY.GRID.COLUMN_SEVERITY")),e.xp6(2),e.Q6J("clrDgSortBy",n.cvssSort),e.xp6(1),e.Oqu(e.lcZ(29,41,"VULNERABILITY.GRID.CVSS3")),e.xp6(2),e.Q6J("clrDgField","package"),e.xp6(1),e.Oqu(e.lcZ(32,43,"VULNERABILITY.GRID.COLUMN_PACKAGE")),e.xp6(2),e.Q6J("clrDgField","version"),e.xp6(1),e.Oqu(e.lcZ(35,45,"VULNERABILITY.GRID.COLUMN_VERSION")),e.xp6(2),e.Q6J("clrDgField","fix_version"),e.xp6(1),e.Oqu(e.lcZ(38,47,"VULNERABILITY.GRID.COLUMN_FIXED")),e.xp6(3),e.Oqu(e.lcZ(41,49,"VULNERABILITY.GRID.IN_ALLOW_LIST")),e.xp6(3),e.Q6J("ngIf",n.hasScanned())("ngIfElse",o),e.xp6(3),e.Q6J("clrDgItemsOf",n.scanningResults),e.xp6(3),e.Q6J("ngIf",n.scanner),e.xp6(1),e.Q6J("clrDgPageSize",n.pageSize)("clrDgTotalItems",null==n.scanningResults?null:n.scanningResults.length),e.xp6(2),e.Q6J("clrPageSizeOptions",e.DdM(55,uc)),e.xp6(1),e.Oqu(e.lcZ(54,51,"PAGINATION.PAGE_SIZE")),e.xp6(2),e.Q6J("ngIf",null==n.scanningResults?null:n.scanningResults.length),e.xp6(1),e.AsE(" ",null==n.scanningResults?null:n.scanningResults.length," ",e.lcZ(57,53,"VULNERABILITY.GRID.FOOT_ITEMS")," ")}},dependencies:[s.C9t,s.Gwl,s.m4W,s.f6,s.Z4N,s.O7r,s.Nz$,s.fv_,s.dRQ,s.Ltv,s.YYR,s.F7K,s.PDs,s.KHL,s.Gcc,s.jND,s.Nh1,s.dml,s.K8c,s.qvL,s.cCV,s.nqY,s.DbV,s.MPb,s.EuU,s.hQ,A.sg,A.O5,A.RF,A.n9,A.ED,Be,b.X$,A.Nd],styles:[".result-row[_ngcontent-%COMP%]{position:relative}.rightPos[_ngcontent-%COMP%]{position:absolute;z-index:100;right:0;margin-top:1.25rem}.option-right[_ngcontent-%COMP%]{padding-right:16px;margin-top:5px}.center[_ngcontent-%COMP%]{align-items:center}.label-critical[_ngcontent-%COMP%]{background:red;color:#621501}.label-danger[_ngcontent-%COMP%]{background:#e64524!important;color:#621501!important}.label-medium[_ngcontent-%COMP%]{background-color:orange;color:#621501}.label-low[_ngcontent-%COMP%]{background:#007CBB;color:#cab6b1}.label-none[_ngcontent-%COMP%]{background-color:gray;color:#bad7ba}.no-border[_ngcontent-%COMP%]{border:none}.ml-05[_ngcontent-%COMP%]{margin-left:.5rem}.report[_ngcontent-%COMP%]{text-align:left}.mt-5px[_ngcontent-%COMP%]{margin-top:5px}"]}),t})();function fc(t,r){if(1&t&&(e.TgZ(0,"clr-tab-content",5),e._UZ(1,"hbr-artifact-vulnerabilities",6),e.qZA()),2&t){const i=e.oxw(3);e.xp6(1),e.Q6J("artifact",i.artifact)("projectName",i.projectName)("projectId",i.projectId)("repoName",i.repoName)("digest",i.digest)("vulnerabilitiesLink",i.getVulnerability())}}function hc(t,r){1&t&&(e.TgZ(0,"clr-tab")(1,"button",3),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.YNc(4,fc,2,6,"clr-tab-content",4),e.qZA()),2&t&&(e.xp6(2),e.hij(" ",e.lcZ(3,1,"REPOSITORY.VULNERABILITY")," "))}function dc(t,r){if(1&t&&(e.TgZ(0,"clr-tab-content"),e._UZ(1,"hbr-artifact-build-history",9),e.qZA()),2&t){const i=e.oxw(3);e.xp6(1),e.Q6J("buildHistoryLink",i.getBuildHistory())}}function mc(t,r){1&t&&(e.TgZ(0,"clr-tab")(1,"button",7),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.YNc(4,dc,2,1,"clr-tab-content",8),e.qZA()),2&t&&(e.xp6(2),e.hij(" ",e.lcZ(3,1,"REPOSITORY.BUILD_HISTORY")," "))}function _c(t,r){if(1&t&&(e.TgZ(0,"clr-tab-content",12),e._UZ(1,"hbr-artifact-summary",13),e.qZA()),2&t){const i=e.oxw(3);e.xp6(1),e.Q6J("summaryLink",i.getSummary())}}function Ac(t,r){1&t&&(e.TgZ(0,"clr-tab")(1,"button",10),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.YNc(4,_c,2,1,"clr-tab-content",11),e.qZA()),2&t&&(e.xp6(2),e.hij(" ",e.lcZ(3,1,"HELM_CHART.SUMMARY")," "))}function Tc(t,r){if(1&t&&(e.TgZ(0,"clr-tab-content",16),e._UZ(1,"hbr-artifact-dependencies",17),e.qZA()),2&t){const i=e.oxw(3);e.xp6(1),e.Q6J("dependenciesLink",i.getDependencies())}}function bc(t,r){1&t&&(e.TgZ(0,"clr-tab")(1,"button",14),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.YNc(4,Tc,2,1,"clr-tab-content",15),e.qZA()),2&t&&(e.xp6(2),e.hij(" ",e.lcZ(3,1,"HELM_CHART.DEPENDENCIES")," "))}function xc(t,r){if(1&t&&(e.TgZ(0,"clr-tab-content",20),e._UZ(1,"hbr-artifact-values",21),e.qZA()),2&t){const i=e.oxw(3);e.xp6(1),e.Q6J("valuesLink",i.getValues())}}function Cc(t,r){1&t&&(e.TgZ(0,"clr-tab")(1,"button",18),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.YNc(4,xc,2,1,"clr-tab-content",19),e.qZA()),2&t&&(e.xp6(2),e.hij(" ",e.lcZ(3,1,"HELM_CHART.VALUES")," "))}function vc(t,r){if(1&t&&(e.ynx(0),e.TgZ(1,"h4",1),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",2)(5,"clr-tabs"),e.YNc(6,hc,5,3,"clr-tab",0),e.YNc(7,mc,5,3,"clr-tab",0),e.YNc(8,Ac,5,3,"clr-tab",0),e.YNc(9,bc,5,3,"clr-tab",0),e.YNc(10,Cc,5,3,"clr-tab",0),e.qZA()(),e.BQk()),2&t){const i=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,6,"ARTIFACT.ADDITIONS")),e.xp6(4),e.Q6J("ngIf",i.getVulnerability()),e.xp6(1),e.Q6J("ngIf",i.getBuildHistory()),e.xp6(1),e.Q6J("ngIf",i.getSummary()),e.xp6(1),e.Q6J("ngIf",i.getDependencies()),e.xp6(1),e.Q6J("ngIf",i.getValues())}}let Ic=(()=>{class t{constructor(){}getVulnerability(){return this.additionLinks&&this.additionLinks[D.VULNERABILITIES]?this.additionLinks[D.VULNERABILITIES]:null}getBuildHistory(){return this.additionLinks&&this.additionLinks[D.BUILD_HISTORY]?this.additionLinks[D.BUILD_HISTORY]:null}getSummary(){return this.additionLinks&&this.additionLinks[D.SUMMARY]?this.additionLinks[D.SUMMARY]:null}getDependencies(){return this.additionLinks&&this.additionLinks[D.DEPENDENCIES]?this.additionLinks[D.DEPENDENCIES]:null}getValues(){return this.additionLinks&&this.additionLinks[D.VALUES]?this.additionLinks[D.VALUES]:null}}return t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=e.Xpm({type:t,selectors:[["artifact-additions"]],inputs:{artifact:"artifact",additionLinks:"additionLinks",projectName:"projectName",projectId:"projectId",repoName:"repoName",digest:"digest"},decls:1,vars:1,consts:[[4,"ngIf"],[1,"margin-bottom-025"],[1,"min-15"],["clrTabLink","","id","vulnerability"],["id","vulnerability-content",4,"clrIfActive"],["id","vulnerability-content"],[3,"artifact","projectName","projectId","repoName","digest","vulnerabilitiesLink"],["clrTabLink","","id","build-history"],[4,"clrIfActive"],[3,"buildHistoryLink"],["clrTabLink","","id","summary-link"],["id","summary-content",4,"clrIfActive"],["id","summary-content"],[3,"summaryLink"],["clrTabLink","","id","depend-link"],["id","depend-content",4,"clrIfActive"],["id","depend-content"],[3,"dependenciesLink"],["clrTabLink","","id","value-link"],["id","value-content",4,"clrIfActive"],["id","value-content"],[3,"valuesLink"]],template:function(i,n){1&i&&e.YNc(0,vc,11,8,"ng-container",0),2&i&&e.Q6J("ngIf",n.additionLinks)},dependencies:[s.tam,s.UkA,s.S4y,s.gKI,s.Iq$,s.dl,s.Qs7,A.O5,wl,Rl,kl,Ul,gc,b.X$],styles:[".margin-bottom-025[_ngcontent-%COMP%]{margin-bottom:.25rem}.min-15[_ngcontent-%COMP%]{min-height:15rem}"]}),t})();function yc(t,r){if(1&t){const i=e.EpF();e.TgZ(0,"span",3),e._uU(1," <"),e.TgZ(2,"a",4),e.NdJ("click",function(){const a=e.CHM(i).index,l=e.oxw();return e.KtG(l.jumpDigest(a))}),e._uU(3),e.ALo(4,"slice"),e.qZA()()}if(2&t){const i=r.$implicit;e.xp6(3),e.Oqu(e.Dn7(4,1,i,0,15))}}function Sc(t,r){if(1&t){const i=e.EpF();e.TgZ(0,"img",16),e.NdJ("error",function(o){e.CHM(i);const a=e.oxw(2);return e.KtG(a.showDefaultIcon(o))}),e.qZA()}if(2&t){const i=e.oxw(2);e.Q6J("title",i.artifact.type)("src",i.getIcon(i.artifact.icon),e.LSH)}}function Oc(t,r){if(1&t&&(e.TgZ(0,"div",14),e.YNc(1,Sc,1,2,"img",15),e.qZA()),2&t){const i=e.oxw();e.xp6(1),e.Q6J("ngIf",i.getIcon(i.artifact.icon))}}function Lc(t,r){1&t&&e._UZ(0,"clr-icon",17)}function wc(t,r){if(1&t&&(e.ynx(0),e._UZ(1,"artifact-tag",18)(2,"artifact-common-properties",19)(3,"artifact-additions",20),e.BQk()),2&t){const i=e.oxw();e.xp6(1),e.Q6J("artifactDetails",i.artifact)("projectName",i.projectName)("isProxyCacheProject",i.isProxyCacheProject)("projectId",i.projectId)("repositoryName",i.repositoryName),e.xp6(1),e.Q6J("artifactDetails",i.artifact),e.xp6(1),e.Q6J("artifact",i.artifact)("projectName",i.projectName)("projectId",i.projectId)("repoName",i.repositoryName)("digest",i.artifactDigest)("additionLinks",null==i.artifact?null:i.artifact.addition_links)}}function Nc(t,r){1&t&&(e.TgZ(0,"div",21),e._UZ(1,"span",22),e.qZA())}let vi=(()=>{class t{constructor(i,n,o,a,l,c){this.projectService=i,this.errorHandler=n,this.route=o,this.appConfigService=a,this.router=l,this.frontEndArtifactService=c,this.referArtifactNameArray=[],this.backEvt=new e.vpe,this.isProxyCacheProject=!1,this.loading=!1}goBack(){this.router.navigate(["harbor","projects",this.projectId,"repositories",this.repositoryName])}goBackRep(){this.router.navigate(["harbor","projects",this.projectId,"repositories"])}goBackPro(){this.router.navigate(["harbor","projects"])}jumpDigest(i){const n=this.referArtifactNameArray.slice(0,i+1);this.router.navigate(n&&n.length?["harbor","projects",this.projectId,"repositories",this.repositoryName,"artifacts-tab","depth",n.join("-")]:["harbor","projects",this.projectId,"repositories",this.repositoryName])}ngOnInit(){let i=this.route.snapshot.params.depth;if(i&&(this.referArtifactNameArray=i.split("-")),this.repositoryName=this.route.snapshot.params.repo,this.artifactDigest=this.route.snapshot.params.digest,this.projectId=this.route.snapshot.parent.params.id,this.repositoryName&&this.artifactDigest){const n=this.route.snapshot.data;if(n){const o=n.artifactResolver[1];this.projectName=o.name,o.registry_id&&(this.isProxyCacheProject=!0),this.artifact=n.artifactResolver[0],this.getIconFromBackEnd()}}}onBack(){this.backEvt.emit(this.repositoryName)}showDefaultIcon(i){i&&i.target&&(i.target.src=ke)}getIcon(i){return this.frontEndArtifactService.getIcon(i)}getIconFromBackEnd(){this.artifact&&this.artifact.icon&&this.frontEndArtifactService.getIconsFromBackEnd([this.artifact])}}return t.\u0275fac=function(i){return new(i||t)(e.Y36(I.Y4),e.Y36(R.q),e.Y36(Z.gz),e.Y36(Ye._),e.Y36(Z.F0),e.Y36(pe))},t.\u0275cmp=e.Xpm({type:t,selectors:[["artifact-summary"]],outputs:{backEvt:"backEvt"},features:[e._Bn([])],decls:25,vars:15,consts:[[1,"arrow-block"],[1,"back-icon","margin-right-5px"],[1,"pl-0",3,"click"],[1,"back-icon"],[3,"click"],["class","back-icon",4,"ngFor","ngForOf"],[1,"title-wrapper"],[1,"title-block"],[1,"custom-h2","center-align-items"],["class","artifact-icon clr-display-inline-block",4,"ngIf"],[1,"margin-left-10px"],["size","25","class","icon-folder margin-left-10px","shape","folder",4,"ngIf"],[4,"ngIf"],["class","clr-row mt-3 center",4,"ngIf"],[1,"artifact-icon","clr-display-inline-block"],["class","artifact-icon",3,"title","src","error",4,"ngIf"],[1,"artifact-icon",3,"title","src","error"],["size","25","shape","folder",1,"icon-folder","margin-left-10px"],[3,"artifactDetails","projectName","isProxyCacheProject","projectId","repositoryName"],[3,"artifactDetails"],[3,"artifact","projectName","projectId","repoName","digest","additionLinks"],[1,"clr-row","mt-3","center"],[1,"spinner","spinner-md"]],template:function(i,n){1&i&&(e.TgZ(0,"div",0)(1,"span",1),e._uU(2,"<"),e.qZA(),e.TgZ(3,"a",2),e.NdJ("click",function(){return n.goBackPro()}),e._uU(4),e.ALo(5,"translate"),e.qZA(),e.TgZ(6,"span",3),e._uU(7,"<"),e.qZA(),e.TgZ(8,"a",4),e.NdJ("click",function(){return n.goBackRep()}),e._uU(9),e.qZA(),e.TgZ(10,"span",3),e._uU(11,"<"),e.qZA(),e.TgZ(12,"a",4),e.NdJ("click",function(){return n.goBack()}),e._uU(13),e.qZA(),e.YNc(14,yc,5,5,"span",5),e.qZA(),e.TgZ(15,"div",6)(16,"div",7)(17,"h2",8),e.YNc(18,Oc,2,1,"div",9),e.TgZ(19,"span",10),e._uU(20),e.ALo(21,"slice"),e.qZA(),e.YNc(22,Lc,1,0,"clr-icon",11),e.qZA()()(),e.YNc(23,wc,4,12,"ng-container",12),e.YNc(24,Nc,2,0,"div",13)),2&i&&(e.xp6(4),e.Oqu(e.lcZ(5,9,"SIDE_NAV.PROJECTS")),e.xp6(5),e.Oqu(n.projectName),e.xp6(4),e.Oqu(n.repositoryName),e.xp6(1),e.Q6J("ngForOf",n.referArtifactNameArray),e.xp6(4),e.Q6J("ngIf",n.artifact.icon),e.xp6(2),e.Oqu(e.Dn7(21,11,null==n.artifact?null:n.artifact.digest,0,15)),e.xp6(2),e.Q6J("ngIf",(null==n.artifact?null:n.artifact.references)&&(null==n.artifact||null==n.artifact.references?null:n.artifact.references.length)),e.xp6(1),e.Q6J("ngIf",!n.loading),e.xp6(1),e.Q6J("ngIf",n.loading))},dependencies:[s.qvL,A.sg,A.O5,Wr,to,Ic,b.X$,A.OU],styles:[".arrow-block[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;color:#007cbb;font-size:16px;padding:5px;border-radius:2px;margin-right:5px}.back-icon[_ngcontent-%COMP%]{color:#007cbb;font-size:16px}.margin-top-5px[_ngcontent-%COMP%]{margin-top:5px}.center[_ngcontent-%COMP%]{justify-content:center;align-items:center}.center-align-items[_ngcontent-%COMP%]{display:flex;align-items:center}.artifact-icon[_ngcontent-%COMP%]{width:25px}.margin-left-10px[_ngcontent-%COMP%]{margin-left:10px}.margin-right-5px[_ngcontent-%COMP%]{margin-right:5px}"]}),t})();var Zc=_(5577);let Ii=(()=>{class t{constructor(i,n,o){this.projectService=i,this.artifactService=n,this.router=o}resolve(i,n){const a=i.params.repo,l=i.params.digest;return this.projectService.getProject(i.params.id).pipe((0,Zc.z)(c=>(0,G.D)([this.artifactService.getArtifact({repositoryName:(0,u.gI)(a),reference:l,projectName:c.name,withLabel:!0,withScanOverview:!0,withTag:!1,withImmutableStatus:!0}),(0,ve.of)(c)])),(0,Me.K)(c=>(this.router.navigate(["/harbor","projects"]),null)))}}return t.\u0275fac=function(i){return new(i||t)(e.LFG(I.Y4),e.LFG(ee.b),e.LFG(Z.F0))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var Ec=_(6820);const Pc=["confirmationDialog"];function Rc(t,r){1&t&&(e.TgZ(0,"div",14),e._UZ(1,"span",15),e.qZA())}function Mc(t,r){1&t&&(e.TgZ(0,"div",18)(1,"p"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._UZ(4,"p"),e.qZA()),2&t&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"REPOSITORY.NO_INFO")))}function kc(t,r){if(1&t&&(e.TgZ(0,"div",19),e._UZ(1,"div",20),e.ALo(2,"markdown"),e.qZA()),2&t){const i=e.oxw(3);e.xp6(1),e.Q6J("innerHTML",e.lcZ(2,1,i.imageInfo),e.oJD)}}function Dc(t,r){if(1&t&&(e.ynx(0),e.YNc(1,Mc,5,3,"div",16),e.YNc(2,kc,3,3,"div",17),e.BQk()),2&t){const i=e.oxw(2);e.xp6(1),e.Q6J("ngIf",!i.imageInfo),e.xp6(1),e.Q6J("ngIf",i.imageInfo)}}function Uc(t,r){if(1&t&&(e.TgZ(0,"div",12),e.YNc(1,Rc,2,0,"div",13),e.YNc(2,Dc,3,2,"ng-container",8),e.qZA()),2&t){const i=e.oxw();e.xp6(1),e.Q6J("ngIf",i.loading),e.xp6(1),e.Q6J("ngIf",!i.loading)}}function Yc(t,r){if(1&t){const i=e.EpF();e.TgZ(0,"div")(1,"textarea",21),e.NdJ("ngModelChange",function(o){e.CHM(i);const a=e.oxw();return e.KtG(a.imageInfo=o)}),e.qZA()()}if(2&t){const i=e.oxw();e.xp6(1),e.Q6J("ngModel",i.imageInfo)}}function qc(t,r){if(1&t){const i=e.EpF();e.TgZ(0,"div",22)(1,"button",23),e.NdJ("click",function(){e.CHM(i);const o=e.oxw();return e.KtG(o.saveInfo())}),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"button",24),e.NdJ("click",function(){e.CHM(i);const o=e.oxw();return e.KtG(o.cancelInfo())}),e._uU(5),e.ALo(6,"translate"),e.qZA()()}if(2&t){const i=e.oxw();e.xp6(1),e.Q6J("disabled",!i.hasChanges()),e.xp6(1),e.hij(" ",e.lcZ(3,3,"BUTTON.SAVE")," "),e.xp6(3),e.hij(" ",e.lcZ(6,5,"BUTTON.CANCEL")," ")}}const Fc=[{path:":repo",component:ot,children:[{path:"info-tab",component:(()=>{class t{constructor(i,n,o,a,l){this.errorHandler=i,this.repositoryService=n,this.translate=o,this.activatedRoute=a,this.permissionService=l,this.hasEditPermission=!1,this.onSaving=!1,this.loading=!1,this.editing=!1}ngOnInit(){this.repoName=this.activatedRoute.snapshot?.parent?.params.repo;let i=this.activatedRoute.snapshot?.parent?.parent?.data;i&&(this.projectName=i.projectResolver.name,this.projectId=i.projectResolver.project_id),this.checkPermission(),this.retrieve()}checkPermission(){this.permissionService.getPermission(this.projectId,I._W.REPOSITORY.KEY,I._W.REPOSITORY.VALUE.UPDATE).subscribe(i=>{this.hasEditPermission=i})}retrieve(){let i={projectName:this.projectName,repositoryName:(0,u.gI)(this.repoName)};this.loading=!0,this.repositoryService.getRepository(i).pipe((0,L.x)(()=>this.loading=!1)).subscribe(n=>{this.orgImageInfo=n.description,this.imageInfo=n.description},n=>this.errorHandler.error(n))}refresh(){this.retrieve()}hasChanges(){return this.imageInfo!==this.orgImageInfo}reset(){this.imageInfo=this.orgImageInfo}editInfo(){this.editing=!0}saveInfo(){if(!this.hasChanges())return;this.onSaving=!0;let i={repositoryName:(0,u.gI)(this.repoName),repository:{description:this.imageInfo},projectName:this.projectName};this.repositoryService.updateRepository(i).subscribe(()=>{this.onSaving=!1,this.translate.get("CONFIG.SAVE_SUCCESS").subscribe(n=>{this.errorHandler.info(n)}),this.editing=!1,this.refresh()},n=>{this.onSaving=!1,this.errorHandler.error(n)})}cancelInfo(){let i=new Ie.c("CONFIG.CONFIRM_TITLE","CONFIG.CONFIRM_SUMMARY","",{},10);this.confirmationDlg.open(i)}confirmCancel(i){this.editing=!1,i&&10===i.source&&1===i.state&&this.reset()}}return t.\u0275fac=function(i){return new(i||t)(e.Y36(R.q),e.Y36(Ec.b),e.Y36(b.sK),e.Y36(Z.gz),e.Y36(I.Hx))},t.\u0275cmp=e.Xpm({type:t,selectors:[["artifact-info"]],viewQuery:function(i,n){if(1&i&&e.Gf(Pc,5),2&i){let o;e.iGM(o=e.CRH())&&(n.confirmationDlg=o.first)}},decls:18,vars:10,consts:[["id","info","role","tabpanel","aria-labelledby","repo-info"],["repoInfoForm","ngForm"],["id","info-edit-button"],[1,"btn",3,"disabled","click"],["shape","pencil","size","16"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 640 1024","preserveAspectRatio","xMinYMin",1,"markdown"],["d","M950.154 192H73.846C33.127 192 0 225.12699999999995 0 265.846v492.308C0 798.875 33.127 832 73.846 832h876.308c40.721 0 73.846-33.125 73.846-73.846V265.846C1024 225.12699999999995 990.875 192 950.154 192zM576 703.875L448 704V512l-96 123.077L256 512v192H128V320h128l96 128 96-128 128-0.125V703.875zM767.091 735.875L608 512h96V320h128v192h96L767.091 735.875z"],["id","no-editing",4,"ngIf"],[4,"ngIf"],["class","",4,"ngIf"],[3,"confirmAction"],["confirmationDialog",""],["id","no-editing"],["class","loading",4,"ngIf"],[1,"loading"],[1,"spinner","spinner-inline"],["class","no-info-div",4,"ngIf"],["class","info-div",4,"ngIf"],[1,"no-info-div"],[1,"info-div"],[1,"info-pre",3,"innerHTML"],["id","info-edit-textarea","rows","5","name","info-edit-textarea",1,"clr-textarea","w-100",3,"ngModel","ngModelChange"],[1,""],["id","edit-save",1,"btn","btn-primary",3,"disabled","click"],["id","edit-cancel",1,"btn",3,"click"]],template:function(i,n){1&i&&(e.TgZ(0,"section",0)(1,"form",null,1)(3,"div",2)(4,"button",3),e.NdJ("click",function(){return n.editInfo()}),e._UZ(5,"clr-icon",4),e._uU(6),e.ALo(7,"translate"),e.qZA(),e.O4$(),e.TgZ(8,"svg",5),e._UZ(9,"path",6),e.qZA(),e.kcU(),e.TgZ(10,"span"),e._uU(11),e.ALo(12,"translate"),e.qZA()(),e.YNc(13,Uc,3,2,"div",7),e.YNc(14,Yc,2,1,"div",8),e.YNc(15,qc,7,7,"div",9),e.TgZ(16,"confirmation-dialog",10,11),e.NdJ("confirmAction",function(a){return n.confirmCancel(a)}),e.qZA()()()),2&i&&(e.xp6(4),e.Q6J("disabled",n.editing||!n.hasEditPermission||n.onSaving),e.xp6(2),e.hij("\xa0",e.lcZ(7,6,"BUTTON.EDIT")," "),e.xp6(5),e.Oqu(e.lcZ(12,8,"REPOSITORY.MARKDOWN")),e.xp6(2),e.Q6J("ngIf",!n.editing),e.xp6(1),e.Q6J("ngIf",n.editing),e.xp6(1),e.Q6J("ngIf",n.editing))},dependencies:[x._Y,x.Fj,x.JJ,x.JL,x.On,x.F,s.qvL,A.O5,qe.z,b.X$,Re.NO],styles:[".no-info-div[_ngcontent-%COMP%]{background:white;border:1px;border-style:solid;border-color:#ccc;padding:12px}.info-div[_ngcontent-%COMP%]{border:1px;border-style:solid;border-color:#ccc;padding:0 12px 24px}.loading[_ngcontent-%COMP%]{height:3rem;border:1px;border-style:solid;border-color:#ccc;display:flex;align-items:center;justify-content:center}.info-pre[_ngcontent-%COMP%]{border:0;max-height:-moz-fit-content;max-height:fit-content}#info-edit-button[_ngcontent-%COMP%]{margin-top:0;margin-bottom:12px;font-size:12px}#info-edit-button[_ngcontent-%COMP%]   .markdown[_ngcontent-%COMP%]{position:relative;width:20px;height:20px;margin-right:10px;margin-left:10px;top:6px;fill:gray}"]}),t})()},{path:"artifacts-tab",component:At},{path:"",redirectTo:"artifacts-tab",pathMatch:"full"}]},{path:":repo",component:ot,children:[{path:"artifacts-tab/depth/:depth",component:At}]},{path:":repo/artifacts-tab/artifacts/:digest",component:vi,resolve:{artifactResolver:Ii}},{path:":repo/artifacts-tab/depth/:depth/artifacts/:digest",component:vi,resolve:{artifactResolver:Ii}}];let jc=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({providers:[ce,{provide:pe,useClass:Ri}],imports:[Z.Bz.forChild(Fc),S.m]}),t})()},6082:(yi,Ce,_)=>{_.d(Ce,{q:()=>A});var Z=_(6742),S=_(4650),e=_(6895),s=_(9375);function I(b,V){1&b&&S._UZ(0,"clr-icon",4)}function R(b,V){1&b&&S._UZ(0,"clr-icon",5)}const ce=function(b,V,q){return{"background-color":b,color:V,border:q}};let A=(()=>{class b{constructor(){this.hasIcon=!0}ngOnChanges(){if(this.label){let q=this.label.color;q||(q="#FFFFFF"),this.labelColor=Z.oW.find(M=>M.color===q)}}}return b.\u0275fac=function(q){return new(q||b)},b.\u0275cmp=S.Xpm({type:b,selectors:[["hbr-label-piece"]],inputs:{label:"label",labelWidth:"labelWidth",hasIcon:"hasIcon"},features:[S.TTD],decls:6,vars:10,consts:[[1,"label",3,"ngStyle"],["shape","organization",4,"ngIf"],["shape","administrator",4,"ngIf"],[1,"label-name"],["shape","organization"],["shape","administrator"]],template:function(q,M){1&q&&(S.TgZ(0,"label",0)(1,"span"),S.YNc(2,I,1,0,"clr-icon",1),S.YNc(3,R,1,0,"clr-icon",2),S.qZA(),S.TgZ(4,"span",3),S._uU(5),S.qZA()()),2&q&&(S.Udp("max-width",M.labelWidth,"px"),S.Q6J("ngStyle",S.kEZ(6,ce,null==M.labelColor?null:M.labelColor.color,null==M.labelColor?null:M.labelColor.textColor,"#FFFFFF"===(null==M.labelColor?null:M.labelColor.color)?"1px solid #A1A1A1":"none")),S.xp6(2),S.Q6J("ngIf",M.hasIcon&&"p"===M.label.scope),S.xp6(1),S.Q6J("ngIf",M.hasIcon&&"g"===M.label.scope),S.xp6(2),S.Oqu(M.label.name))},dependencies:[e.O5,e.PC,s.qvL,s.MgK],styles:[".label[_ngcontent-%COMP%]{display:flex;align-items:center;cursor:inherit}.label[_ngcontent-%COMP%]   clr-icon[_ngcontent-%COMP%]{margin-right:3px;margin-top:3px}.label-name[_ngcontent-%COMP%]{min-width:0;overflow:hidden;text-overflow:ellipsis}"]}),b})()}}]);